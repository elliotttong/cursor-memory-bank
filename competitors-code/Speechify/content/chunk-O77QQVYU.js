import{h as rd,i as sd,s as id,t as ad,x as od}from"./chunk-35EEQS33.js";import{a as lg,b as hg,c as ud,d as dg,e as fg,f as cd,g as mg,h as pg,i as Ct}from"./chunk-BGIN6QNH.js";import{b as cg,c as Mn}from"./chunk-UQBFOPQH.js";import{d as le,f as browser,g as Buffer,h as M,o as B}from"./chunk-NUN3A7RC.js";B();M();B();M();var Ar=le(pg()),Np=le(ud());B();M();var ld=le(Ct()),gg=t=>Object.fromEntries(t.entries().map(e=>{let n=e.first,r=e.second;return[n,r]})),ti=class extends ld.EventsTrackerAdapter{postMessage(e){return browser.runtime.sendMessage({target:"offscreen",data:{type:"analytics/track",data:e}})}track(e,n){this.postMessage({eventName:e,properties:gg(n)})}};B();M();var hd=le(lg()),ni=class extends hd.ArchiveFilesAdapter{createViewOfZip(){console.error("Speechify: createViewOfZip not implemented")}createViewOfZipFromByteArrayAndDeleteAnyTemporaryCreatedFiles(){console.error("Speechify: createViewOfZipFromByteArrayAndDeleteAnyTemporaryCreatedFiles")}};B();M();B();M();B();M();B();M();B();M();B();M();var fd=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Eg=function(t){let e=[],n=0,r=0;for(;n<t.length;){let s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){let i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){let i=t[n++],o=t[n++],c=t[n++],h=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},md={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){let i=t[s],o=s+1<t.length,c=o?t[s+1]:0,h=s+2<t.length,f=h?t[s+2]:0,m=i>>2,_=(i&3)<<4|c>>4,I=(c&15)<<2|f>>6,v=f&63;h||(v=64,o||(I=64)),r.push(n[m],n[_],n[I],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fd(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Eg(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){let i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;let f=s<t.length?n[t.charAt(s)]:64;++s;let _=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||f==null||_==null)throw new Po;let I=i<<2|c>>4;if(r.push(I),f!==64){let v=c<<4&240|f>>2;if(r.push(v),_!==64){let x=f<<6&192|_;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Po=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},_g=function(t){let e=fd(t);return md.encodeByteArray(e,!0)},Vr=function(t){return _g(t).replace(/\./g,"")},Tg=function(t){try{return md.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ag(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var bg=()=>Ag().__FIREBASE_DEFAULTS__,yg=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Ig=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&Tg(t[1]);return e&&JSON.parse(e)},xo=()=>{try{return bg()||yg()||Ig()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Rg=t=>{var e,n;return(n=(e=xo())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},si=t=>{let e=Rg(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Lo=()=>{var t;return(t=xo())===null||t===void 0?void 0:t.config};var ri=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function ii(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Vr(JSON.stringify(n)),Vr(JSON.stringify(o)),""].join(".")}function ko(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ay(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ko())}function Cg(){var t;let e=(t=xo())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function by(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yy(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Iy(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pd(){return!Cg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Mo(){try{return typeof indexedDB=="object"}catch{return!1}}function gd(){return new Promise((t,e)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}var Sg="FirebaseError",Ke=class t extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Sg,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hr.prototype.create)}},Hr=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){let r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?wg(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Ke(s,c,r)}};function wg(t,e){return t.replace(Ng,(n,r)=>{let s=e[r];return s!=null?String(s):`<${r}?>`})}var Ng=/\{\$([^}]+)}/g;function qr(t,e){if(t===e)return!0;let n=Object.keys(t),r=Object.keys(e);for(let s of n){if(!r.includes(s))return!1;let i=t[s],o=e[s];if(dd(i)&&dd(o)){if(!qr(i,o))return!1}else if(i!==o)return!1}for(let s of r)if(!n.includes(s))return!1;return!0}function dd(t){return t!==null&&typeof t=="object"}function Ry(t){let e=[];for(let[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Cy(t){let e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Sy(t){let e=t.indexOf("?");if(!e)return"";let n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function wy(t,e){let n=new Oo(t,e);return n.subscribe.bind(n)}var Oo=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");vg(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Do),s.error===void 0&&(s.error=Do),s.complete===void 0&&(s.complete=Do);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function vg(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Do(){}var Ny=4*60*60*1e3;function Ce(t){return t&&t._delegate?t._delegate:t}var it=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var dn="[DEFAULT]";var Bo=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let r=new ri;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{let s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let r=this.normalizeInstanceIdentifier(e?.identifier),s=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Pg(e))try{this.getOrInitializeService({instanceIdentifier:dn})}catch{}for(let[n,r]of this.instancesDeferred.entries()){let s=this.normalizeInstanceIdentifier(n);try{let i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=dn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dn){return this.instances.has(e)}getOptions(e=dn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(let[i,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){var r;let s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);let o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){let r=this.onInitCallbacks.get(n);if(r)for(let s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Dg(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=dn){return this.component?this.component.multipleInstances?e:dn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Dg(t){return t===dn?void 0:t}function Pg(t){return t.instantiationMode==="EAGER"}var ai=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new Bo(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};B();M();var Og=[],re;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(re||(re={}));var xg={debug:re.DEBUG,verbose:re.VERBOSE,info:re.INFO,warn:re.WARN,error:re.ERROR,silent:re.SILENT},Lg=re.INFO,kg={[re.DEBUG]:"log",[re.VERBOSE]:"log",[re.INFO]:"info",[re.WARN]:"warn",[re.ERROR]:"error"},Mg=(t,e,...n)=>{if(e<t.logLevel)return;let r=new Date().toISOString(),s=kg[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Bn=class{constructor(e){this.name=e,this._logLevel=Lg,this._logHandler=Mg,this._userLogHandler=null,Og.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,re.DEBUG,...e),this._logHandler(this,re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,re.VERBOSE,...e),this._logHandler(this,re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,re.INFO,...e),this._logHandler(this,re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,re.WARN,...e),this._logHandler(this,re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,re.ERROR,...e),this._logHandler(this,re.ERROR,...e)}};B();M();B();M();var Bg=(t,e)=>e.some(n=>t instanceof n),Ed,_d;function Fg(){return Ed||(Ed=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ug(){return _d||(_d=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Td=new WeakMap,Uo=new WeakMap,Ad=new WeakMap,Fo=new WeakMap,Ho=new WeakMap;function Vg(t){let e=new Promise((n,r)=>{let s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(lt(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Td.set(n,t)}).catch(()=>{}),Ho.set(e,t),e}function Hg(t){if(Uo.has(t))return;let e=new Promise((n,r)=>{let s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Uo.set(t,e)}var Vo={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Uo.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ad.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return lt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bd(t){Vo=t(Vo)}function qg(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let r=t.call(oi(this),e,...n);return Ad.set(r,e.sort?e.sort():[e]),lt(r)}:Ug().includes(t)?function(...e){return t.apply(oi(this),e),lt(Td.get(this))}:function(...e){return lt(t.apply(oi(this),e))}}function Gg(t){return typeof t=="function"?qg(t):(t instanceof IDBTransaction&&Hg(t),Bg(t,Fg())?new Proxy(t,Vo):t)}function lt(t){if(t instanceof IDBRequest)return Vg(t);if(Fo.has(t))return Fo.get(t);let e=Gg(t);return e!==t&&(Fo.set(t,e),Ho.set(e,t)),e}var oi=t=>Ho.get(t);function Id(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){let o=indexedDB.open(t,e),c=lt(o);return r&&o.addEventListener("upgradeneeded",h=>{r(lt(o.result),h.oldVersion,h.newVersion,lt(o.transaction),h)}),n&&o.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),c.then(h=>{i&&h.addEventListener("close",()=>i()),s&&h.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}var Kg=["get","getKey","getAll","getAllKeys","count"],zg=["put","add","delete","clear"],qo=new Map;function yd(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qo.get(e))return qo.get(e);let n=e.replace(/FromIndex$/,""),r=e!==n,s=zg.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Kg.includes(n)))return;let i=async function(o,...c){let h=this.transaction(o,s?"readwrite":"readonly"),f=h.store;return r&&(f=f.index(c.shift())),(await Promise.all([f[n](...c),s&&h.done]))[0]};return qo.set(e,i),i}bd(t=>({...t,get:(e,n,r)=>yd(e,n)||t.get(e,n,r),has:(e,n)=>!!yd(e,n)||t.has(e,n)}));var Ko=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(jg(n)){let r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function jg(t){let e=t.getComponent();return e?.type==="VERSION"}var zo="@firebase/app",Rd="0.10.16";var wt=new Bn("@firebase/app"),Qg="@firebase/app-compat",Wg="@firebase/analytics-compat",Yg="@firebase/analytics",$g="@firebase/app-check-compat",Xg="@firebase/app-check",Jg="@firebase/auth",Zg="@firebase/auth-compat",eE="@firebase/database",tE="@firebase/data-connect",nE="@firebase/database-compat",rE="@firebase/functions",sE="@firebase/functions-compat",iE="@firebase/installations",aE="@firebase/installations-compat",oE="@firebase/messaging",uE="@firebase/messaging-compat",cE="@firebase/performance",lE="@firebase/performance-compat",hE="@firebase/remote-config",dE="@firebase/remote-config-compat",fE="@firebase/storage",mE="@firebase/storage-compat",pE="@firebase/firestore",gE="@firebase/vertexai",EE="@firebase/firestore-compat",_E="firebase",TE="11.0.2";var jo="[DEFAULT]",AE={[zo]:"fire-core",[Qg]:"fire-core-compat",[Yg]:"fire-analytics",[Wg]:"fire-analytics-compat",[Xg]:"fire-app-check",[$g]:"fire-app-check-compat",[Jg]:"fire-auth",[Zg]:"fire-auth-compat",[eE]:"fire-rtdb",[tE]:"fire-data-connect",[nE]:"fire-rtdb-compat",[rE]:"fire-fn",[sE]:"fire-fn-compat",[iE]:"fire-iid",[aE]:"fire-iid-compat",[oE]:"fire-fcm",[uE]:"fire-fcm-compat",[cE]:"fire-perf",[lE]:"fire-perf-compat",[hE]:"fire-rc",[dE]:"fire-rc-compat",[fE]:"fire-gcs",[mE]:"fire-gcs-compat",[pE]:"fire-fst",[EE]:"fire-fst-compat",[gE]:"fire-vertex","fire-js":"fire-js",[_E]:"fire-js-all"};var ui=new Map,bE=new Map,Qo=new Map;function Cd(t,e){try{t.container.addComponent(e)}catch(n){wt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function fn(t){let e=t.name;if(Qo.has(e))return wt.debug(`There were multiple attempts to register component ${e}.`),!1;Qo.set(e,t);for(let n of ui.values())Cd(n,t);for(let n of bE.values())Cd(n,t);return!0}function ci(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function tI(t){return t.settings!==void 0}var yE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qt=new Hr("app","Firebase",yE);var Wo=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new it("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qt.create("app-deleted",{appName:this._name})}};var li=TE;function IE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let r=Object.assign({name:jo,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Qt.create("bad-app-name",{appName:String(s)});if(n||(n=Lo()),!n)throw Qt.create("no-options");let i=ui.get(s);if(i){if(qr(n,i.options)&&qr(r,i.config))return i;throw Qt.create("duplicate-app",{appName:s})}let o=new ai(s);for(let h of Qo.values())o.addComponent(h);let c=new Wo(n,r,o);return ui.set(s,c),c}function hi(t=jo){let e=ui.get(t);if(!e&&t===jo&&Lo())return IE();if(!e)throw Qt.create("no-app",{appName:t});return e}function St(t,e,n){var r;let s=(r=AE[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);let i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){let c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wt.warn(c.join(" "));return}fn(new it(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}var RE="firebase-heartbeat-database",CE=1,Gr="firebase-heartbeat-store",Go=null;function vd(){return Go||(Go=Id(RE,CE,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Gr)}catch(n){console.warn(n)}}}}).catch(t=>{throw Qt.create("idb-open",{originalErrorMessage:t.message})})),Go}async function SE(t){try{let n=(await vd()).transaction(Gr),r=await n.objectStore(Gr).get(Dd(t));return await n.done,r}catch(e){if(e instanceof Ke)wt.warn(e.message);else{let n=Qt.create("idb-get",{originalErrorMessage:e?.message});wt.warn(n.message)}}}async function Sd(t,e){try{let r=(await vd()).transaction(Gr,"readwrite");await r.objectStore(Gr).put(e,Dd(t)),await r.done}catch(n){if(n instanceof Ke)wt.warn(n.message);else{let r=Qt.create("idb-set",{originalErrorMessage:n?.message});wt.warn(r.message)}}}function Dd(t){return`${t.name}!${t.options.appId}`}var wE=1024,NE=30*24*60*60*1e3,Yo=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new $o(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{let s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=wd();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let c=new Date(o.date).valueOf();return Date.now()-c<=NE}),this._storage.overwrite(this._heartbeatsCache))}catch(r){wt.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=wd(),{heartbeatsToSend:r,unsentEntries:s}=vE(this._heartbeatsCache.heartbeats),i=Vr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return wt.warn(n),""}}};function wd(){return new Date().toISOString().substring(0,10)}function vE(t,e=wE){let n=[],r=t.slice();for(let s of t){let i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Nd(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Nd(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var $o=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Mo()?gd().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let n=await SE(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){let s=await this.read();return Sd(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){let s=await this.read();return Sd(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}};function Nd(t){return Vr(JSON.stringify({version:2,heartbeats:t})).length}function DE(t){fn(new it("platform-logger",e=>new Ko(e),"PRIVATE")),fn(new it("heartbeat",e=>new Yo(e),"PRIVATE")),St(zo,Rd,t),St(zo,Rd,"esm2017"),St("fire-js","")}DE("");B();M();var Pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Od={};var Wt,Xo;(function(){var t;function e(C,T){function y(){}y.prototype=T.prototype,C.D=T.prototype,C.prototype=new y,C.prototype.constructor=C,C.C=function(R,S,D){for(var b=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)b[yt-2]=arguments[yt];return T.prototype[S].apply(R,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(C,T,y){y||(y=0);var R=Array(16);if(typeof T=="string")for(var S=0;16>S;++S)R[S]=T.charCodeAt(y++)|T.charCodeAt(y++)<<8|T.charCodeAt(y++)<<16|T.charCodeAt(y++)<<24;else for(S=0;16>S;++S)R[S]=T[y++]|T[y++]<<8|T[y++]<<16|T[y++]<<24;T=C.g[0],y=C.g[1],S=C.g[2];var D=C.g[3],b=T+(D^y&(S^D))+R[0]+3614090360&4294967295;T=y+(b<<7&4294967295|b>>>25),b=D+(S^T&(y^S))+R[1]+3905402710&4294967295,D=T+(b<<12&4294967295|b>>>20),b=S+(y^D&(T^y))+R[2]+606105819&4294967295,S=D+(b<<17&4294967295|b>>>15),b=y+(T^S&(D^T))+R[3]+3250441966&4294967295,y=S+(b<<22&4294967295|b>>>10),b=T+(D^y&(S^D))+R[4]+4118548399&4294967295,T=y+(b<<7&4294967295|b>>>25),b=D+(S^T&(y^S))+R[5]+1200080426&4294967295,D=T+(b<<12&4294967295|b>>>20),b=S+(y^D&(T^y))+R[6]+2821735955&4294967295,S=D+(b<<17&4294967295|b>>>15),b=y+(T^S&(D^T))+R[7]+4249261313&4294967295,y=S+(b<<22&4294967295|b>>>10),b=T+(D^y&(S^D))+R[8]+1770035416&4294967295,T=y+(b<<7&4294967295|b>>>25),b=D+(S^T&(y^S))+R[9]+2336552879&4294967295,D=T+(b<<12&4294967295|b>>>20),b=S+(y^D&(T^y))+R[10]+4294925233&4294967295,S=D+(b<<17&4294967295|b>>>15),b=y+(T^S&(D^T))+R[11]+2304563134&4294967295,y=S+(b<<22&4294967295|b>>>10),b=T+(D^y&(S^D))+R[12]+1804603682&4294967295,T=y+(b<<7&4294967295|b>>>25),b=D+(S^T&(y^S))+R[13]+4254626195&4294967295,D=T+(b<<12&4294967295|b>>>20),b=S+(y^D&(T^y))+R[14]+2792965006&4294967295,S=D+(b<<17&4294967295|b>>>15),b=y+(T^S&(D^T))+R[15]+1236535329&4294967295,y=S+(b<<22&4294967295|b>>>10),b=T+(S^D&(y^S))+R[1]+4129170786&4294967295,T=y+(b<<5&4294967295|b>>>27),b=D+(y^S&(T^y))+R[6]+3225465664&4294967295,D=T+(b<<9&4294967295|b>>>23),b=S+(T^y&(D^T))+R[11]+643717713&4294967295,S=D+(b<<14&4294967295|b>>>18),b=y+(D^T&(S^D))+R[0]+3921069994&4294967295,y=S+(b<<20&4294967295|b>>>12),b=T+(S^D&(y^S))+R[5]+3593408605&4294967295,T=y+(b<<5&4294967295|b>>>27),b=D+(y^S&(T^y))+R[10]+38016083&4294967295,D=T+(b<<9&4294967295|b>>>23),b=S+(T^y&(D^T))+R[15]+3634488961&4294967295,S=D+(b<<14&4294967295|b>>>18),b=y+(D^T&(S^D))+R[4]+3889429448&4294967295,y=S+(b<<20&4294967295|b>>>12),b=T+(S^D&(y^S))+R[9]+568446438&4294967295,T=y+(b<<5&4294967295|b>>>27),b=D+(y^S&(T^y))+R[14]+3275163606&4294967295,D=T+(b<<9&4294967295|b>>>23),b=S+(T^y&(D^T))+R[3]+4107603335&4294967295,S=D+(b<<14&4294967295|b>>>18),b=y+(D^T&(S^D))+R[8]+1163531501&4294967295,y=S+(b<<20&4294967295|b>>>12),b=T+(S^D&(y^S))+R[13]+2850285829&4294967295,T=y+(b<<5&4294967295|b>>>27),b=D+(y^S&(T^y))+R[2]+4243563512&4294967295,D=T+(b<<9&4294967295|b>>>23),b=S+(T^y&(D^T))+R[7]+1735328473&4294967295,S=D+(b<<14&4294967295|b>>>18),b=y+(D^T&(S^D))+R[12]+2368359562&4294967295,y=S+(b<<20&4294967295|b>>>12),b=T+(y^S^D)+R[5]+4294588738&4294967295,T=y+(b<<4&4294967295|b>>>28),b=D+(T^y^S)+R[8]+2272392833&4294967295,D=T+(b<<11&4294967295|b>>>21),b=S+(D^T^y)+R[11]+1839030562&4294967295,S=D+(b<<16&4294967295|b>>>16),b=y+(S^D^T)+R[14]+4259657740&4294967295,y=S+(b<<23&4294967295|b>>>9),b=T+(y^S^D)+R[1]+2763975236&4294967295,T=y+(b<<4&4294967295|b>>>28),b=D+(T^y^S)+R[4]+1272893353&4294967295,D=T+(b<<11&4294967295|b>>>21),b=S+(D^T^y)+R[7]+4139469664&4294967295,S=D+(b<<16&4294967295|b>>>16),b=y+(S^D^T)+R[10]+3200236656&4294967295,y=S+(b<<23&4294967295|b>>>9),b=T+(y^S^D)+R[13]+681279174&4294967295,T=y+(b<<4&4294967295|b>>>28),b=D+(T^y^S)+R[0]+3936430074&4294967295,D=T+(b<<11&4294967295|b>>>21),b=S+(D^T^y)+R[3]+3572445317&4294967295,S=D+(b<<16&4294967295|b>>>16),b=y+(S^D^T)+R[6]+76029189&4294967295,y=S+(b<<23&4294967295|b>>>9),b=T+(y^S^D)+R[9]+3654602809&4294967295,T=y+(b<<4&4294967295|b>>>28),b=D+(T^y^S)+R[12]+3873151461&4294967295,D=T+(b<<11&4294967295|b>>>21),b=S+(D^T^y)+R[15]+530742520&4294967295,S=D+(b<<16&4294967295|b>>>16),b=y+(S^D^T)+R[2]+3299628645&4294967295,y=S+(b<<23&4294967295|b>>>9),b=T+(S^(y|~D))+R[0]+4096336452&4294967295,T=y+(b<<6&4294967295|b>>>26),b=D+(y^(T|~S))+R[7]+1126891415&4294967295,D=T+(b<<10&4294967295|b>>>22),b=S+(T^(D|~y))+R[14]+2878612391&4294967295,S=D+(b<<15&4294967295|b>>>17),b=y+(D^(S|~T))+R[5]+4237533241&4294967295,y=S+(b<<21&4294967295|b>>>11),b=T+(S^(y|~D))+R[12]+1700485571&4294967295,T=y+(b<<6&4294967295|b>>>26),b=D+(y^(T|~S))+R[3]+2399980690&4294967295,D=T+(b<<10&4294967295|b>>>22),b=S+(T^(D|~y))+R[10]+4293915773&4294967295,S=D+(b<<15&4294967295|b>>>17),b=y+(D^(S|~T))+R[1]+2240044497&4294967295,y=S+(b<<21&4294967295|b>>>11),b=T+(S^(y|~D))+R[8]+1873313359&4294967295,T=y+(b<<6&4294967295|b>>>26),b=D+(y^(T|~S))+R[15]+4264355552&4294967295,D=T+(b<<10&4294967295|b>>>22),b=S+(T^(D|~y))+R[6]+2734768916&4294967295,S=D+(b<<15&4294967295|b>>>17),b=y+(D^(S|~T))+R[13]+1309151649&4294967295,y=S+(b<<21&4294967295|b>>>11),b=T+(S^(y|~D))+R[4]+4149444226&4294967295,T=y+(b<<6&4294967295|b>>>26),b=D+(y^(T|~S))+R[11]+3174756917&4294967295,D=T+(b<<10&4294967295|b>>>22),b=S+(T^(D|~y))+R[2]+718787259&4294967295,S=D+(b<<15&4294967295|b>>>17),b=y+(D^(S|~T))+R[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(S+(b<<21&4294967295|b>>>11))&4294967295,C.g[2]=C.g[2]+S&4294967295,C.g[3]=C.g[3]+D&4294967295}r.prototype.u=function(C,T){T===void 0&&(T=C.length);for(var y=T-this.blockSize,R=this.B,S=this.h,D=0;D<T;){if(S==0)for(;D<=y;)s(this,C,D),D+=this.blockSize;if(typeof C=="string"){for(;D<T;)if(R[S++]=C.charCodeAt(D++),S==this.blockSize){s(this,R),S=0;break}}else for(;D<T;)if(R[S++]=C[D++],S==this.blockSize){s(this,R),S=0;break}}this.h=S,this.o+=T},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;var y=8*this.o;for(T=C.length-8;T<C.length;++T)C[T]=y&255,y/=256;for(this.u(C),C=Array(16),T=y=0;4>T;++T)for(var R=0;32>R;R+=8)C[y++]=this.g[T]>>>R&255;return C};function i(C,T){var y=c;return Object.prototype.hasOwnProperty.call(y,C)?y[C]:y[C]=T(C)}function o(C,T){this.h=T;for(var y=[],R=!0,S=C.length-1;0<=S;S--){var D=C[S]|0;R&&D==T||(y[S]=D,R=!1)}this.g=y}var c={};function h(C){return-128<=C&&128>C?i(C,function(T){return new o([T|0],0>T?-1:0)}):new o([C|0],0>C?-1:0)}function f(C){if(isNaN(C)||!isFinite(C))return _;if(0>C)return k(f(-C));for(var T=[],y=1,R=0;C>=y;R++)T[R]=C/y|0,y*=4294967296;return new o(T,0)}function m(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return k(m(C.substring(1),T));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=f(Math.pow(T,8)),R=_,S=0;S<C.length;S+=8){var D=Math.min(8,C.length-S),b=parseInt(C.substring(S,S+D),T);8>D?(D=f(Math.pow(T,D)),R=R.j(D).add(f(b))):(R=R.j(y),R=R.add(f(b)))}return R}var _=h(0),I=h(1),v=h(16777216);t=o.prototype,t.m=function(){if(U(this))return-k(this).m();for(var C=0,T=1,y=0;y<this.g.length;y++){var R=this.i(y);C+=(0<=R?R:4294967296+R)*T,T*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(x(this))return"0";if(U(this))return"-"+k(this).toString(C);for(var T=f(Math.pow(C,6)),y=this,R="";;){var S=Z(y,T).g;y=z(y,S.j(T));var D=((0<y.g.length?y.g[0]:y.h)>>>0).toString(C);if(y=S,x(y))return D+R;for(;6>D.length;)D="0"+D;R=D+R}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function x(C){if(C.h!=0)return!1;for(var T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function U(C){return C.h==-1}t.l=function(C){return C=z(this,C),U(C)?-1:x(C)?0:1};function k(C){for(var T=C.g.length,y=[],R=0;R<T;R++)y[R]=~C.g[R];return new o(y,~C.h).add(I)}t.abs=function(){return U(this)?k(this):this},t.add=function(C){for(var T=Math.max(this.g.length,C.g.length),y=[],R=0,S=0;S<=T;S++){var D=R+(this.i(S)&65535)+(C.i(S)&65535),b=(D>>>16)+(this.i(S)>>>16)+(C.i(S)>>>16);R=b>>>16,D&=65535,b&=65535,y[S]=b<<16|D}return new o(y,y[y.length-1]&-2147483648?-1:0)};function z(C,T){return C.add(k(T))}t.j=function(C){if(x(this)||x(C))return _;if(U(this))return U(C)?k(this).j(k(C)):k(k(this).j(C));if(U(C))return k(this.j(k(C)));if(0>this.l(v)&&0>C.l(v))return f(this.m()*C.m());for(var T=this.g.length+C.g.length,y=[],R=0;R<2*T;R++)y[R]=0;for(R=0;R<this.g.length;R++)for(var S=0;S<C.g.length;S++){var D=this.i(R)>>>16,b=this.i(R)&65535,yt=C.i(S)>>>16,br=C.i(S)&65535;y[2*R+2*S]+=b*br,$(y,2*R+2*S),y[2*R+2*S+1]+=D*br,$(y,2*R+2*S+1),y[2*R+2*S+1]+=b*yt,$(y,2*R+2*S+1),y[2*R+2*S+2]+=D*yt,$(y,2*R+2*S+2)}for(R=0;R<T;R++)y[R]=y[2*R+1]<<16|y[2*R];for(R=T;R<2*T;R++)y[R]=0;return new o(y,0)};function $(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function W(C,T){this.g=C,this.h=T}function Z(C,T){if(x(T))throw Error("division by zero");if(x(C))return new W(_,_);if(U(C))return T=Z(k(C),T),new W(k(T.g),k(T.h));if(U(T))return T=Z(C,k(T)),new W(k(T.g),T.h);if(30<C.g.length){if(U(C)||U(T))throw Error("slowDivide_ only works with positive integers.");for(var y=I,R=T;0>=R.l(C);)y=Re(y),R=Re(R);var S=ae(y,1),D=ae(R,1);for(R=ae(R,2),y=ae(y,2);!x(R);){var b=D.add(R);0>=b.l(C)&&(S=S.add(y),D=b),R=ae(R,1),y=ae(y,1)}return T=z(C,S.j(T)),new W(S,T)}for(S=_;0<=C.l(T);){for(y=Math.max(1,Math.floor(C.m()/T.m())),R=Math.ceil(Math.log(y)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),D=f(y),b=D.j(T);U(b)||0<b.l(C);)y-=R,D=f(y),b=D.j(T);x(D)&&(D=I),S=S.add(D),C=z(C,b)}return new W(S,C)}t.A=function(C){return Z(this,C).h},t.and=function(C){for(var T=Math.max(this.g.length,C.g.length),y=[],R=0;R<T;R++)y[R]=this.i(R)&C.i(R);return new o(y,this.h&C.h)},t.or=function(C){for(var T=Math.max(this.g.length,C.g.length),y=[],R=0;R<T;R++)y[R]=this.i(R)|C.i(R);return new o(y,this.h|C.h)},t.xor=function(C){for(var T=Math.max(this.g.length,C.g.length),y=[],R=0;R<T;R++)y[R]=this.i(R)^C.i(R);return new o(y,this.h^C.h)};function Re(C){for(var T=C.g.length+1,y=[],R=0;R<T;R++)y[R]=C.i(R)<<1|C.i(R-1)>>>31;return new o(y,C.h)}function ae(C,T){var y=T>>5;T%=32;for(var R=C.g.length-y,S=[],D=0;D<R;D++)S[D]=0<T?C.i(D+y)>>>T|C.i(D+y+1)<<32-T:C.i(D+y);return new o(S,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Xo=Od.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=f,o.fromString=m,Wt=Od.Integer=o}).apply(typeof Pd<"u"?Pd:typeof self<"u"?self:typeof window<"u"?window:{});B();M();var di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Nt={};var Jo,PE,Fn,Zo,Kr,fi,eu,tu,nu;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,l,d){return a==Array.prototype||a==Object.prototype||(a[l]=d.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof di=="object"&&di];for(var l=0;l<a.length;++l){var d=a[l];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=n(this);function s(a,l){if(l)e:{var d=r;a=a.split(".");for(var p=0;p<a.length-1;p++){var w=a[p];if(!(w in d))break e;d=d[w]}a=a[a.length-1],p=d[a],l=l(p),l!=p&&l!=null&&e(d,a,{configurable:!0,writable:!0,value:l})}}function i(a,l){a instanceof String&&(a+="");var d=0,p=!1,w={next:function(){if(!p&&d<a.length){var O=d++;return{value:l(O,a[O]),done:!1}}return p=!0,{done:!0,value:void 0}}};return w[Symbol.iterator]=function(){return w},w}s("Array.prototype.values",function(a){return a||function(){return i(this,function(l,d){return d})}});var o=o||{},c=this||self;function h(a){var l=typeof a;return l=l!="object"?l:a?Array.isArray(a)?"array":l:"null",l=="array"||l=="object"&&typeof a.length=="number"}function f(a){var l=typeof a;return l=="object"&&a!=null||l=="function"}function m(a,l,d){return a.call.apply(a.bind,arguments)}function _(a,l,d){if(!a)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var w=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(w,p),a.apply(l,w)}}return function(){return a.apply(l,arguments)}}function I(a,l,d){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:_,I.apply(null,arguments)}function v(a,l){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),a.apply(this,p)}}function x(a,l){function d(){}d.prototype=l.prototype,a.aa=l.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(p,w,O){for(var q=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)q[ce-2]=arguments[ce];return l.prototype[w].apply(p,q)}}function U(a){let l=a.length;if(0<l){let d=Array(l);for(let p=0;p<l;p++)d[p]=a[p];return d}return[]}function k(a,l){for(let d=1;d<arguments.length;d++){let p=arguments[d];if(h(p)){let w=a.length||0,O=p.length||0;a.length=w+O;for(let q=0;q<O;q++)a[w+q]=p[q]}else a.push(p)}}class z{constructor(l,d){this.i=l,this.j=d,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function $(a){return/^[\s\xa0]*$/.test(a)}function W(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function Z(a){return Z[" "](a),a}Z[" "]=function(){};var Re=W().indexOf("Gecko")!=-1&&!(W().toLowerCase().indexOf("webkit")!=-1&&W().indexOf("Edge")==-1)&&!(W().indexOf("Trident")!=-1||W().indexOf("MSIE")!=-1)&&W().indexOf("Edge")==-1;function ae(a,l,d){for(let p in a)l.call(d,a[p],p,a)}function C(a,l){for(let d in a)l.call(void 0,a[d],d,a)}function T(a){let l={};for(let d in a)l[d]=a[d];return l}let y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(a,l){let d,p;for(let w=1;w<arguments.length;w++){p=arguments[w];for(d in p)a[d]=p[d];for(let O=0;O<y.length;O++)d=y[O],Object.prototype.hasOwnProperty.call(p,d)&&(a[d]=p[d])}}function S(a){var l=1;a=a.split(":");let d=[];for(;0<l&&a.length;)d.push(a.shift()),l--;return a.length&&d.push(a.join(":")),d}function D(a){c.setTimeout(()=>{throw a},0)}function b(){var a=so;let l=null;return a.g&&(l=a.g,a.g=a.g.next,a.g||(a.h=null),l.next=null),l}class yt{constructor(){this.h=this.g=null}add(l,d){let p=br.get();p.set(l,d),this.h?this.h.next=p:this.g=p,this.h=p}}var br=new z(()=>new vp,a=>a.reset());class vp{constructor(){this.next=this.g=this.h=null}set(l,d){this.h=l,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let yr,Ir=!1,so=new yt,nh=()=>{let a=c.Promise.resolve(void 0);yr=()=>{a.then(Dp)}};var Dp=()=>{for(var a;a=b();){try{a.h.call(a.g)}catch(d){D(d)}var l=br;l.j(a),100>l.h&&(l.h++,a.next=l.g,l.g=a)}Ir=!1};function Gt(){this.s=this.s,this.C=this.C}Gt.prototype.s=!1,Gt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Gt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Pe(a,l){this.type=a,this.g=this.target=l,this.defaultPrevented=!1}Pe.prototype.h=function(){this.defaultPrevented=!0};var Pp=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,l=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};c.addEventListener("test",d,l),c.removeEventListener("test",d,l)}catch{}return a}();function Rr(a,l){if(Pe.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,p=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=l,l=a.relatedTarget){if(Re){e:{try{Z(l.nodeName);var w=!0;break e}catch{}w=!1}w||(l=null)}}else d=="mouseover"?l=a.fromElement:d=="mouseout"&&(l=a.toElement);this.relatedTarget=l,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Op[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Rr.aa.h.call(this)}}x(Rr,Pe);var Op={2:"touch",3:"pen",4:"mouse"};Rr.prototype.h=function(){Rr.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Cr="closure_listenable_"+(1e6*Math.random()|0),xp=0;function Lp(a,l,d,p,w){this.listener=a,this.proxy=null,this.src=l,this.type=d,this.capture=!!p,this.ha=w,this.key=++xp,this.da=this.fa=!1}function Fs(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Us(a){this.src=a,this.g={},this.h=0}Us.prototype.add=function(a,l,d,p,w){var O=a.toString();a=this.g[O],a||(a=this.g[O]=[],this.h++);var q=ao(a,l,p,w);return-1<q?(l=a[q],d||(l.fa=!1)):(l=new Lp(l,this.src,O,!!p,w),l.fa=d,a.push(l)),l};function io(a,l){var d=l.type;if(d in a.g){var p=a.g[d],w=Array.prototype.indexOf.call(p,l,void 0),O;(O=0<=w)&&Array.prototype.splice.call(p,w,1),O&&(Fs(l),a.g[d].length==0&&(delete a.g[d],a.h--))}}function ao(a,l,d,p){for(var w=0;w<a.length;++w){var O=a[w];if(!O.da&&O.listener==l&&O.capture==!!d&&O.ha==p)return w}return-1}var oo="closure_lm_"+(1e6*Math.random()|0),uo={};function rh(a,l,d,p,w){if(p&&p.once)return ih(a,l,d,p,w);if(Array.isArray(l)){for(var O=0;O<l.length;O++)rh(a,l[O],d,p,w);return null}return d=fo(d),a&&a[Cr]?a.K(l,d,f(p)?!!p.capture:!!p,w):sh(a,l,d,!1,p,w)}function sh(a,l,d,p,w,O){if(!l)throw Error("Invalid event type");var q=f(w)?!!w.capture:!!w,ce=lo(a);if(ce||(a[oo]=ce=new Us(a)),d=ce.add(l,d,p,q,O),d.proxy)return d;if(p=kp(),d.proxy=p,p.src=a,p.listener=d,a.addEventListener)Pp||(w=q),w===void 0&&(w=!1),a.addEventListener(l.toString(),p,w);else if(a.attachEvent)a.attachEvent(oh(l.toString()),p);else if(a.addListener&&a.removeListener)a.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function kp(){function a(d){return l.call(a.src,a.listener,d)}let l=Mp;return a}function ih(a,l,d,p,w){if(Array.isArray(l)){for(var O=0;O<l.length;O++)ih(a,l[O],d,p,w);return null}return d=fo(d),a&&a[Cr]?a.L(l,d,f(p)?!!p.capture:!!p,w):sh(a,l,d,!0,p,w)}function ah(a,l,d,p,w){if(Array.isArray(l))for(var O=0;O<l.length;O++)ah(a,l[O],d,p,w);else p=f(p)?!!p.capture:!!p,d=fo(d),a&&a[Cr]?(a=a.i,l=String(l).toString(),l in a.g&&(O=a.g[l],d=ao(O,d,p,w),-1<d&&(Fs(O[d]),Array.prototype.splice.call(O,d,1),O.length==0&&(delete a.g[l],a.h--)))):a&&(a=lo(a))&&(l=a.g[l.toString()],a=-1,l&&(a=ao(l,d,p,w)),(d=-1<a?l[a]:null)&&co(d))}function co(a){if(typeof a!="number"&&a&&!a.da){var l=a.src;if(l&&l[Cr])io(l.i,a);else{var d=a.type,p=a.proxy;l.removeEventListener?l.removeEventListener(d,p,a.capture):l.detachEvent?l.detachEvent(oh(d),p):l.addListener&&l.removeListener&&l.removeListener(p),(d=lo(l))?(io(d,a),d.h==0&&(d.src=null,l[oo]=null)):Fs(a)}}}function oh(a){return a in uo?uo[a]:uo[a]="on"+a}function Mp(a,l){if(a.da)a=!0;else{l=new Rr(l,this);var d=a.listener,p=a.ha||a.src;a.fa&&co(a),a=d.call(p,l)}return a}function lo(a){return a=a[oo],a instanceof Us?a:null}var ho="__closure_events_fn_"+(1e9*Math.random()>>>0);function fo(a){return typeof a=="function"?a:(a[ho]||(a[ho]=function(l){return a.handleEvent(l)}),a[ho])}function Oe(){Gt.call(this),this.i=new Us(this),this.M=this,this.F=null}x(Oe,Gt),Oe.prototype[Cr]=!0,Oe.prototype.removeEventListener=function(a,l,d,p){ah(this,a,l,d,p)};function Ve(a,l){var d,p=a.F;if(p)for(d=[];p;p=p.F)d.push(p);if(a=a.M,p=l.type||l,typeof l=="string")l=new Pe(l,a);else if(l instanceof Pe)l.target=l.target||a;else{var w=l;l=new Pe(p,a),R(l,w)}if(w=!0,d)for(var O=d.length-1;0<=O;O--){var q=l.g=d[O];w=Vs(q,p,!0,l)&&w}if(q=l.g=a,w=Vs(q,p,!0,l)&&w,w=Vs(q,p,!1,l)&&w,d)for(O=0;O<d.length;O++)q=l.g=d[O],w=Vs(q,p,!1,l)&&w}Oe.prototype.N=function(){if(Oe.aa.N.call(this),this.i){var a=this.i,l;for(l in a.g){for(var d=a.g[l],p=0;p<d.length;p++)Fs(d[p]);delete a.g[l],a.h--}}this.F=null},Oe.prototype.K=function(a,l,d,p){return this.i.add(String(a),l,!1,d,p)},Oe.prototype.L=function(a,l,d,p){return this.i.add(String(a),l,!0,d,p)};function Vs(a,l,d,p){if(l=a.i.g[String(l)],!l)return!0;l=l.concat();for(var w=!0,O=0;O<l.length;++O){var q=l[O];if(q&&!q.da&&q.capture==d){var ce=q.listener,ve=q.ha||q.src;q.fa&&io(a.i,q),w=ce.call(ve,p)!==!1&&w}}return w&&!p.defaultPrevented}function uh(a,l,d){if(typeof a=="function")d&&(a=I(a,d));else if(a&&typeof a.handleEvent=="function")a=I(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:c.setTimeout(a,l||0)}function ch(a){a.g=uh(()=>{a.g=null,a.i&&(a.i=!1,ch(a))},a.l);let l=a.h;a.h=null,a.m.apply(null,l)}class Bp extends Gt{constructor(l,d){super(),this.m=l,this.l=d,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:ch(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sr(a){Gt.call(this),this.h=a,this.g={}}x(Sr,Gt);var lh=[];function hh(a){ae(a.g,function(l,d){this.g.hasOwnProperty(d)&&co(l)},a),a.g={}}Sr.prototype.N=function(){Sr.aa.N.call(this),hh(this)},Sr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mo=c.JSON.stringify,Fp=c.JSON.parse,Up=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function po(){}po.prototype.h=null;function dh(a){return a.h||(a.h=a.i())}function fh(){}var wr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function go(){Pe.call(this,"d")}x(go,Pe);function Eo(){Pe.call(this,"c")}x(Eo,Pe);var un={},mh=null;function Hs(){return mh=mh||new Oe}un.La="serverreachability";function ph(a){Pe.call(this,un.La,a)}x(ph,Pe);function Nr(a){let l=Hs();Ve(l,new ph(l))}un.STAT_EVENT="statevent";function gh(a,l){Pe.call(this,un.STAT_EVENT,a),this.stat=l}x(gh,Pe);function He(a){let l=Hs();Ve(l,new gh(l,a))}un.Ma="timingevent";function Eh(a,l){Pe.call(this,un.Ma,a),this.size=l}x(Eh,Pe);function vr(a,l){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},l)}function Dr(){this.g=!0}Dr.prototype.xa=function(){this.g=!1};function Vp(a,l,d,p,w,O){a.info(function(){if(a.g)if(O)for(var q="",ce=O.split("&"),ve=0;ve<ce.length;ve++){var oe=ce[ve].split("=");if(1<oe.length){var xe=oe[0];oe=oe[1];var Le=xe.split("_");q=2<=Le.length&&Le[1]=="type"?q+(xe+"="+oe+"&"):q+(xe+"=redacted&")}}else q=null;else q=O;return"XMLHTTP REQ ("+p+") [attempt "+w+"]: "+l+`
`+d+`
`+q})}function Hp(a,l,d,p,w,O,q){a.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+w+"]: "+l+`
`+d+`
`+O+" "+q})}function On(a,l,d,p){a.info(function(){return"XMLHTTP TEXT ("+l+"): "+Gp(a,d)+(p?" "+p:"")})}function qp(a,l){a.info(function(){return"TIMEOUT: "+l})}Dr.prototype.info=function(){};function Gp(a,l){if(!a.g)return l;if(!l)return null;try{var d=JSON.parse(l);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var p=d[a];if(!(2>p.length)){var w=p[1];if(Array.isArray(w)&&!(1>w.length)){var O=w[0];if(O!="noop"&&O!="stop"&&O!="close")for(var q=1;q<w.length;q++)w[q]=""}}}}return mo(d)}catch{return l}}var qs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_h={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_o;function Gs(){}x(Gs,po),Gs.prototype.g=function(){return new XMLHttpRequest},Gs.prototype.i=function(){return{}},_o=new Gs;function Kt(a,l,d,p){this.j=a,this.i=l,this.l=d,this.R=p||1,this.U=new Sr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Th}function Th(){this.i=null,this.g="",this.h=!1}var Ah={},To={};function Ao(a,l,d){a.L=1,a.v=Qs(It(l)),a.m=d,a.P=!0,bh(a,null)}function bh(a,l){a.F=Date.now(),Ks(a),a.A=It(a.v);var d=a.A,p=a.R;Array.isArray(p)||(p=[String(p)]),kh(d.i,"t",p),a.C=0,d=a.j.J,a.h=new Th,a.g=Zh(a.j,d?l:null,!a.m),0<a.O&&(a.M=new Bp(I(a.Y,a,a.g),a.O)),l=a.U,d=a.g,p=a.ca;var w="readystatechange";Array.isArray(w)||(w&&(lh[0]=w.toString()),w=lh);for(var O=0;O<w.length;O++){var q=rh(d,w[O],p||l.handleEvent,!1,l.h||l);if(!q)break;l.g[q.key]=q}l=a.H?T(a.H):{},a.m?(a.u||(a.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,l)):(a.u="GET",a.g.ea(a.A,a.u,null,l)),Nr(),Vp(a.i,a.u,a.A,a.l,a.R,a.m)}Kt.prototype.ca=function(a){a=a.target;let l=this.M;l&&Rt(a)==3?l.j():this.Y(a)},Kt.prototype.Y=function(a){try{if(a==this.g)e:{let Le=Rt(this.g);var l=this.g.Ba();let kn=this.g.Z();if(!(3>Le)&&(Le!=3||this.g&&(this.h.h||this.g.oa()||qh(this.g)))){this.J||Le!=4||l==7||(l==8||0>=kn?Nr(3):Nr(2)),bo(this);var d=this.g.Z();this.X=d;t:if(yh(this)){var p=qh(this.g);a="";var w=p.length,O=Rt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cn(this),Pr(this);var q="";break t}this.h.i=new c.TextDecoder}for(l=0;l<w;l++)this.h.h=!0,a+=this.h.i.decode(p[l],{stream:!(O&&l==w-1)});p.length=0,this.h.g+=a,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=d==200,Hp(this.i,this.u,this.A,this.l,this.R,Le,d),this.o){if(this.T&&!this.K){t:{if(this.g){var ce,ve=this.g;if((ce=ve.g?ve.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(ce)){var oe=ce;break t}}oe=null}if(d=oe)On(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,yo(this,d);else{this.o=!1,this.s=3,He(12),cn(this),Pr(this);break e}}if(this.P){d=!0;let st;for(;!this.J&&this.C<q.length;)if(st=Kp(this,q),st==To){Le==4&&(this.s=4,He(14),d=!1),On(this.i,this.l,null,"[Incomplete Response]");break}else if(st==Ah){this.s=4,He(15),On(this.i,this.l,q,"[Invalid Chunk]"),d=!1;break}else On(this.i,this.l,st,null),yo(this,st);if(yh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Le!=4||q.length!=0||this.h.h||(this.s=1,He(16),d=!1),this.o=this.o&&d,!d)On(this.i,this.l,q,"[Invalid Chunked Response]"),cn(this),Pr(this);else if(0<q.length&&!this.W){this.W=!0;var xe=this.j;xe.g==this&&xe.ba&&!xe.M&&(xe.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),No(xe),xe.M=!0,He(11))}}else On(this.i,this.l,q,null),yo(this,q);Le==4&&cn(this),this.o&&!this.J&&(Le==4?Yh(this.j,this):(this.o=!1,Ks(this)))}else og(this.g),d==400&&0<q.indexOf("Unknown SID")?(this.s=3,He(12)):(this.s=0,He(13)),cn(this),Pr(this)}}}catch{}finally{}};function yh(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Kp(a,l){var d=a.C,p=l.indexOf(`
`,d);return p==-1?To:(d=Number(l.substring(d,p)),isNaN(d)?Ah:(p+=1,p+d>l.length?To:(l=l.slice(p,p+d),a.C=p+d,l)))}Kt.prototype.cancel=function(){this.J=!0,cn(this)};function Ks(a){a.S=Date.now()+a.I,Ih(a,a.I)}function Ih(a,l){if(a.B!=null)throw Error("WatchDog timer not null");a.B=vr(I(a.ba,a),l)}function bo(a){a.B&&(c.clearTimeout(a.B),a.B=null)}Kt.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(qp(this.i,this.A),this.L!=2&&(Nr(),He(17)),cn(this),this.s=2,Pr(this)):Ih(this,this.S-a)};function Pr(a){a.j.G==0||a.J||Yh(a.j,a)}function cn(a){bo(a);var l=a.M;l&&typeof l.ma=="function"&&l.ma(),a.M=null,hh(a.U),a.g&&(l=a.g,a.g=null,l.abort(),l.ma())}function yo(a,l){try{var d=a.j;if(d.G!=0&&(d.g==a||Io(d.h,a))){if(!a.K&&Io(d.h,a)&&d.G==3){try{var p=d.Da.g.parse(l)}catch{p=null}if(Array.isArray(p)&&p.length==3){var w=p;if(w[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)Js(d),$s(d);else break e;wo(d),He(18)}}else d.za=w[1],0<d.za-d.T&&37500>w[2]&&d.F&&d.v==0&&!d.C&&(d.C=vr(I(d.Za,d),6e3));if(1>=Sh(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else hn(d,11)}else if((a.K||d.g==a)&&Js(d),!$(l))for(w=d.Da.g.parse(l),l=0;l<w.length;l++){let oe=w[l];if(d.T=oe[0],oe=oe[1],d.G==2)if(oe[0]=="c"){d.K=oe[1],d.ia=oe[2];let xe=oe[3];xe!=null&&(d.la=xe,d.j.info("VER="+d.la));let Le=oe[4];Le!=null&&(d.Aa=Le,d.j.info("SVER="+d.Aa));let kn=oe[5];kn!=null&&typeof kn=="number"&&0<kn&&(p=1.5*kn,d.L=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let st=a.g;if(st){let ei=st.g?st.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ei){var O=p.h;O.g||ei.indexOf("spdy")==-1&&ei.indexOf("quic")==-1&&ei.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(Ro(O,O.h),O.h=null))}if(p.D){let vo=st.g?st.g.getResponseHeader("X-HTTP-Session-Id"):null;vo&&(p.ya=vo,de(p.I,p.D,vo))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),p=d;var q=a;if(p.qa=Jh(p,p.J?p.ia:null,p.W),q.K){wh(p.h,q);var ce=q,ve=p.L;ve&&(ce.I=ve),ce.B&&(bo(ce),Ks(ce)),p.g=q}else Qh(p);0<d.i.length&&Xs(d)}else oe[0]!="stop"&&oe[0]!="close"||hn(d,7);else d.G==3&&(oe[0]=="stop"||oe[0]=="close"?oe[0]=="stop"?hn(d,7):So(d):oe[0]!="noop"&&d.l&&d.l.ta(oe),d.v=0)}}Nr(4)}catch{}}var zp=class{constructor(a,l){this.g=a,this.map=l}};function Rh(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ch(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Sh(a){return a.h?1:a.g?a.g.size:0}function Io(a,l){return a.h?a.h==l:a.g?a.g.has(l):!1}function Ro(a,l){a.g?a.g.add(l):a.h=l}function wh(a,l){a.h&&a.h==l?a.h=null:a.g&&a.g.has(l)&&a.g.delete(l)}Rh.prototype.cancel=function(){if(this.i=Nh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Nh(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let l=a.i;for(let d of a.g.values())l=l.concat(d.D);return l}return U(a.i)}function jp(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(h(a)){for(var l=[],d=a.length,p=0;p<d;p++)l.push(a[p]);return l}l=[],d=0;for(p in a)l[d++]=a[p];return l}function Qp(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(h(a)||typeof a=="string"){var l=[];a=a.length;for(var d=0;d<a;d++)l.push(d);return l}l=[],d=0;for(let p in a)l[d++]=p;return l}}}function vh(a,l){if(a.forEach&&typeof a.forEach=="function")a.forEach(l,void 0);else if(h(a)||typeof a=="string")Array.prototype.forEach.call(a,l,void 0);else for(var d=Qp(a),p=jp(a),w=p.length,O=0;O<w;O++)l.call(void 0,p[O],d&&d[O],a)}var Dh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wp(a,l){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var p=a[d].indexOf("="),w=null;if(0<=p){var O=a[d].substring(0,p);w=a[d].substring(p+1)}else O=a[d];l(O,w?decodeURIComponent(w.replace(/\+/g," ")):"")}}}function ln(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof ln){this.h=a.h,zs(this,a.j),this.o=a.o,this.g=a.g,js(this,a.s),this.l=a.l;var l=a.i,d=new Lr;d.i=l.i,l.g&&(d.g=new Map(l.g),d.h=l.h),Ph(this,d),this.m=a.m}else a&&(l=String(a).match(Dh))?(this.h=!1,zs(this,l[1]||"",!0),this.o=Or(l[2]||""),this.g=Or(l[3]||"",!0),js(this,l[4]),this.l=Or(l[5]||"",!0),Ph(this,l[6]||"",!0),this.m=Or(l[7]||"")):(this.h=!1,this.i=new Lr(null,this.h))}ln.prototype.toString=function(){var a=[],l=this.j;l&&a.push(xr(l,Oh,!0),":");var d=this.g;return(d||l=="file")&&(a.push("//"),(l=this.o)&&a.push(xr(l,Oh,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(xr(d,d.charAt(0)=="/"?Xp:$p,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",xr(d,Zp)),a.join("")};function It(a){return new ln(a)}function zs(a,l,d){a.j=d?Or(l,!0):l,a.j&&(a.j=a.j.replace(/:$/,""))}function js(a,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);a.s=l}else a.s=null}function Ph(a,l,d){l instanceof Lr?(a.i=l,eg(a.i,a.h)):(d||(l=xr(l,Jp)),a.i=new Lr(l,a.h))}function de(a,l,d){a.i.set(l,d)}function Qs(a){return de(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Or(a,l){return a?l?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function xr(a,l,d){return typeof a=="string"?(a=encodeURI(a).replace(l,Yp),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Yp(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Oh=/[#\/\?@]/g,$p=/[#\?:]/g,Xp=/[#\?]/g,Jp=/[#\?@]/g,Zp=/#/g;function Lr(a,l){this.h=this.g=null,this.i=a||null,this.j=!!l}function zt(a){a.g||(a.g=new Map,a.h=0,a.i&&Wp(a.i,function(l,d){a.add(decodeURIComponent(l.replace(/\+/g," ")),d)}))}t=Lr.prototype,t.add=function(a,l){zt(this),this.i=null,a=xn(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(l),this.h+=1,this};function xh(a,l){zt(a),l=xn(a,l),a.g.has(l)&&(a.i=null,a.h-=a.g.get(l).length,a.g.delete(l))}function Lh(a,l){return zt(a),l=xn(a,l),a.g.has(l)}t.forEach=function(a,l){zt(this),this.g.forEach(function(d,p){d.forEach(function(w){a.call(l,w,p,this)},this)},this)},t.na=function(){zt(this);let a=Array.from(this.g.values()),l=Array.from(this.g.keys()),d=[];for(let p=0;p<l.length;p++){let w=a[p];for(let O=0;O<w.length;O++)d.push(l[p])}return d},t.V=function(a){zt(this);let l=[];if(typeof a=="string")Lh(this,a)&&(l=l.concat(this.g.get(xn(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)l=l.concat(a[d])}return l},t.set=function(a,l){return zt(this),this.i=null,a=xn(this,a),Lh(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[l]),this.h+=1,this},t.get=function(a,l){return a?(a=this.V(a),0<a.length?String(a[0]):l):l};function kh(a,l,d){xh(a,l),0<d.length&&(a.i=null,a.g.set(xn(a,l),U(d)),a.h+=d.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],l=Array.from(this.g.keys());for(var d=0;d<l.length;d++){var p=l[d];let O=encodeURIComponent(String(p)),q=this.V(p);for(p=0;p<q.length;p++){var w=O;q[p]!==""&&(w+="="+encodeURIComponent(String(q[p]))),a.push(w)}}return this.i=a.join("&")};function xn(a,l){return l=String(l),a.j&&(l=l.toLowerCase()),l}function eg(a,l){l&&!a.j&&(zt(a),a.i=null,a.g.forEach(function(d,p){var w=p.toLowerCase();p!=w&&(xh(this,p),kh(this,w,d))},a)),a.j=l}function tg(a,l){let d=new Dr;if(c.Image){let p=new Image;p.onload=v(jt,d,"TestLoadImage: loaded",!0,l,p),p.onerror=v(jt,d,"TestLoadImage: error",!1,l,p),p.onabort=v(jt,d,"TestLoadImage: abort",!1,l,p),p.ontimeout=v(jt,d,"TestLoadImage: timeout",!1,l,p),c.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=a}else l(!1)}function ng(a,l){let d=new Dr,p=new AbortController,w=setTimeout(()=>{p.abort(),jt(d,"TestPingServer: timeout",!1,l)},1e4);fetch(a,{signal:p.signal}).then(O=>{clearTimeout(w),O.ok?jt(d,"TestPingServer: ok",!0,l):jt(d,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(w),jt(d,"TestPingServer: error",!1,l)})}function jt(a,l,d,p,w){try{w&&(w.onload=null,w.onerror=null,w.onabort=null,w.ontimeout=null),p(d)}catch{}}function rg(){this.g=new Up}function sg(a,l,d){let p=d||"";try{vh(a,function(w,O){let q=w;f(w)&&(q=mo(w)),l.push(p+O+"="+encodeURIComponent(q))})}catch(w){throw l.push(p+"type="+encodeURIComponent("_badmap")),w}}function kr(a){this.l=a.Ub||null,this.j=a.eb||!1}x(kr,po),kr.prototype.g=function(){return new Ws(this.l,this.j)},kr.prototype.i=function(a){return function(){return a}}({});function Ws(a,l){Oe.call(this),this.D=a,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Ws,Oe),t=Ws.prototype,t.open=function(a,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=l,this.readyState=1,Br(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(l.body=a),(this.D||c).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Mr(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Br(this)),this.g&&(this.readyState=3,Br(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Mh(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Mh(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var l=a.value?a.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!a.done}))&&(this.response=this.responseText+=l)}a.done?Mr(this):Br(this),this.readyState==3&&Mh(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Mr(this))},t.Qa=function(a){this.g&&(this.response=a,Mr(this))},t.ga=function(){this.g&&Mr(this)};function Mr(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Br(a)}t.setRequestHeader=function(a,l){this.u.append(a,l)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],l=this.h.entries();for(var d=l.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=l.next();return a.join(`\r
`)};function Br(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ws.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Bh(a){let l="";return ae(a,function(d,p){l+=p,l+=":",l+=d,l+=`\r
`}),l}function Co(a,l,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=Bh(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):de(a,l,d))}function Ee(a){Oe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Ee,Oe);var ig=/^https?$/i,ag=["POST","PUT"];t=Ee.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,l,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);l=l?l.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_o.g(),this.v=this.o?dh(this.o):dh(_o),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(l,String(a),!0),this.B=!1}catch(O){Fh(this,O);return}if(a=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var w in p)d.set(w,p[w]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let O of p.keys())d.set(O,p.get(O));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(O=>O.toLowerCase()=="content-type"),w=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(ag,l,void 0))||p||w||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[O,q]of d)this.g.setRequestHeader(O,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Hh(this),this.u=!0,this.g.send(a),this.u=!1}catch(O){Fh(this,O)}};function Fh(a,l){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=l,a.m=5,Uh(a),Ys(a)}function Uh(a){a.A||(a.A=!0,Ve(a,"complete"),Ve(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Ve(this,"complete"),Ve(this,"abort"),Ys(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ys(this,!0)),Ee.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Vh(this):this.bb())},t.bb=function(){Vh(this)};function Vh(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Rt(a)!=4||a.Z()!=2)){if(a.u&&Rt(a)==4)uh(a.Ea,0,a);else if(Ve(a,"readystatechange"),Rt(a)==4){a.h=!1;try{let q=a.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var d;if(!(d=l)){var p;if(p=q===0){var w=String(a.D).match(Dh)[1]||null;!w&&c.self&&c.self.location&&(w=c.self.location.protocol.slice(0,-1)),p=!ig.test(w?w.toLowerCase():"")}d=p}if(d)Ve(a,"complete"),Ve(a,"success");else{a.m=6;try{var O=2<Rt(a)?a.g.statusText:""}catch{O=""}a.l=O+" ["+a.Z()+"]",Uh(a)}}finally{Ys(a)}}}}function Ys(a,l){if(a.g){Hh(a);let d=a.g,p=a.v[0]?()=>{}:null;a.g=null,a.v=null,l||Ve(a,"ready");try{d.onreadystatechange=p}catch{}}}function Hh(a){a.I&&(c.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Rt(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Rt(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var l=this.g.responseText;return a&&l.indexOf(a)==0&&(l=l.substring(a.length)),Fp(l)}};function qh(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function og(a){let l={};a=(a.g&&2<=Rt(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<a.length;p++){if($(a[p]))continue;var d=S(a[p]);let w=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let O=l[w]||[];l[w]=O,O.push(d)}C(l,function(p){return p.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fr(a,l,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||l}function Gh(a){this.Aa=0,this.i=[],this.j=new Dr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fr("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fr("baseRetryDelayMs",5e3,a),this.cb=Fr("retryDelaySeedMs",1e4,a),this.Wa=Fr("forwardChannelMaxRetries",2,a),this.wa=Fr("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Rh(a&&a.concurrentRequestLimit),this.Da=new rg,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Gh.prototype,t.la=8,t.G=1,t.connect=function(a,l,d,p){He(0),this.W=a,this.H=l||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.I=Jh(this,null,this.W),Xs(this)};function So(a){if(Kh(a),a.G==3){var l=a.U++,d=It(a.I);if(de(d,"SID",a.K),de(d,"RID",l),de(d,"TYPE","terminate"),Ur(a,d),l=new Kt(a,a.j,l),l.L=2,l.v=Qs(It(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(l.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=l.v,d=!0),d||(l.g=Zh(l.j,null),l.g.ea(l.v)),l.F=Date.now(),Ks(l)}Xh(a)}function $s(a){a.g&&(No(a),a.g.cancel(),a.g=null)}function Kh(a){$s(a),a.u&&(c.clearTimeout(a.u),a.u=null),Js(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function Xs(a){if(!Ch(a.h)&&!a.s){a.s=!0;var l=a.Ga;yr||nh(),Ir||(yr(),Ir=!0),so.add(l,a),a.B=0}}function ug(a,l){return Sh(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=l.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=vr(I(a.Ga,a,l),$h(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let w=new Kt(this,this.j,a),O=this.o;if(this.S&&(O?(O=T(O),R(O,this.S)):O=this.S),this.m!==null||this.O||(w.H=O,O=null),this.P)e:{for(var l=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(l+=p,4096<l){l=d;break e}if(l===4096||d===this.i.length-1){l=d+1;break e}}l=1e3}else l=1e3;l=jh(this,w,l),d=It(this.I),de(d,"RID",a),de(d,"CVER",22),this.D&&de(d,"X-HTTP-Session-Id",this.D),Ur(this,d),O&&(this.O?l="headers="+encodeURIComponent(String(Bh(O)))+"&"+l:this.m&&Co(d,this.m,O)),Ro(this.h,w),this.Ua&&de(d,"TYPE","init"),this.P?(de(d,"$req",l),de(d,"SID","null"),w.T=!0,Ao(w,d,null)):Ao(w,d,l),this.G=2}}else this.G==3&&(a?zh(this,a):this.i.length==0||Ch(this.h)||zh(this))};function zh(a,l){var d;l?d=l.l:d=a.U++;let p=It(a.I);de(p,"SID",a.K),de(p,"RID",d),de(p,"AID",a.T),Ur(a,p),a.m&&a.o&&Co(p,a.m,a.o),d=new Kt(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),l&&(a.i=l.D.concat(a.i)),l=jh(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ro(a.h,d),Ao(d,p,l)}function Ur(a,l){a.H&&ae(a.H,function(d,p){de(l,p,d)}),a.l&&vh({},function(d,p){de(l,p,d)})}function jh(a,l,d){d=Math.min(a.i.length,d);var p=a.l?I(a.l.Na,a.l,a):null;e:{var w=a.i;let O=-1;for(;;){let q=["count="+d];O==-1?0<d?(O=w[0].g,q.push("ofs="+O)):O=0:q.push("ofs="+O);let ce=!0;for(let ve=0;ve<d;ve++){let oe=w[ve].g,xe=w[ve].map;if(oe-=O,0>oe)O=Math.max(0,w[ve].g-100),ce=!1;else try{sg(xe,q,"req"+oe+"_")}catch{p&&p(xe)}}if(ce){p=q.join("&");break e}}}return a=a.i.splice(0,d),l.D=a,p}function Qh(a){if(!a.g&&!a.u){a.Y=1;var l=a.Fa;yr||nh(),Ir||(yr(),Ir=!0),so.add(l,a),a.v=0}}function wo(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=vr(I(a.Fa,a),$h(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Wh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=vr(I(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,He(10),$s(this),Wh(this))};function No(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function Wh(a){a.g=new Kt(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var l=It(a.qa);de(l,"RID","rpc"),de(l,"SID",a.K),de(l,"AID",a.T),de(l,"CI",a.F?"0":"1"),!a.F&&a.ja&&de(l,"TO",a.ja),de(l,"TYPE","xmlhttp"),Ur(a,l),a.m&&a.o&&Co(l,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Qs(It(l)),d.m=null,d.P=!0,bh(d,a)}t.Za=function(){this.C!=null&&(this.C=null,$s(this),wo(this),He(19))};function Js(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function Yh(a,l){var d=null;if(a.g==l){Js(a),No(a),a.g=null;var p=2}else if(Io(a.h,l))d=l.D,wh(a.h,l),p=1;else return;if(a.G!=0){if(l.o)if(p==1){d=l.m?l.m.length:0,l=Date.now()-l.F;var w=a.B;p=Hs(),Ve(p,new Eh(p,d)),Xs(a)}else Qh(a);else if(w=l.s,w==3||w==0&&0<l.X||!(p==1&&ug(a,l)||p==2&&wo(a)))switch(d&&0<d.length&&(l=a.h,l.i=l.i.concat(d)),w){case 1:hn(a,5);break;case 4:hn(a,10);break;case 3:hn(a,6);break;default:hn(a,2)}}}function $h(a,l){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*l}function hn(a,l){if(a.j.info("Error code "+l),l==2){var d=I(a.fb,a),p=a.Xa;let w=!p;p=new ln(p||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||zs(p,"https"),Qs(p),w?tg(p.toString(),d):ng(p.toString(),d)}else He(2);a.G=0,a.l&&a.l.sa(l),Xh(a),Kh(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),He(2)):(this.j.info("Failed to ping google.com"),He(1))};function Xh(a){if(a.G=0,a.ka=[],a.l){let l=Nh(a.h);(l.length!=0||a.i.length!=0)&&(k(a.ka,l),k(a.ka,a.i),a.h.i.length=0,U(a.i),a.i.length=0),a.l.ra()}}function Jh(a,l,d){var p=d instanceof ln?It(d):new ln(d);if(p.g!="")l&&(p.g=l+"."+p.g),js(p,p.s);else{var w=c.location;p=w.protocol,l=l?l+"."+w.hostname:w.hostname,w=+w.port;var O=new ln(null);p&&zs(O,p),l&&(O.g=l),w&&js(O,w),d&&(O.l=d),p=O}return d=a.D,l=a.ya,d&&l&&de(p,d,l),de(p,"VER",a.la),Ur(a,p),p}function Zh(a,l,d){if(l&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=a.Ca&&!a.pa?new Ee(new kr({eb:d})):new Ee(a.pa),l.Ha(a.J),l}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ed(){}t=ed.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zs(){}Zs.prototype.g=function(a,l){return new We(a,l)};function We(a,l){Oe.call(this),this.g=new Gh(l),this.l=a,this.h=l&&l.messageUrlParams||null,a=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(a?a["X-WebChannel-Content-Type"]=l.messageContentType:a={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(a?a["X-WebChannel-Client-Profile"]=l.va:a={"X-WebChannel-Client-Profile":l.va}),this.g.S=a,(a=l&&l.Sb)&&!$(a)&&(this.g.m=a),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!$(l)&&(this.g.D=l,a=this.h,a!==null&&l in a&&(a=this.h,l in a&&delete a[l])),this.j=new Ln(this)}x(We,Oe),We.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},We.prototype.close=function(){So(this.g)},We.prototype.o=function(a){var l=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=mo(a),a=d);l.i.push(new zp(l.Ya++,a)),l.G==3&&Xs(l)},We.prototype.N=function(){this.g.l=null,delete this.j,So(this.g),delete this.g,We.aa.N.call(this)};function td(a){go.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var l=a.__sm__;if(l){e:{for(let d in l){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,l=l!==null&&a in l?l[a]:void 0),this.data=l}else this.data=a}x(td,go);function nd(){Eo.call(this),this.status=1}x(nd,Eo);function Ln(a){this.g=a}x(Ln,ed),Ln.prototype.ua=function(){Ve(this.g,"a")},Ln.prototype.ta=function(a){Ve(this.g,new td(a))},Ln.prototype.sa=function(a){Ve(this.g,new nd)},Ln.prototype.ra=function(){Ve(this.g,"b")},Zs.prototype.createWebChannel=Zs.prototype.g,We.prototype.send=We.prototype.o,We.prototype.open=We.prototype.m,We.prototype.close=We.prototype.close,nu=Nt.createWebChannelTransport=function(){return new Zs},tu=Nt.getStatEventTarget=function(){return Hs()},eu=Nt.Event=un,fi=Nt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qs.NO_ERROR=0,qs.TIMEOUT=8,qs.HTTP_ERROR=6,Kr=Nt.ErrorCode=qs,_h.COMPLETE="complete",Zo=Nt.EventType=_h,fh.EventType=wr,wr.OPEN="a",wr.CLOSE="b",wr.ERROR="c",wr.MESSAGE="d",Oe.prototype.listen=Oe.prototype.K,Fn=Nt.WebChannel=fh,PE=Nt.FetchXmlHttpFactory=kr,Ee.prototype.listenOnce=Ee.prototype.L,Ee.prototype.getLastError=Ee.prototype.Ka,Ee.prototype.getLastErrorCode=Ee.prototype.Ba,Ee.prototype.getStatus=Ee.prototype.Z,Ee.prototype.getResponseJson=Ee.prototype.Oa,Ee.prototype.getResponseText=Ee.prototype.oa,Ee.prototype.send=Ee.prototype.ea,Ee.prototype.setWithCredentials=Ee.prototype.Ha,Jo=Nt.XhrIo=Ee}).apply(typeof di<"u"?di:typeof self<"u"?self:typeof window<"u"?window:{});var xd="@firebase/firestore";var Se=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Se.UNAUTHENTICATED=new Se(null),Se.GOOGLE_CREDENTIALS=new Se("google-credentials-uid"),Se.FIRST_PARTY=new Se("first-party-uid"),Se.MOCK_USER=new Se("mock-user");var ir="11.0.2";var gn=new Bn("@firebase/firestore");function Un(){return gn.logLevel}function K(t,...e){if(gn.logLevel<=re.DEBUG){let n=e.map(jc);gn.debug(`Firestore (${ir}): ${t}`,...n)}}function Dt(t,...e){if(gn.logLevel<=re.ERROR){let n=e.map(jc);gn.error(`Firestore (${ir}): ${t}`,...n)}}function jn(t,...e){if(gn.logLevel<=re.WARN){let n=e.map(jc);gn.warn(`Firestore (${ir}): ${t}`,...n)}}function jc(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function Y(t="Unexpected state"){let e=`FIRESTORE (${ir}) INTERNAL ASSERTION FAILED: `+t;throw Dt(e),new Error(e)}function ue(t,e){t||Y()}function X(t,e){return t}var F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},G=class extends Ke{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ze=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Ai=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},ou=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Se.UNAUTHENTICATED))}shutdown(){}},uu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},cu=class{constructor(e){this.t=e,this.currentUser=Se.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ue(this.o===void 0);let r=this.i,s=h=>this.i!==r?(r=this.i,n(h)):Promise.resolve(),i=new ze;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ze,e.enqueueRetryable(()=>s(this.currentUser))};let o=()=>{let h=i;e.enqueueRetryable(async()=>{await h.promise,await s(this.currentUser)})},c=h=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(h=>c(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?c(h):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ze)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string"),new Ai(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string"),new Se(e)}},lu=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Se.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},hu=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new lu(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Se.FIRST_PARTY))}shutdown(){}invalidateToken(){}},du=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},fu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ue(this.o===void 0);let r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);let o=i.token!==this.R;return this.R=i.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};let s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){let i=this.A.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ue(typeof n.token=="string"),this.R=n.token,new du(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function OE(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var bi=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let s=OE(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}};function se(t,e){return t<e?-1:t>e?1:0}function Qn(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}var Ae=class t{static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var J=class t{static fromTimestamp(e){return new t(e)}static min(){return new t(new Ae(0,0))}static max(){return new t(new Ae(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var yi=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&Y(),r===void 0?r=e.length-n:r>e.length-n&&Y(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let s=0;s<r;s++){let i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},pe=class t extends yi{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new G(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new t(n)}static emptyPath(){return new t([])}},xE=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$e=class t extends yi{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return xE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",s=0,i=()=>{if(r.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;s<e.length;){let c=e[s];if(c==="\\"){if(s+1===e.length)throw new G(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new G(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new G(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var Q=class t{constructor(e){this.path=e}static fromPath(e){return new t(pe.fromString(e))}static fromName(e){return new t(pe.fromString(e).popFirst(5))}static empty(){return new t(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return pe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new pe(e.slice()))}};var mu=class{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}};mu.UNKNOWN_ID=-1;function LE(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=J.fromTimestamp(r===1e9?new Ae(n+1,0):new Ae(n,r));return new En(s,Q.empty(),e)}function kE(t){return new En(t.readTime,t.key,-1)}var En=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(J.min(),Q.empty(),-1)}static max(){return new t(J.max(),Q.empty(),-1)}};function ME(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Q.comparator(t.documentKey,e.documentKey),n!==0?n:se(t.largestBatchId,e.largestBatchId))}var BE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",pu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function ar(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==BE)throw t;K("LocalStore","Unexpectedly lost primary lease")}var V=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},h=>r(h))}),o=!0,i===s&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(s=>s?t.resolve(s):r());return n}static forEach(e,n){let r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new t((r,s)=>{let i=e.length,o=new Array(i),c=0;for(let h=0;h<i;h++){let f=h;n(e[f]).next(m=>{o[f]=m,++c,c===i&&r(o)},m=>s(m))}})}static doWhile(e,n){return new t((r,s)=>{let i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}};function FE(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function or(t){return t.name==="IndexedDbTransactionError"}var Wn=class{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.se&&this.se(e),e}};Wn.oe=-1;function na(t){return t==null}function Yr(t){return t===0&&1/t==-1/0}function UE(t){return typeof t=="number"&&Number.isInteger(t)&&!Yr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function VE(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Ld(e)),e=HE(t.get(n),e);return Ld(e)}function HE(t,e){let n=e,r=t.length;for(let s=0;s<r;s++){let i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Ld(t){return t+""}var qE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],bI=[...qE,"documentOverlays"],GE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],KE=GE,zE=[...KE,"indexConfiguration","indexState","indexEntries"];var yI=[...zE,"globals"];function kd(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function nn(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jE(t,e){let n=[];for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function mf(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Te=class t{constructor(e,n){this.comparator=e,this.root=n||ht.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ht.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ht.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qn(this.root,e,this.comparator,!1)}getReverseIterator(){return new qn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qn(this.root,e,this.comparator,!0)}},qn=class{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ht=class t{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??t.RED,this.left=s??t.EMPTY,this.right=i??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new t(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this,i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();let e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}};ht.EMPTY=null,ht.RED=!0,ht.BLACK=!1;ht.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ht(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var we=class t{constructor(e){this.comparator=e,this.data=new Te(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ii(this.data.getIterator())}getIteratorFrom(e){return new Ii(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Ii=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var nt=class t{constructor(e){this.fields=e,e.sort($e.comparator)}static empty(){return new t([])}unionWith(e){let n=new we($e.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Qn(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Ri=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Me=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ri("Invalid base64 string: "+i):i}}(e);return new t(n)}static fromUint8Array(e){let n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Me.EMPTY_BYTE_STRING=new Me("");var QE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pt(t){if(ue(!!t),typeof t=="string"){let e=0,n=QE.exec(t);if(ue(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:me(t.seconds),nanos:me(t.nanos)}}function me(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ot(t){return typeof t=="string"?Me.fromBase64String(t):Me.fromUint8Array(t)}function ra(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function sa(t){let e=t.mapValue.fields.__previous_value__;return ra(e)?sa(e):e}function $r(t){let e=Pt(t.mapValue.fields.__local_write_time__.timestampValue);return new Ae(e.seconds,e.nanos)}var gu=class{constructor(e,n,r,s,i,o,c,h,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=f}},Ci=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var mi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Jt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ra(t)?4:gf(t)?9007199254740991:pf(t)?10:11:Y()}function mt(t,e){if(t===e)return!0;let n=Jt(t);if(n!==Jt(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $r(t).isEqual($r(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;let o=Pt(s.timestampValue),c=Pt(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ot(s.bytesValue).isEqual(Ot(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return me(s.geoPointValue.latitude)===me(i.geoPointValue.latitude)&&me(s.geoPointValue.longitude)===me(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return me(s.integerValue)===me(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){let o=me(s.doubleValue),c=me(i.doubleValue);return o===c?Yr(o)===Yr(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Qn(t.arrayValue.values||[],e.arrayValue.values||[],mt);case 10:case 11:return function(s,i){let o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(kd(o)!==kd(c))return!1;for(let h in o)if(o.hasOwnProperty(h)&&(c[h]===void 0||!mt(o[h],c[h])))return!1;return!0}(t,e);default:return Y()}}function Xr(t,e){return(t.values||[]).find(n=>mt(n,e))!==void 0}function Yn(t,e){if(t===e)return 0;let n=Jt(t),r=Jt(e);if(n!==r)return se(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return se(t.booleanValue,e.booleanValue);case 2:return function(i,o){let c=me(i.integerValue||i.doubleValue),h=me(o.integerValue||o.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1}(t,e);case 3:return Md(t.timestampValue,e.timestampValue);case 4:return Md($r(t),$r(e));case 5:return se(t.stringValue,e.stringValue);case 6:return function(i,o){let c=Ot(i),h=Ot(o);return c.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){let c=i.split("/"),h=o.split("/");for(let f=0;f<c.length&&f<h.length;f++){let m=se(c[f],h[f]);if(m!==0)return m}return se(c.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){let c=se(me(i.latitude),me(o.latitude));return c!==0?c:se(me(i.longitude),me(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Bd(t.arrayValue,e.arrayValue);case 10:return function(i,o){var c,h,f,m;let _=i.fields||{},I=o.fields||{},v=(c=_.value)===null||c===void 0?void 0:c.arrayValue,x=(h=I.value)===null||h===void 0?void 0:h.arrayValue,U=se(((f=v?.values)===null||f===void 0?void 0:f.length)||0,((m=x?.values)===null||m===void 0?void 0:m.length)||0);return U!==0?U:Bd(v,x)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===mi.mapValue&&o===mi.mapValue)return 0;if(i===mi.mapValue)return 1;if(o===mi.mapValue)return-1;let c=i.fields||{},h=Object.keys(c),f=o.fields||{},m=Object.keys(f);h.sort(),m.sort();for(let _=0;_<h.length&&_<m.length;++_){let I=se(h[_],m[_]);if(I!==0)return I;let v=Yn(c[h[_]],f[m[_]]);if(v!==0)return v}return se(h.length,m.length)}(t.mapValue,e.mapValue);default:throw Y()}}function Md(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return se(t,e);let n=Pt(t),r=Pt(e),s=se(n.seconds,r.seconds);return s!==0?s:se(n.nanos,r.nanos)}function Bd(t,e){let n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){let i=Yn(n[s],r[s]);if(i)return i}return se(n.length,r.length)}function $n(t){return Eu(t)}function Eu(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Pt(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ot(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Q.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(let i of n.values||[])s?s=!1:r+=",",r+=Eu(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),s="{",i=!0;for(let o of r)i?i=!1:s+=",",s+=`${o}:${Eu(n.fields[o])}`;return s+"}"}(t.mapValue):Y()}function Ei(t){switch(Jt(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=sa(t);return e?16+Ei(e):16;case 5:return 2*t.stringValue.length;case 6:return Ot(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Ei(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return nn(r.fields,(i,o)=>{s+=i.length+Ei(o)}),s}(t.mapValue);default:throw Y()}}function Si(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _u(t){return!!t&&"integerValue"in t}function Qc(t){return!!t&&"arrayValue"in t}function Fd(t){return!!t&&"nullValue"in t}function Ud(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _i(t){return!!t&&"mapValue"in t}function pf(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function jr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return nn(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=jr(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=jr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function gf(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ye=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!_i(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=jr(n)}setAll(e){let n=$e.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){let h=this.getFieldsMap(n);this.applyChanges(h,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=jr(o):s.push(c.lastSegment())});let i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){let n=this.field(e.popLast());_i(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return mt(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];_i(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){nn(n,(s,i)=>e[s]=i);for(let s of r)delete e[s]}clone(){return new t(jr(this.value))}};function Ef(t){let e=[];return nn(t.fields,(n,r)=>{let s=new $e([n]);if(_i(r)){let i=Ef(r.mapValue).fields;if(i.length===0)e.push(s);else for(let o of i)e.push(s.child(o))}else e.push(s)}),new nt(e)}var at=class t{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new t(e,0,J.min(),J.min(),J.min(),Ye.empty(),0)}static newFoundDocument(e,n,r,s){return new t(e,1,n,J.min(),r,s,0)}static newNoDocument(e,n){return new t(e,2,n,J.min(),J.min(),Ye.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,J.min(),J.min(),Ye.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ye.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ye.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Zt=class{constructor(e,n){this.position=e,this.inclusive=n}};function Vd(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){let i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Q.comparator(Q.fromName(o.referenceValue),n.key):r=Yn(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Hd(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!mt(t.position[n],e.position[n]))return!1;return!0}var _n=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function WE(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var wi=class{},Ie=class t extends wi{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Au(e,n,r):n==="array-contains"?new Iu(e,r):n==="in"?new Ru(e,r):n==="not-in"?new Cu(e,r):n==="array-contains-any"?new Su(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new bu(e,r):new yu(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Yn(n,this.value)):n!==null&&Jt(this.value)===Jt(n)&&this.matchesComparison(Yn(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ot=class t extends wi{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new t(e,n)}matches(e){return _f(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function _f(t){return t.op==="and"}function Tf(t){return YE(t)&&_f(t)}function YE(t){for(let e of t.filters)if(e instanceof ot)return!1;return!0}function Tu(t){if(t instanceof Ie)return t.field.canonicalString()+t.op.toString()+$n(t.value);if(Tf(t))return t.filters.map(e=>Tu(e)).join(",");{let e=t.filters.map(n=>Tu(n)).join(",");return`${t.op}(${e})`}}function Af(t,e){return t instanceof Ie?function(r,s){return s instanceof Ie&&r.op===s.op&&r.field.isEqual(s.field)&&mt(r.value,s.value)}(t,e):t instanceof ot?function(r,s){return s instanceof ot&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&Af(o,s.filters[c]),!0):!1}(t,e):void Y()}function bf(t){return t instanceof Ie?function(n){return`${n.field.canonicalString()} ${n.op} ${$n(n.value)}`}(t):t instanceof ot?function(n){return n.op.toString()+" {"+n.getFilters().map(bf).join(" ,")+"}"}(t):"Filter"}var Au=class extends Ie{constructor(e,n,r){super(e,n,r),this.key=Q.fromName(r.referenceValue)}matches(e){let n=Q.comparator(e.key,this.key);return this.matchesComparison(n)}},bu=class extends Ie{constructor(e,n){super(e,"in",n),this.keys=yf("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},yu=class extends Ie{constructor(e,n){super(e,"not-in",n),this.keys=yf("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function yf(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Q.fromName(r.referenceValue))}var Iu=class extends Ie{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return Qc(n)&&Xr(n.arrayValue,this.value)}},Ru=class extends Ie{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Xr(this.value.arrayValue,n)}},Cu=class extends Ie{constructor(e,n){super(e,"not-in",n)}matches(e){if(Xr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Xr(this.value.arrayValue,n)}},Su=class extends Ie{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!Qc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Xr(this.value.arrayValue,r))}};var wu=class{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ue=null}};function qd(t,e=null,n=[],r=[],s=null,i=null,o=null){return new wu(t,e,n,r,s,i,o)}function Wc(t){let e=X(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Tu(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),na(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$n(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$n(r)).join(",")),e.ue=n}return e.ue}function Yc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!WE(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Af(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Hd(t.startAt,e.startAt)&&Hd(t.endAt,e.endAt)}function Nu(t){return Q.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}var pt=class{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,h=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function $E(t,e,n,r,s,i,o,c){return new pt(t,e,n,r,s,i,o,c)}function ia(t){return new pt(t)}function Gd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function $c(t){return t.collectionGroup!==null}function Gn(t){let e=X(t);if(e.ce===null){e.ce=[];let n=new Set;for(let i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new we($e.comparator);return o.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(c=c.add(f.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new _n(i,r))}),n.has($e.keyField().canonicalString())||e.ce.push(new _n($e.keyField(),r))}return e.ce}function dt(t){let e=X(t);return e.le||(e.le=If(e,Gn(t))),e.le}function XE(t){let e=X(t);return e.he||(e.he=If(e,t.explicitOrderBy)),e.he}function If(t,e){if(t.limitType==="F")return qd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{let i=s.dir==="desc"?"asc":"desc";return new _n(s.field,i)});let n=t.endAt?new Zt(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Zt(t.startAt.position,t.startAt.inclusive):null;return qd(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function vu(t,e){let n=t.filters.concat([e]);return new pt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ni(t,e,n){return new pt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function aa(t,e){return Yc(dt(t),dt(e))&&t.limitType===e.limitType}function Rf(t){return`${Wc(dt(t))}|lt:${t.limitType}`}function Vn(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>bf(s)).join(", ")}]`),na(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>$n(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>$n(s)).join(",")),`Target(${r})`}(dt(t))}; limitType=${t.limitType})`}function oa(t,e){return e.isFoundDocument()&&function(r,s){let i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Q.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(let i of Gn(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(let i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,h){let f=Vd(o,c,h);return o.inclusive?f<=0:f<0}(r.startAt,Gn(r),s)||r.endAt&&!function(o,c,h){let f=Vd(o,c,h);return o.inclusive?f>=0:f>0}(r.endAt,Gn(r),s))}(t,e)}function JE(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Cf(t){return(e,n)=>{let r=!1;for(let s of Gn(t)){let i=ZE(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function ZE(t,e,n){let r=t.field.isKeyField()?Q.comparator(e.key,n.key):function(i,o,c){let h=o.data.field(i),f=c.data.field(i);return h!==null&&f!==null?Yn(h,f):Y()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Y()}}var xt=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){nn(this.inner,(n,r)=>{for(let[s,i]of r)e(s,i)})}isEmpty(){return mf(this.inner)}size(){return this.innerSize}};var e_=new Te(Q.comparator);function Lt(){return e_}var Sf=new Te(Q.comparator);function zr(...t){let e=Sf;for(let n of t)e=e.insert(n.key,n);return e}function wf(t){let e=Sf;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function mn(){return Qr()}function Nf(){return Qr()}function Qr(){return new xt(t=>t.toString(),(t,e)=>t.isEqual(e))}var t_=new Te(Q.comparator),n_=new we(Q.comparator);function te(...t){let e=n_;for(let n of t)e=e.add(n);return e}var r_=new we(se);function s_(){return r_}function Xc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yr(e)?"-0":e}}function vf(t){return{integerValue:""+t}}function Df(t,e){return UE(e)?vf(e):Xc(t,e)}var Xn=class{constructor(){this._=void 0}};function i_(t,e,n){return t instanceof Jn?function(s,i){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&ra(i)&&(i=sa(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Tn?Of(t,e):t instanceof An?xf(t,e):function(s,i){let o=Pf(s,i),c=Kd(o)+Kd(s.Pe);return _u(o)&&_u(s.Pe)?vf(c):Xc(s.serializer,c)}(t,e)}function a_(t,e,n){return t instanceof Tn?Of(t,e):t instanceof An?xf(t,e):n}function Pf(t,e){return t instanceof bn?function(r){return _u(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}var Jn=class extends Xn{},Tn=class extends Xn{constructor(e){super(),this.elements=e}};function Of(t,e){let n=Lf(e);for(let r of t.elements)n.some(s=>mt(s,r))||n.push(r);return{arrayValue:{values:n}}}var An=class extends Xn{constructor(e){super(),this.elements=e}};function xf(t,e){let n=Lf(e);for(let r of t.elements)n=n.filter(s=>!mt(s,r));return{arrayValue:{values:n}}}var bn=class extends Xn{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function Kd(t){return me(t.integerValue||t.doubleValue)}function Lf(t){return Qc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Du=class{constructor(e,n){this.field=e,this.transform=n}};function o_(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Tn&&s instanceof Tn||r instanceof An&&s instanceof An?Qn(r.elements,s.elements,mt):r instanceof bn&&s instanceof bn?mt(r.Pe,s.Pe):r instanceof Jn&&s instanceof Jn}(t.transform,e.transform)}var Pu=class{constructor(e,n){this.version=e,this.transformResults=n}},vt=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ti(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Zn=class{};function kf(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Jr(t.key,vt.none()):new yn(t.key,t.data,vt.none());{let n=t.data,r=Ye.empty(),s=new we($e.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new gt(t.key,r,new nt(s.toArray()),vt.none())}}function u_(t,e,n){t instanceof yn?function(s,i,o){let c=s.value.clone(),h=jd(s.fieldTransforms,i,o.transformResults);c.setAll(h),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof gt?function(s,i,o){if(!Ti(s.precondition,i))return void i.convertToUnknownDocument(o.version);let c=jd(s.fieldTransforms,i,o.transformResults),h=i.data;h.setAll(Mf(s)),h.setAll(c),i.convertToFoundDocument(o.version,h).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Wr(t,e,n,r){return t instanceof yn?function(i,o,c,h){if(!Ti(i.precondition,o))return c;let f=i.value.clone(),m=Qd(i.fieldTransforms,h,o);return f.setAll(m),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),null}(t,e,n,r):t instanceof gt?function(i,o,c,h){if(!Ti(i.precondition,o))return c;let f=Qd(i.fieldTransforms,h,o),m=o.data;return m.setAll(Mf(i)),m.setAll(f),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(_=>_.field))}(t,e,n,r):function(i,o,c){return Ti(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function c_(t,e){let n=null;for(let r of t.fieldTransforms){let s=e.data.field(r.field),i=Pf(r.transform,s||null);i!=null&&(n===null&&(n=Ye.empty()),n.set(r.field,i))}return n||null}function zd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Qn(r,s,(i,o)=>o_(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var yn=class extends Zn{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}},gt=class extends Zn{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}};function Mf(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function jd(t,e,n){let r=new Map;ue(t.length===n.length);for(let s=0;s<n.length;s++){let i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,a_(o,c,n[s]))}return r}function Qd(t,e,n){let r=new Map;for(let s of t){let i=s.transform,o=n.data.field(s.field);r.set(s.field,i_(i,o,e))}return r}var Jr=class extends Zn{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ou=class extends Zn{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var xu=class{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){let i=this.mutations[s];i.key.isEqual(e.key)&&u_(i,e,r[s])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Wr(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Wr(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=Nf();return this.mutations.forEach(s=>{let i=e.get(s.key),o=i.overlayedDocument,c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;let h=kf(o,c);h!==null&&r.set(s.key,h),o.isValidDocument()||o.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),te())}isEqual(e){return this.batchId===e.batchId&&Qn(this.mutations,e.mutations,(n,r)=>zd(n,r))&&Qn(this.baseMutations,e.baseMutations,(n,r)=>zd(n,r))}},Lu=class t{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ue(e.mutations.length===r.length);let s=function(){return t_}(),i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new t(e,n,r,s)}};var ku=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Mu=class{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}};var Bu=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var be,ie;function l_(t){switch(t){default:return Y();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function Bf(t){if(t===void 0)return Dt("GRPC error has no .code"),F.UNKNOWN;switch(t){case be.OK:return F.OK;case be.CANCELLED:return F.CANCELLED;case be.UNKNOWN:return F.UNKNOWN;case be.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case be.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case be.INTERNAL:return F.INTERNAL;case be.UNAVAILABLE:return F.UNAVAILABLE;case be.UNAUTHENTICATED:return F.UNAUTHENTICATED;case be.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case be.NOT_FOUND:return F.NOT_FOUND;case be.ALREADY_EXISTS:return F.ALREADY_EXISTS;case be.PERMISSION_DENIED:return F.PERMISSION_DENIED;case be.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case be.ABORTED:return F.ABORTED;case be.OUT_OF_RANGE:return F.OUT_OF_RANGE;case be.UNIMPLEMENTED:return F.UNIMPLEMENTED;case be.DATA_LOSS:return F.DATA_LOSS;default:return Y()}}(ie=be||(be={}))[ie.OK=0]="OK",ie[ie.CANCELLED=1]="CANCELLED",ie[ie.UNKNOWN=2]="UNKNOWN",ie[ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ie[ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ie[ie.NOT_FOUND=5]="NOT_FOUND",ie[ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",ie[ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",ie[ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",ie[ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ie[ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ie[ie.ABORTED=10]="ABORTED",ie[ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",ie[ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",ie[ie.INTERNAL=13]="INTERNAL",ie[ie.UNAVAILABLE=14]="UNAVAILABLE",ie[ie.DATA_LOSS=15]="DATA_LOSS";var Wd=null;function h_(){return new TextEncoder}var d_=new Wt([4294967295,4294967295],0);function Yd(t){let e=h_().encode(t),n=new Xo;return n.update(e),new Uint8Array(n.digest())}function $d(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Wt([n,r],0),new Wt([s,i],0)]}var Fu=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new pn(`Invalid padding: ${n}`);if(r<0)throw new pn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new pn(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new pn(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ie=Wt.fromNumber(this.Te)}Ee(e,n,r){let s=e.add(n.multiply(Wt.fromNumber(r)));return s.compare(d_)===1&&(s=new Wt([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=Yd(e),[r,s]=$d(n);for(let i=0;i<this.hashCount;i++){let o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){let s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new t(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.Te===0)return;let n=Yd(e),[r,s]=$d(n);for(let i=0;i<this.hashCount;i++){let o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},pn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var vi=class t{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let s=new Map;return s.set(e,Zr.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(J.min(),s,new Te(se),Lt(),te())}},Zr=class t{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,te(),te(),te())}};var Kn=class{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}},Di=class{constructor(e,n){this.targetId=e,this.me=n}},Pi=class{constructor(e,n,r=Me.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}},Oi=class{constructor(){this.fe=0,this.ge=Xd(),this.pe=Me.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=te(),n=te(),r=te();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Y()}}),new Zr(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Xd()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ue(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Uu=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Lt(),this.qe=pi(),this.Qe=pi(),this.Ke=new Te(se)}$e(e){for(let n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(n,e.Ve):this.We(n,e.key,e.Ve);for(let n of e.removedTargetIds)this.We(n,e.key,e.Ve)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.je(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.De(e.resumeToken));break;default:Y()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.je(s)&&n(s)})}Je(e){let n=e.targetId,r=e.me.count,s=this.Ye(n);if(s){let i=s.target;if(Nu(i))if(r===0){let o=new Q(i.path);this.We(n,o,at.newNoDocument(o,J.min()))}else ue(r===1);else{let o=this.Ze(n);if(o!==r){let c=this.Xe(e),h=c?this.et(c,e,o):1;if(h!==0){this.He(n);let f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,f)}Wd?.tt(function(m,_,I,v,x){var U,k,z,$,W,Z;let Re={localCacheCount:m,existenceFilterCount:_.count,databaseId:I.database,projectId:I.projectId},ae=_.unchangedNames;return ae&&(Re.bloomFilter={applied:x===0,hashCount:(U=ae?.hashCount)!==null&&U!==void 0?U:0,bitmapLength:($=(z=(k=ae?.bits)===null||k===void 0?void 0:k.bitmap)===null||z===void 0?void 0:z.length)!==null&&$!==void 0?$:0,padding:(Z=(W=ae?.bits)===null||W===void 0?void 0:W.padding)!==null&&Z!==void 0?Z:0,mightContain:C=>{var T;return(T=v?.mightContain(C))!==null&&T!==void 0&&T}}),Re}(o,e.me,this.Le.nt(),c,h))}}}}Xe(e){let n=e.me.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n,o,c;try{o=Ot(r).toUint8Array()}catch(h){if(h instanceof Ri)return jn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new Fu(o,s,i)}catch(h){return jn(h instanceof pn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.Te===0?null:c}et(e,n,r){return n.me.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),s=0;return r.forEach(i=>{let o=this.Le.nt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.We(n,i,null),s++)}),s}it(e){let n=new Map;this.Be.forEach((i,o)=>{let c=this.Ye(o);if(c){if(i.current&&Nu(c.target)){let h=new Q(c.target.path);this.st(h).has(o)||this.ot(o,h)||this.We(o,h,at.newNoDocument(h,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=te();this.Qe.forEach((i,o)=>{let c=!0;o.forEachWhile(h=>{let f=this.Ye(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));let s=new vi(e,n,this.Ke,this.ke,r);return this.ke=Lt(),this.qe=pi(),this.Qe=pi(),this.Ke=new Te(se),s}Ue(e,n){if(!this.je(e))return;let r=this.ot(e,n.key)?2:0;this.ze(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e)),this.Qe=this.Qe.insert(n.key,this._t(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let s=this.ze(e);this.ot(e,n)?s.Fe(n,1):s.Me(n),this.Qe=this.Qe.insert(n,this._t(n).delete(e)),this.Qe=this.Qe.insert(n,this._t(n).add(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let n=this.Be.get(e);return n||(n=new Oi,this.Be.set(e,n)),n}_t(e){let n=this.Qe.get(e);return n||(n=new we(se),this.Qe=this.Qe.insert(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new we(se),this.qe=this.qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.Be.get(e);return n&&n.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new Oi),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}ot(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function pi(){return new Te(Q.comparator)}function Xd(){return new Te(Q.comparator)}var f_={asc:"ASCENDING",desc:"DESCENDING"},m_={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},p_={and:"AND",or:"OR"},Vu=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function Hu(t,e){return t.useProto3Json||na(e)?e:{value:e}}function xi(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ff(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function g_(t,e){return xi(t,e.toTimestamp())}function ft(t){return ue(!!t),J.fromTimestamp(function(n){let r=Pt(n);return new Ae(r.seconds,r.nanos)}(t))}function Jc(t,e){return qu(t,e).canonicalString()}function qu(t,e){let n=function(s){return new pe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Uf(t){let e=pe.fromString(t);return ue(zf(e)),e}function Gu(t,e){return Jc(t.databaseId,e.path)}function ru(t,e){let n=Uf(e);if(n.get(1)!==t.databaseId.projectId)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Q(Hf(n))}function Vf(t,e){return Jc(t.databaseId,e)}function E_(t){let e=Uf(t);return e.length===4?pe.emptyPath():Hf(e)}function Ku(t){return new pe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Hf(t){return ue(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Jd(t,e,n){return{name:Gu(t,e),fields:n.value.mapValue.fields}}function __(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Y()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(f,m){return f.useProto3Json?(ue(m===void 0||typeof m=="string"),Me.fromBase64String(m||"")):(ue(m===void 0||m instanceof Buffer||m instanceof Uint8Array),Me.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(f){let m=f.code===void 0?F.UNKNOWN:Bf(f.code);return new G(m,f.message||"")}(o);n=new Pi(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let s=ru(t,r.document.name),i=ft(r.document.updateTime),o=r.document.createTime?ft(r.document.createTime):J.min(),c=new Ye({mapValue:{fields:r.document.fields}}),h=at.newFoundDocument(s,i,o,c),f=r.targetIds||[],m=r.removedTargetIds||[];n=new Kn(f,m,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let s=ru(t,r.document),i=r.readTime?ft(r.readTime):J.min(),o=at.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Kn([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let s=ru(t,r.document),i=r.removedTargetIds||[];n=new Kn([],i,s,null)}else{if(!("filter"in e))return Y();{e.filter;let r=e.filter;r.targetId;let{count:s=0,unchangedNames:i}=r,o=new Bu(s,i),c=r.targetId;n=new Di(c,o)}}return n}function T_(t,e){let n;if(e instanceof yn)n={update:Jd(t,e.key,e.value)};else if(e instanceof Jr)n={delete:Gu(t,e.key)};else if(e instanceof gt)n={update:Jd(t,e.key,e.data),updateMask:N_(e.fieldMask)};else{if(!(e instanceof Ou))return Y();n={verify:Gu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){let c=o.transform;if(c instanceof Jn)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Tn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof An)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof bn)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw Y()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:g_(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Y()}(t,e.precondition)),n}function A_(t,e){return t&&t.length>0?(ue(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?ft(s.updateTime):ft(i);return o.isEqual(J.min())&&(o=ft(i)),new Pu(o,s.transformResults||[])}(n,e))):[]}function b_(t,e){return{documents:[Vf(t,e.path)]}}function qf(t,e){let n={structuredQuery:{}},r=e.path,s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Vf(t,s);let i=function(f){if(f.length!==0)return Kf(ot.create(f,"and"))}(e.filters);i&&(n.structuredQuery.where=i);let o=function(f){if(f.length!==0)return f.map(m=>function(I){return{field:Yt(I.field),direction:C_(I.dir)}}(m))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let c=Hu(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{ct:n,parent:s}}function y_(t,e,n,r){let{ct:s,parent:i}=qf(t,e),o={},c=[],h=0;return n.forEach(f=>{let m=r?f.alias:"aggregate_"+h++;o[m]=f.alias,f.aggregateType==="count"?c.push({alias:m,count:{}}):f.aggregateType==="avg"?c.push({alias:m,avg:{field:Yt(f.fieldPath)}}):f.aggregateType==="sum"&&c.push({alias:m,sum:{field:Yt(f.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:c,structuredQuery:s.structuredQuery},parent:s.parent},lt:o,parent:i}}function I_(t){let e=E_(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,s=null;if(r>0){ue(r===1);let m=n.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let i=[];n.where&&(i=function(_){let I=Gf(_);return I instanceof ot&&Tf(I)?I.getFilters():[I]}(n.where));let o=[];n.orderBy&&(o=function(_){return _.map(I=>function(x){return new _n(Hn(x.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(I))}(n.orderBy));let c=null;n.limit&&(c=function(_){let I;return I=typeof _=="object"?_.value:_,na(I)?null:I}(n.limit));let h=null;n.startAt&&(h=function(_){let I=!!_.before,v=_.values||[];return new Zt(v,I)}(n.startAt));let f=null;return n.endAt&&(f=function(_){let I=!_.before,v=_.values||[];return new Zt(v,I)}(n.endAt)),$E(e,s,o,i,c,"F",h,f)}function R_(t,e){let n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Gf(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Hn(n.unaryFilter.field);return Ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":let s=Hn(n.unaryFilter.field);return Ie.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let i=Hn(n.unaryFilter.field);return Ie.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Hn(n.unaryFilter.field);return Ie.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}(t):t.fieldFilter!==void 0?function(n){return Ie.create(Hn(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ot.create(n.compositeFilter.filters.map(r=>Gf(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Y()}}(n.compositeFilter.op))}(t):Y()}function C_(t){return f_[t]}function S_(t){return m_[t]}function w_(t){return p_[t]}function Yt(t){return{fieldPath:t.canonicalString()}}function Hn(t){return $e.fromServerFormat(t.fieldPath)}function Kf(t){return t instanceof Ie?function(n){if(n.op==="=="){if(Ud(n.value))return{unaryFilter:{field:Yt(n.field),op:"IS_NAN"}};if(Fd(n.value))return{unaryFilter:{field:Yt(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ud(n.value))return{unaryFilter:{field:Yt(n.field),op:"IS_NOT_NAN"}};if(Fd(n.value))return{unaryFilter:{field:Yt(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yt(n.field),op:S_(n.op),value:n.value}}}(t):t instanceof ot?function(n){let r=n.getFilters().map(s=>Kf(s));return r.length===1?r[0]:{compositeFilter:{op:w_(n.op),filters:r}}}(t):Y()}function N_(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function zf(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var es=class t{constructor(e,n,r,s,i=J.min(),o=J.min(),c=Me.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var zu=class{constructor(e){this.ht=e}};function v_(t){let e=I_({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ni(e,e.limit,"L"):e}var Li=class{constructor(){}Et(e,n){this.dt(e,n),n.At()}dt(e,n){if("nullValue"in e)this.Rt(n,5);else if("booleanValue"in e)this.Rt(n,10),n.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(n,15),n.Vt(me(e.integerValue));else if("doubleValue"in e){let r=me(e.doubleValue);isNaN(r)?this.Rt(n,13):(this.Rt(n,15),Yr(r)?n.Vt(0):n.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(n,20),typeof r=="string"&&(r=Pt(r)),n.ft(`${r.seconds||""}`),n.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,n),this.yt(n);else if("bytesValue"in e)this.Rt(n,30),n.wt(Ot(e.bytesValue)),this.yt(n);else if("referenceValue"in e)this.St(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Rt(n,45),n.Vt(r.latitude||0),n.Vt(r.longitude||0)}else"mapValue"in e?gf(e)?this.Rt(n,Number.MAX_SAFE_INTEGER):pf(e)?this.bt(e.mapValue,n):(this.Dt(e.mapValue,n),this.yt(n)):"arrayValue"in e?(this.vt(e.arrayValue,n),this.yt(n)):Y()}gt(e,n){this.Rt(n,25),this.Ct(e,n)}Ct(e,n){n.ft(e)}Dt(e,n){let r=e.fields||{};this.Rt(n,55);for(let s of Object.keys(r))this.gt(s,n),this.dt(r[s],n)}bt(e,n){var r,s;let i=e.fields||{};this.Rt(n,53);let o="value",c=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Rt(n,15),n.Vt(me(c)),this.gt(o,n),this.dt(i[o],n)}vt(e,n){let r=e.values||[];this.Rt(n,50);for(let s of r)this.dt(s,n)}St(e,n){this.Rt(n,37),Q.fromName(e).path.forEach(r=>{this.Rt(n,60),this.Ct(r,n)})}Rt(e,n){e.Vt(n)}yt(e){e.Vt(2)}};Li.Ft=new Li;var ju=class{constructor(){this.ln=new Qu}addToCollectionParentIndex(e,n){return this.ln.add(n),V.resolve()}getCollectionParents(e,n){return V.resolve(this.ln.getEntries(n))}addFieldIndex(e,n){return V.resolve()}deleteFieldIndex(e,n){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,n){return V.resolve()}getDocumentsMatchingTarget(e,n){return V.resolve(null)}getIndexType(e,n){return V.resolve(0)}getFieldIndexes(e,n){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,n){return V.resolve(En.min())}getMinOffsetFromCollectionGroup(e,n){return V.resolve(En.min())}updateCollectionGroup(e,n,r){return V.resolve()}updateIndexEntries(e,n){return V.resolve()}},Qu=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new we(pe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){let n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new we(pe.comparator)).toArray()}};var RI=new Uint8Array(0);var Zd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tt=class t{static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}};tt.DEFAULT_COLLECTION_PERCENTILE=10,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tt.DEFAULT=new tt(41943040,tt.DEFAULT_COLLECTION_PERCENTILE,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tt.DISABLED=new tt(-1,0,0);var ts=class t{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new t(0)}static Qn(){return new t(-1)}};function ef([t,e],[n,r]){let s=se(t,n);return s===0?se(e,r):s}var Wu=class{constructor(e){this.Gn=e,this.buffer=new we(ef),this.zn=0}jn(){return++this.zn}Hn(e){let n=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();ef(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},Yu=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){K("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){or(n)?K("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ar(n)}await this.Yn(3e5)})}},$u=class{constructor(e,n){this.Zn=e,this.params=n}calculateTargetCount(e,n){return this.Zn.Xn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return V.resolve(Wn.oe);let r=new Wu(n);return this.Zn.forEachTarget(e,s=>r.Hn(s.sequenceNumber)).next(()=>this.Zn.er(e,s=>r.Hn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(Zd)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Zd):this.tr(e,n))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,n){let r,s,i,o,c,h,f,m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),s=this.params.maximumSequenceNumbersToCollect):s=_,o=Date.now(),this.nthSequenceNumber(e,s))).next(_=>(r=_,c=Date.now(),this.removeTargets(e,r,n))).next(_=>(i=_,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(_=>(f=Date.now(),Un()<=re.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(h-c)+`ms
	Removed ${_} documents in `+(f-h)+`ms
Total Duration: ${f-m}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:_})))}};function D_(t,e){return new $u(t,e)}var Xu=class{constructor(){this.changes=new xt(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,at.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?V.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ju=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Zu=class{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Wr(r.mutation,s,nt.empty(),Ae.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=te()){let s=mn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=zr();return i.forEach((c,h)=>{o=o.insert(c,h.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=mn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,te()))}populateOverlays(e,n,r){let s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=Lt(),o=Qr(),c=function(){return Qr()}();return n.forEach((h,f)=>{let m=r.get(f.key);s.has(f.key)&&(m===void 0||m.mutation instanceof gt)?i=i.insert(f.key,f):m!==void 0?(o.set(f.key,m.mutation.getFieldMask()),Wr(m.mutation,f,m.mutation.getFieldMask(),Ae.now())):o.set(f.key,nt.empty())}),this.recalculateAndSaveOverlays(e,i).next(h=>(h.forEach((f,m)=>o.set(f,m)),n.forEach((f,m)=>{var _;return c.set(f,new Ju(m,(_=o.get(f))!==null&&_!==void 0?_:null))}),c))}recalculateAndSaveOverlays(e,n){let r=Qr(),s=new Te((o,c)=>o-c),i=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let c of o)c.keys().forEach(h=>{let f=n.get(h);if(f===null)return;let m=r.get(h)||nt.empty();m=c.applyToLocalView(f,m),r.set(h,m);let _=(s.get(c.batchId)||te()).add(h);s=s.insert(c.batchId,_)})}).next(()=>{let o=[],c=s.getReverseIterator();for(;c.hasNext();){let h=c.getNext(),f=h.key,m=h.value,_=Nf();m.forEach(I=>{if(!i.has(I)){let v=kf(n.get(I),r.get(I));v!==null&&_.set(I,v),i=i.add(I)}}),o.push(this.documentOverlayCache.saveOverlays(e,f,_))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):$c(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{let o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):V.resolve(mn()),c=-1,h=i;return o.next(f=>V.forEach(f,(m,_)=>(c<_.largestBatchId&&(c=_.largestBatchId),i.get(m)?V.resolve():this.remoteDocumentCache.getEntry(e,m).next(I=>{h=h.insert(m,I)}))).next(()=>this.populateOverlays(e,f,i)).next(()=>this.computeViews(e,h,f,te())).next(m=>({batchId:c,changes:wf(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Q(n)).next(r=>{let s=zr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){let i=n.collectionGroup,o=zr();return this.indexManager.getCollectionParents(e,i).next(c=>V.forEach(c,h=>{let f=function(_,I){return new pt(I,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(n,h.child(i));return this.getDocumentsMatchingCollectionQuery(e,f,r,s).next(m=>{m.forEach((_,I)=>{o=o.insert(_,I)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((h,f)=>{let m=f.getKey();o.get(m)===null&&(o=o.insert(m,at.newInvalidDocument(m)))});let c=zr();return o.forEach((h,f)=>{let m=i.get(h);m!==void 0&&Wr(m.mutation,f,nt.empty(),Ae.now()),oa(n,f)&&(c=c.insert(h,f))}),c})}};var ec=class{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,n){return V.resolve(this.Tr.get(n))}saveBundleMetadata(e,n){return this.Tr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ft(s.createTime)}}(n)),V.resolve()}getNamedQuery(e,n){return V.resolve(this.Ir.get(n))}saveNamedQuery(e,n){return this.Ir.set(n.name,function(s){return{name:s.name,query:v_(s.bundledQuery),readTime:ft(s.readTime)}}(n)),V.resolve()}};var tc=class{constructor(){this.overlays=new Te(Q.comparator),this.Er=new Map}getOverlay(e,n){return V.resolve(this.overlays.get(n))}getOverlays(e,n){let r=mn();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.Tt(e,n,i)}),V.resolve()}removeOverlaysForBatchId(e,n,r){let s=this.Er.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Er.delete(r)),V.resolve()}getOverlaysForCollection(e,n,r){let s=mn(),i=n.length+1,o=new Q(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let h=c.getNext().value,f=h.getKey();if(!n.isPrefixOf(f.path))break;f.path.length===i&&h.largestBatchId>r&&s.set(h.getKey(),h)}return V.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Te((f,m)=>f-m),o=this.overlays.getIterator();for(;o.hasNext();){let f=o.getNext().value;if(f.getKey().getCollectionGroup()===n&&f.largestBatchId>r){let m=i.get(f.largestBatchId);m===null&&(m=mn(),i=i.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}let c=mn(),h=i.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,m)=>c.set(f,m)),!(c.size()>=s)););return V.resolve(c)}Tt(e,n,r){let s=this.overlays.get(r.key);if(s!==null){let o=this.Er.get(s.largestBatchId).delete(r.key);this.Er.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ku(n,r));let i=this.Er.get(n);i===void 0&&(i=te(),this.Er.set(n,i)),this.Er.set(n,i.add(r.key))}};var nc=class{constructor(){this.sessionToken=Me.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,V.resolve()}};var ns=class{constructor(){this.dr=new we(ye.Ar),this.Rr=new we(ye.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,n){let r=new ye(e,n);this.dr=this.dr.add(r),this.Rr=this.Rr.add(r)}mr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.gr(new ye(e,n))}pr(e,n){e.forEach(r=>this.removeReference(r,n))}yr(e){let n=new Q(new pe([])),r=new ye(n,e),s=new ye(n,e+1),i=[];return this.Rr.forEachInRange([r,s],o=>{this.gr(o),i.push(o.key)}),i}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){let n=new Q(new pe([])),r=new ye(n,e),s=new ye(n,e+1),i=te();return this.Rr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){let n=new ye(e,0),r=this.dr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},ye=class{constructor(e,n){this.key=e,this.br=n}static Ar(e,n){return Q.comparator(e.key,n.key)||se(e.br,n.br)}static Vr(e,n){return se(e.br,n.br)||Q.comparator(e.key,n.key)}};var rc=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Dr=1,this.vr=new we(ye.Ar)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){let i=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new xu(i,n,r,s);this.mutationQueue.push(o);for(let c of s)this.vr=this.vr.add(new ye(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,n){return V.resolve(this.Cr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,s=this.Fr(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new ye(n,0),s=new ye(n,Number.POSITIVE_INFINITY),i=[];return this.vr.forEachInRange([r,s],o=>{let c=this.Cr(o.br);i.push(c)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new we(se);return n.forEach(s=>{let i=new ye(s,0),o=new ye(s,Number.POSITIVE_INFINITY);this.vr.forEachInRange([i,o],c=>{r=r.add(c.br)})}),V.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,s=r.length+1,i=r;Q.isDocumentKey(i)||(i=i.child(""));let o=new ye(new Q(i),0),c=new we(se);return this.vr.forEachWhile(h=>{let f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===s&&(c=c.add(h.br)),!0)},o),V.resolve(this.Mr(c))}Mr(e){let n=[];return e.forEach(r=>{let s=this.Cr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ue(this.Or(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return V.forEach(n.mutations,s=>{let i=new ye(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.vr=r})}Ln(e){}containsKey(e,n){let r=new ye(n,0),s=this.vr.firstAfterOrEqual(r);return V.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Or(e,n){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){let n=this.Fr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var sc=class{constructor(e){this.Nr=e,this.docs=function(){return new Te(Q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Nr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return V.resolve(r?r.document.mutableCopy():at.newInvalidDocument(n))}getEntries(e,n){let r=Lt();return n.forEach(s=>{let i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():at.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Lt(),o=n.path,c=new Q(o.child("")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){let{key:f,value:{document:m}}=h.getNext();if(!o.isPrefixOf(f.path))break;f.path.length>o.length+1||ME(kE(m),r)<=0||(s.has(m.key)||oa(n,m))&&(i=i.insert(m.key,m.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Y()}Lr(e,n){return V.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new ic(this)}getSize(e){return V.resolve(this.size)}},ic=class extends Xu{constructor(e){super(),this.hr=e}applyChanges(e){let n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.hr.addEntry(e,s)):this.hr.removeEntry(r)}),V.waitFor(n)}getFromCache(e,n){return this.hr.getEntry(e,n)}getAllFromCache(e,n){return this.hr.getEntries(e,n)}};var ac=class{constructor(e){this.persistence=e,this.Br=new xt(n=>Wc(n),Yc),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.kr=0,this.qr=new ns,this.targetCount=0,this.Qr=ts.qn()}forEachTarget(e,n){return this.Br.forEach((r,s)=>n(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.kr&&(this.kr=n),V.resolve()}Un(e){this.Br.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Qr=new ts(n),this.highestTargetId=n),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,n){return this.Un(n),this.targetCount+=1,V.resolve()}updateTargetData(e,n){return this.Un(n),V.resolve()}removeTargetData(e,n){return this.Br.delete(n.target),this.qr.yr(n.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,n,r){let s=0,i=[];return this.Br.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Br.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,n){let r=this.Br.get(n)||null;return V.resolve(r)}addMatchingKeys(e,n,r){return this.qr.mr(n,r),V.resolve()}removeMatchingKeys(e,n,r){this.qr.pr(n,r);let s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.qr.yr(n),V.resolve()}getMatchingKeysForTargetId(e,n){let r=this.qr.Sr(n);return V.resolve(r)}containsKey(e,n){return V.resolve(this.qr.containsKey(n))}};var ki=class{constructor(e,n){this.Kr={},this.overlays={},this.$r=new Wn(0),this.Ur=!1,this.Ur=!0,this.Wr=new nc,this.referenceDelegate=e(this),this.Gr=new ac(this),this.indexManager=new ju,this.remoteDocumentCache=function(s){return new sc(s)}(r=>this.referenceDelegate.zr(r)),this.serializer=new zu(n),this.jr=new ec(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new tc,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Kr[e.toKey()];return r||(r=new rc(n,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);let s=new oc(this.$r.next());return this.referenceDelegate.Hr(),r(s).next(i=>this.referenceDelegate.Jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Yr(e,n){return V.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,n)))}},oc=class extends pu{constructor(e){super(),this.currentSequenceNumber=e}},uc=class t{constructor(e){this.persistence=e,this.Zr=new ns,this.Xr=null}static ei(e){return new t(e)}get ti(){if(this.Xr)return this.Xr;throw Y()}addReference(e,n,r){return this.Zr.addReference(r,n),this.ti.delete(r.toString()),V.resolve()}removeReference(e,n,r){return this.Zr.removeReference(r,n),this.ti.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,n){return this.ti.add(n.toString()),V.resolve()}removeTarget(e,n){this.Zr.yr(n.targetId).forEach(s=>this.ti.add(s.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.ti.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Hr(){this.Xr=new Set}Jr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.ti,r=>{let s=Q.fromPath(r);return this.ni(e,s).next(i=>{i||n.removeEntry(s,J.min())})}).next(()=>(this.Xr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ni(e,n).next(r=>{r?this.ti.delete(n.toString()):this.ti.add(n.toString())})}zr(e){return 0}ni(e,n){return V.or([()=>V.resolve(this.Zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Yr(e,n)])}},Mi=class t{constructor(e,n){this.persistence=e,this.ri=new xt(r=>VE(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=D_(this,n)}static ei(e,n){return new t(e,n)}Hr(){}Jr(e){return V.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Xn(e){let n=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}nr(e){let n=0;return this.er(e,r=>{n++}).next(()=>n)}er(e,n){return V.forEach(this.ri,(r,s)=>this.ir(e,r,s).next(i=>i?V.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0,s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Lr(e,o=>this.ir(e,o,n).next(c=>{c||(r++,i.removeEntry(o,J.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ri.set(n,e.currentSequenceNumber),V.resolve()}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),V.resolve()}removeReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,n){return this.ri.set(n,e.currentSequenceNumber),V.resolve()}zr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ei(e.data.value)),n}ir(e,n,r){return V.or([()=>this.persistence.Yr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{let s=this.ri.get(n);return V.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var cc=class t{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Wi=r,this.Gi=s}static zi(e,n){let r=te(),s=te();for(let i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new t(e,n.fromCache,r,s)}};var lc=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var hc=class{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return pd()?8:FE(ko())>0?6:4}()}initialize(e,n){this.Zi=e,this.indexManager=n,this.ji=!0}getDocumentsMatchingQuery(e,n,r,s){let i={result:null};return this.Xi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.es(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;let o=new lc;return this.ts(e,n,o).next(c=>{if(i.result=c,this.Hi)return this.ns(e,n,o,c.size)})}).next(()=>i.result)}ns(e,n,r,s){return r.documentReadCount<this.Ji?(Un()<=re.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Vn(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),V.resolve()):(Un()<=re.DEBUG&&K("QueryEngine","Query:",Vn(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Yi*s?(Un()<=re.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Vn(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dt(n))):V.resolve())}Xi(e,n){if(Gd(n))return V.resolve(null);let r=dt(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Ni(n,null,"F"),r=dt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{let o=te(...i);return this.Zi.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(h=>{let f=this.rs(n,c);return this.ss(n,f,o,h.readTime)?this.Xi(e,Ni(n,null,"F")):this.os(e,f,n,h)}))})))}es(e,n,r,s){return Gd(n)||s.isEqual(J.min())?V.resolve(null):this.Zi.getDocuments(e,r).next(i=>{let o=this.rs(n,i);return this.ss(n,o,r,s)?V.resolve(null):(Un()<=re.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Vn(n)),this.os(e,o,n,LE(s,-1)).next(c=>c))})}rs(e,n){let r=new we(Cf(e));return n.forEach((s,i)=>{oa(e,i)&&(r=r.add(i))}),r}ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ts(e,n,r){return Un()<=re.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Vn(n)),this.Zi.getDocumentsMatchingQuery(e,n,En.min(),r)}os(e,n,r,s){return this.Zi.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}};var dc=class{constructor(e,n,r,s){this.persistence=e,this._s=n,this.serializer=s,this.us=new Te(se),this.cs=new xt(i=>Wc(i),Yc),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Zu(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.us))}};function P_(t,e,n,r){return new dc(t,e,n,r)}async function jf(t,e){let n=X(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ps(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{let o=[],c=[],h=te();for(let f of s){o.push(f.batchId);for(let m of f.mutations)h=h.add(m.key)}for(let f of i){c.push(f.batchId);for(let m of f.mutations)h=h.add(m.key)}return n.localDocuments.getDocuments(r,h).next(f=>({Ts:f,removedBatchIds:o,addedBatchIds:c}))})})}function O_(t,e){let n=X(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let s=e.batch.keys(),i=n.hs.newChangeBuffer({trackRemovals:!0});return function(c,h,f,m){let _=f.batch,I=_.keys(),v=V.resolve();return I.forEach(x=>{v=v.next(()=>m.getEntry(h,x)).next(U=>{let k=f.docVersions.get(x);ue(k!==null),U.version.compareTo(k)<0&&(_.applyToRemoteDocument(U,f),U.isValidDocument()&&(U.setReadTime(f.commitVersion),m.addEntry(U)))})}),v.next(()=>c.mutationQueue.removeMutationBatch(h,_))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let h=te();for(let f=0;f<c.mutationResults.length;++f)c.mutationResults[f].transformResults.length>0&&(h=h.add(c.batch.mutations[f].key));return h}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Qf(t){let e=X(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Gr.getLastRemoteSnapshotVersion(n))}function x_(t,e){let n=X(t),r=e.snapshotVersion,s=n.us;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{let o=n.hs.newChangeBuffer({trackRemovals:!0});s=n.us;let c=[];e.targetChanges.forEach((m,_)=>{let I=s.get(_);if(!I)return;c.push(n.Gr.removeMatchingKeys(i,m.removedDocuments,_).next(()=>n.Gr.addMatchingKeys(i,m.addedDocuments,_)));let v=I.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(_)!==null?v=v.withResumeToken(Me.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):m.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(m.resumeToken,r)),s=s.insert(_,v),function(U,k,z){return U.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(I,v,m)&&c.push(n.Gr.updateTargetData(i,v))});let h=Lt(),f=te();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,m))}),c.push(L_(i,o,e.documentUpdates).next(m=>{h=m.Is,f=m.Es})),!r.isEqual(J.min())){let m=n.Gr.getLastRemoteSnapshotVersion(i).next(_=>n.Gr.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(m)}return V.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,h,f)).next(()=>h)}).then(i=>(n.us=s,i))}function L_(t,e,n){let r=te(),s=te();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Lt();return n.forEach((c,h)=>{let f=i.get(c);h.isFoundDocument()!==f.isFoundDocument()&&(s=s.add(c)),h.isNoDocument()&&h.version.isEqual(J.min())?(e.removeEntry(c,h.readTime),o=o.insert(c,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),o=o.insert(c,h)):K("LocalStore","Ignoring outdated watch update for ",c,". Current version:",f.version," Watch version:",h.version)}),{Is:o,Es:s}})}function k_(t,e){let n=X(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function M_(t,e){let n=X(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Gr.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):n.Gr.allocateTargetId(r).next(o=>(s=new es(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Gr.addTargetData(r,s).next(()=>s))))}).then(r=>{let s=n.us.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.us=n.us.insert(r.targetId,r),n.cs.set(e,r.targetId)),r})}async function fc(t,e,n){let r=X(t),s=r.us.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!or(o))throw o;K("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.us=r.us.remove(e),r.cs.delete(s.target)}function mc(t,e,n){let r=X(t),s=J.min(),i=te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(h,f,m){let _=X(h),I=_.cs.get(m);return I!==void 0?V.resolve(_.us.get(I)):_.Gr.getTargetData(f,m)}(r,o,dt(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(o,c.targetId).next(h=>{i=h})}).next(()=>r._s.getDocumentsMatchingQuery(o,e,n?s:J.min(),n?i:te())).next(c=>(B_(r,JE(e),c),{documents:c,ds:i})))}function B_(t,e,n){let r=t.ls.get(e)||J.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.ls.set(e,r)}var Bi=class{constructor(){this.activeTargetIds=s_()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var pc=class{constructor(){this._o=new Bi,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,n,r){this.ao[e]=n}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new Bi,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var gc=class{uo(e){}shutdown(){}};var Fi=class{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){K("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.To)e(0)}Po(){K("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var gi=null;function su(){return gi===null?gi=function(){return 268435456+Math.round(2147483648*Math.random())}():gi++,"0x"+gi.toString(16)}var F_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Ec=class{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}};var ke="WebChannelConnection",_c=class extends class{get Co(){return!1}constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+n.host,this.Mo=`projects/${s}/databases/${i}`,this.xo=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Oo(n,r,s,i,o){let c=su(),h=this.No(n,r.toUriEncodedString());K("RestConnection",`Sending RPC '${n}' ${c}:`,h,s);let f={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(f,i,o),this.Bo(n,h,f,s).then(m=>(K("RestConnection",`Received RPC '${n}' ${c}: `,m),m),m=>{throw jn("RestConnection",`RPC '${n}' ${c} failed with error: `,m,"url: ",h,"request:",s),m})}ko(n,r,s,i,o,c){return this.Oo(n,r,s,i,o)}Lo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ir}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}No(n,r){let s=F_[n];return`${this.Fo}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,n,r,s){let i=su();return new Promise((o,c)=>{let h=new Jo;h.setWithCredentials(!0),h.listenOnce(Zo.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Kr.NO_ERROR:let m=h.getResponseJson();K(ke,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(m)),o(m);break;case Kr.TIMEOUT:K(ke,`RPC '${e}' ${i} timed out`),c(new G(F.DEADLINE_EXCEEDED,"Request time out"));break;case Kr.HTTP_ERROR:let _=h.getStatus();if(K(ke,`RPC '${e}' ${i} failed with status:`,_,"response text:",h.getResponseText()),_>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);let v=I?.error;if(v&&v.status&&v.message){let x=function(k){let z=k.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(z)>=0?z:F.UNKNOWN}(v.status);c(new G(x,v.message))}else c(new G(F.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new G(F.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{K(ke,`RPC '${e}' ${i} completed.`)}});let f=JSON.stringify(s);K(ke,`RPC '${e}' ${i} sending request:`,s),h.send(n,"POST",f,r,15)})}qo(e,n,r){let s=su(),i=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=nu(),c=tu(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Lo(h.initMessageHeaders,n,r),h.encodeInitMessageHeaders=!0;let m=i.join("");K(ke,`Creating RPC '${e}' stream ${s}: ${m}`,h);let _=o.createWebChannel(m,h),I=!1,v=!1,x=new Ec({Eo:k=>{v?K(ke,`Not sending because RPC '${e}' stream ${s} is closed:`,k):(I||(K(ke,`Opening RPC '${e}' stream ${s} transport.`),_.open(),I=!0),K(ke,`RPC '${e}' stream ${s} sending:`,k),_.send(k))},Ao:()=>_.close()}),U=(k,z,$)=>{k.listen(z,W=>{try{$(W)}catch(Z){setTimeout(()=>{throw Z},0)}})};return U(_,Fn.EventType.OPEN,()=>{v||(K(ke,`RPC '${e}' stream ${s} transport opened.`),x.So())}),U(_,Fn.EventType.CLOSE,()=>{v||(v=!0,K(ke,`RPC '${e}' stream ${s} transport closed`),x.Do())}),U(_,Fn.EventType.ERROR,k=>{v||(v=!0,jn(ke,`RPC '${e}' stream ${s} transport errored:`,k),x.Do(new G(F.UNAVAILABLE,"The operation could not be completed")))}),U(_,Fn.EventType.MESSAGE,k=>{var z;if(!v){let $=k.data[0];ue(!!$);let W=$,Z=W?.error||((z=W[0])===null||z===void 0?void 0:z.error);if(Z){K(ke,`RPC '${e}' stream ${s} received error:`,Z);let Re=Z.status,ae=function(y){let R=be[y];if(R!==void 0)return Bf(R)}(Re),C=Z.message;ae===void 0&&(ae=F.INTERNAL,C="Unknown error status: "+Re+" with message "+Z.message),v=!0,x.Do(new G(ae,C)),_.close()}else K(ke,`RPC '${e}' stream ${s} received:`,$),x.vo($)}}),U(c,eu.STAT_EVENT,k=>{k.stat===fi.PROXY?K(ke,`RPC '${e}' stream ${s} detected buffering proxy`):k.stat===fi.NOPROXY&&K(ke,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.bo()},0),x}};function iu(){return typeof document<"u"?document:null}function ua(t){return new Vu(t,!0)}var Ui=class{constructor(e,n,r=1e3,s=1.5,i=6e4){this.li=e,this.timerId=n,this.Qo=r,this.Ko=s,this.$o=i,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();let n=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Uo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,s,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}};var Vi=class{constructor(e,n,r,s,i,o,c,h){this.li=e,this.Yo=r,this.Zo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new Ui(e,n)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,n){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Dt(n.toString()),Dt("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(n)}P_(){}auth(){this.state=1;let e=this.T_(this.Xo),n=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Xo===n&&this.I_(r,s)},r=>{e(()=>{let s=new G(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.E_(s)})})}I_(e,n){let r=this.T_(this.Xo);this.stream=this.d_(e,n),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(s=>{r(()=>this.E_(s))}),this.stream.onMessage(s=>{r(()=>++this.n_==1?this.A_(s):this.onNext(s))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return K("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return n=>{this.li.enqueueAndForget(()=>this.Xo===e?n():(K("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Tc=class extends Vi{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}d_(e,n){return this.connection.qo("Listen",e,n)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();let n=__(this.serializer,e),r=function(i){if(!("targetChange"in i))return J.min();let o=i.targetChange;return o.targetIds&&o.targetIds.length?J.min():o.readTime?ft(o.readTime):J.min()}(e);return this.listener.R_(n,r)}V_(e){let n={};n.database=Ku(this.serializer),n.addTarget=function(i,o){let c,h=o.target;if(c=Nu(h)?{documents:b_(i,h)}:{query:qf(i,h).ct},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=Ff(i,o.resumeToken);let f=Hu(i,o.expectedCount);f!==null&&(c.expectedCount=f)}else if(o.snapshotVersion.compareTo(J.min())>0){c.readTime=xi(i,o.snapshotVersion.toTimestamp());let f=Hu(i,o.expectedCount);f!==null&&(c.expectedCount=f)}return c}(this.serializer,e);let r=R_(this.serializer,e);r&&(n.labels=r),this.c_(n)}m_(e){let n={};n.database=Ku(this.serializer),n.removeTarget=e,this.c_(n)}},Ac=class extends Vi{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,n){return this.connection.qo("Write",e,n)}A_(e){return ue(!!e.streamToken),this.lastStreamToken=e.streamToken,ue(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();let n=A_(e.writeResults,e.commitTime),r=ft(e.commitTime);return this.listener.y_(r,n)}w_(){let e={};e.database=Ku(this.serializer),this.c_(e)}g_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>T_(this.serializer,r))};this.c_(n)}};var bc=class extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.S_=!1}b_(){if(this.S_)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,n,r,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Oo(e,qu(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(F.UNKNOWN,i.toString())})}ko(e,n,r,s,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.ko(e,qu(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(F.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}},yc=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(Dt(n),this.C_=!1):K("OnlineStateTracker",n)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}};var Ic=class{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=i,this.Q_.uo(o=>{r.enqueueAndForget(async()=>{Rn(this)&&(K("RemoteStore","Restarting streams for network reachability change."),await async function(h){let f=X(h);f.k_.add(4),await ds(f),f.K_.set("Unknown"),f.k_.delete(4),await ca(f)}(this))})}),this.K_=new yc(r,s)}};async function ca(t){if(Rn(t))for(let e of t.q_)await e(!0)}async function ds(t){for(let e of t.q_)await e(!1)}function Wf(t,e){let n=X(t);n.B_.has(e.targetId)||(n.B_.set(e.targetId,e),nl(n)?tl(n):ur(n).s_()&&el(n,e))}function Zc(t,e){let n=X(t),r=ur(n);n.B_.delete(e),r.s_()&&Yf(n,e),n.B_.size===0&&(r.s_()?r.a_():Rn(n)&&n.K_.set("Unknown"))}function el(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ur(t).V_(e)}function Yf(t,e){t.U_.xe(e),ur(t).m_(e)}function tl(t){t.U_=new Uu({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),ur(t).start(),t.K_.F_()}function nl(t){return Rn(t)&&!ur(t).i_()&&t.B_.size>0}function Rn(t){return X(t).k_.size===0}function $f(t){t.U_=void 0}async function U_(t){t.K_.set("Online")}async function V_(t){t.B_.forEach((e,n)=>{el(t,e)})}async function H_(t,e){$f(t),nl(t)?(t.K_.O_(e),tl(t)):t.K_.set("Unknown")}async function q_(t,e,n){if(t.K_.set("Online"),e instanceof Pi&&e.state===2&&e.cause)try{await async function(s,i){let o=i.cause;for(let c of i.targetIds)s.B_.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.B_.delete(c),s.U_.removeTarget(c))}(t,e)}catch(r){K("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Hi(t,r)}else if(e instanceof Kn?t.U_.$e(e):e instanceof Di?t.U_.Je(e):t.U_.Ge(e),!n.isEqual(J.min()))try{let r=await Qf(t.localStore);n.compareTo(r)>=0&&await function(i,o){let c=i.U_.it(o);return c.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){let m=i.B_.get(f);m&&i.B_.set(f,m.withResumeToken(h.resumeToken,o))}}),c.targetMismatches.forEach((h,f)=>{let m=i.B_.get(h);if(!m)return;i.B_.set(h,m.withResumeToken(Me.EMPTY_BYTE_STRING,m.snapshotVersion)),Yf(i,h);let _=new es(m.target,h,f,m.sequenceNumber);el(i,_)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){K("RemoteStore","Failed to raise snapshot:",r),await Hi(t,r)}}async function Hi(t,e,n){if(!or(e))throw e;t.k_.add(1),await ds(t),t.K_.set("Offline"),n||(n=()=>Qf(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K("RemoteStore","Retrying IndexedDB access"),await n(),t.k_.delete(1),await ca(t)})}function Xf(t,e){return e().catch(n=>Hi(t,n,e))}async function la(t){let e=X(t),n=en(e),r=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;G_(e);)try{let s=await k_(e.localStore,r);if(s===null){e.L_.length===0&&n.a_();break}r=s.batchId,K_(e,s)}catch(s){await Hi(e,s)}Jf(e)&&Zf(e)}function G_(t){return Rn(t)&&t.L_.length<10}function K_(t,e){t.L_.push(e);let n=en(t);n.s_()&&n.f_&&n.g_(e.mutations)}function Jf(t){return Rn(t)&&!en(t).i_()&&t.L_.length>0}function Zf(t){en(t).start()}async function z_(t){en(t).w_()}async function j_(t){let e=en(t);for(let n of t.L_)e.g_(n.mutations)}async function Q_(t,e,n){let r=t.L_.shift(),s=Lu.from(r,e,n);await Xf(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await la(t)}async function W_(t,e){e&&en(t).f_&&await async function(r,s){if(function(o){return l_(o)&&o!==F.ABORTED}(s.code)){let i=r.L_.shift();en(r).__(),await Xf(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await la(r)}}(t,e),Jf(t)&&Zf(t)}async function tf(t,e){let n=X(t);n.asyncQueue.verifyOperationInProgress(),K("RemoteStore","RemoteStore received new credentials");let r=Rn(n);n.k_.add(3),await ds(n),r&&n.K_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.k_.delete(3),await ca(n)}async function Y_(t,e){let n=X(t);e?(n.k_.delete(2),await ca(n)):e||(n.k_.add(2),await ds(n),n.K_.set("Unknown"))}function ur(t){return t.W_||(t.W_=function(n,r,s){let i=X(n);return i.b_(),new Tc(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Ro:U_.bind(null,t),mo:V_.bind(null,t),po:H_.bind(null,t),R_:q_.bind(null,t)}),t.q_.push(async e=>{e?(t.W_.__(),nl(t)?tl(t):t.K_.set("Unknown")):(await t.W_.stop(),$f(t))})),t.W_}function en(t){return t.G_||(t.G_=function(n,r,s){let i=X(n);return i.b_(),new Ac(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Ro:()=>Promise.resolve(),mo:z_.bind(null,t),po:W_.bind(null,t),p_:j_.bind(null,t),y_:Q_.bind(null,t)}),t.q_.push(async e=>{e?(t.G_.__(),await la(t)):(await t.G_.stop(),t.L_.length>0&&(K("RemoteStore",`Stopping write stream with ${t.L_.length} pending writes`),t.L_=[]))})),t.G_}var Rc=class t{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ze,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){let o=Date.now()+r,c=new t(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function fs(t,e){if(Dt("AsyncQueue",`${e}: ${t}`),or(t))return new G(F.UNAVAILABLE,`${e}: ${t}`);throw t}var qi=class t{static emptySet(e){return new t(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Q.comparator(n.key,r.key):(n,r)=>Q.comparator(n.key,r.key),this.keyedMap=zr(),this.sortedSet=new Te(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Gi=class{constructor(){this.z_=new Te(Q.comparator)}track(e){let n=e.doc.key,r=this.z_.get(n);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(n,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(n):e.type===1&&r.type===2?this.z_=this.z_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):Y():this.z_=this.z_.insert(n,e)}j_(){let e=[];return this.z_.inorderTraversal((n,r)=>{e.push(r)}),e}},er=class t{constructor(e,n,r,s,i,o,c,h,f){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,n,r,s,i){let o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new t(e,n,qi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&aa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}};var Cc=class{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}},Sc=class{constructor(){this.queries=nf(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(n,r){let s=X(n),i=s.queries;s.queries=nf(),i.forEach((o,c)=>{for(let h of c.J_)h.onError(r)})})(this,new G(F.ABORTED,"Firestore shutting down"))}};function nf(){return new xt(t=>Rf(t),aa)}async function rl(t,e){let n=X(t),r=3,s=e.query,i=n.queries.get(s);i?!i.Y_()&&e.Z_()&&(r=2):(i=new Cc,r=e.Z_()?0:1);try{switch(r){case 0:i.H_=await n.onListen(s,!0);break;case 1:i.H_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){let c=fs(o,`Initialization of query '${Vn(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.J_.push(e),e.ea(n.onlineState),i.H_&&e.ta(i.H_)&&il(n)}async function sl(t,e){let n=X(t),r=e.query,s=3,i=n.queries.get(r);if(i){let o=i.J_.indexOf(e);o>=0&&(i.J_.splice(o,1),i.J_.length===0?s=e.Z_()?0:1:!i.Y_()&&e.Z_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function $_(t,e){let n=X(t),r=!1;for(let s of e){let i=s.query,o=n.queries.get(i);if(o){for(let c of o.J_)c.ta(s)&&(r=!0);o.H_=s}}r&&il(n)}function X_(t,e,n){let r=X(t),s=r.queries.get(e);if(s)for(let i of s.J_)i.onError(n);r.queries.delete(e)}function il(t){t.X_.forEach(e=>{e.next()})}var wc,rf;(rf=wc||(wc={})).na="default",rf.Cache="cache";var rs=class{constructor(e,n,r){this.query=e,this.ra=n,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){let r=[];for(let s of e.docChanges)s.type!==3&&r.push(s);e=new er(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ia?this.oa(e)&&(this.ra.next(e),n=!0):this._a(e,this.onlineState)&&(this.aa(e),n=!0),this.sa=e,n}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let n=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),n=!0),n}_a(e,n){if(!e.fromCache||!this.Z_())return!0;let r=n!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}oa(e){if(e.docChanges.length>0)return!0;let n=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}aa(e){e=er.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==wc.Cache}};var Ki=class{constructor(e){this.key=e}},zi=class{constructor(e){this.key=e}},ji=class{constructor(e,n){this.query=e,this.da=n,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=te(),this.mutatedKeys=te(),this.Va=Cf(e),this.ma=new qi(this.Va)}get fa(){return this.da}ga(e,n){let r=n?n.pa:new Gi,s=n?n.ma:this.ma,i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1,h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,f=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,_)=>{let I=s.get(m),v=oa(this.query,_)?_:null,x=!!I&&this.mutatedKeys.has(I.key),U=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations),k=!1;I&&v?I.data.isEqual(v.data)?x!==U&&(r.track({type:3,doc:v}),k=!0):this.ya(I,v)||(r.track({type:2,doc:v}),k=!0,(h&&this.Va(v,h)>0||f&&this.Va(v,f)<0)&&(c=!0)):!I&&v?(r.track({type:0,doc:v}),k=!0):I&&!v&&(r.track({type:1,doc:I}),k=!0,(h||f)&&(c=!0)),k&&(v?(o=o.add(v),i=U?i.add(m):i.delete(m)):(o=o.delete(m),i=i.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),i=i.delete(m.key),r.track({type:1,doc:m})}return{ma:o,pa:r,ss:c,mutatedKeys:i}}ya(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){let i=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;let o=e.pa.j_();o.sort((m,_)=>function(v,x){let U=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return U(v)-U(x)}(m.type,_.type)||this.Va(m.doc,_.doc)),this.wa(r),s=s!=null&&s;let c=n&&!s?this.Sa():[],h=this.Ra.size===0&&this.current&&!s?1:0,f=h!==this.Aa;return this.Aa=h,o.length!==0||f?{snapshot:new er(this.query,e.ma,i,o,e.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:c}:{ba:c}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new Gi,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(n=>this.da=this.da.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.da=this.da.delete(n)),this.current=e.current)}Sa(){if(!this.current)return[];let e=this.Ra;this.Ra=te(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});let n=[];return e.forEach(r=>{this.Ra.has(r)||n.push(new zi(r))}),this.Ra.forEach(r=>{e.has(r)||n.push(new Ki(r))}),n}va(e){this.da=e.ds,this.Ra=te();let n=this.ga(e.documents);return this.applyChanges(n,!0)}Ca(){return er.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}},Nc=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},vc=class{constructor(e){this.key=e,this.Fa=!1}},Dc=class{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new xt(c=>Rf(c),aa),this.Oa=new Map,this.Na=new Set,this.La=new Te(Q.comparator),this.Ba=new Map,this.ka=new ns,this.qa={},this.Qa=new Map,this.Ka=ts.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}};async function J_(t,e,n=!0){let r=i0(t),s,i=r.xa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Ca()):s=await e0(r,e,n,!0),s}async function Z_(t,e){let n=i0(t);await e0(n,e,!0,!1)}async function e0(t,e,n,r){let s=await M_(t.localStore,dt(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n),c;return r&&(c=await eT(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Wf(t.remoteStore,s),c}async function eT(t,e,n,r,s){t.Ua=(_,I,v)=>async function(U,k,z,$){let W=k.view.ga(z);W.ss&&(W=await mc(U.localStore,k.query,!1).then(({documents:C})=>k.view.ga(C,W)));let Z=$&&$.targetChanges.get(k.targetId),Re=$&&$.targetMismatches.get(k.targetId)!=null,ae=k.view.applyChanges(W,U.isPrimaryClient,Z,Re);return af(U,k.targetId,ae.ba),ae.snapshot}(t,_,I,v);let i=await mc(t.localStore,e,!0),o=new ji(e,i.ds),c=o.ga(i.documents),h=Zr.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),f=o.applyChanges(c,t.isPrimaryClient,h);af(t,n,f.ba);let m=new Nc(e,n,o);return t.xa.set(e,m),t.Oa.has(n)?t.Oa.get(n).push(e):t.Oa.set(n,[e]),f.snapshot}async function tT(t,e,n){let r=X(t),s=r.xa.get(e),i=r.Oa.get(s.targetId);if(i.length>1)return r.Oa.set(s.targetId,i.filter(o=>!aa(o,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await fc(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Zc(r.remoteStore,s.targetId),Pc(r,s.targetId)}).catch(ar)):(Pc(r,s.targetId),await fc(r.localStore,s.targetId,!0))}async function nT(t,e){let n=X(t),r=n.xa.get(e),s=n.Oa.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Zc(n.remoteStore,r.targetId))}async function rT(t,e,n){let r=lT(t);try{let s=await function(o,c){let h=X(o),f=Ae.now(),m=c.reduce((v,x)=>v.add(x.key),te()),_,I;return h.persistence.runTransaction("Locally write mutations","readwrite",v=>{let x=Lt(),U=te();return h.hs.getEntries(v,m).next(k=>{x=k,x.forEach((z,$)=>{$.isValidDocument()||(U=U.add(z))})}).next(()=>h.localDocuments.getOverlayedDocuments(v,x)).next(k=>{_=k;let z=[];for(let $ of c){let W=c_($,_.get($.key).overlayedDocument);W!=null&&z.push(new gt($.key,W,Ef(W.value.mapValue),vt.exists(!0)))}return h.mutationQueue.addMutationBatch(v,f,z,c)}).next(k=>{I=k;let z=k.applyToLocalDocumentSet(_,U);return h.documentOverlayCache.saveOverlays(v,k.batchId,z)})}).then(()=>({batchId:I.batchId,changes:wf(_)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,h){let f=o.qa[o.currentUser.toKey()];f||(f=new Te(se)),f=f.insert(c,h),o.qa[o.currentUser.toKey()]=f}(r,s.batchId,n),await ms(r,s.changes),await la(r.remoteStore)}catch(s){let i=fs(s,"Failed to persist write");n.reject(i)}}async function t0(t,e){let n=X(t);try{let r=await x_(n.localStore,e);e.targetChanges.forEach((s,i)=>{let o=n.Ba.get(i);o&&(ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Fa=!0:s.modifiedDocuments.size>0?ue(o.Fa):s.removedDocuments.size>0&&(ue(o.Fa),o.Fa=!1))}),await ms(n,r,e)}catch(r){await ar(r)}}function sf(t,e,n){let r=X(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let s=[];r.xa.forEach((i,o)=>{let c=o.view.ea(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){let h=X(o);h.onlineState=c;let f=!1;h.queries.forEach((m,_)=>{for(let I of _.J_)I.ea(c)&&(f=!0)}),f&&il(h)}(r.eventManager,e),s.length&&r.Ma.R_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function sT(t,e,n){let r=X(t);r.sharedClientState.updateQueryState(e,"rejected",n);let s=r.Ba.get(e),i=s&&s.key;if(i){let o=new Te(Q.comparator);o=o.insert(i,at.newNoDocument(i,J.min()));let c=te().add(i),h=new vi(J.min(),new Map,new Te(se),o,c);await t0(r,h),r.La=r.La.remove(i),r.Ba.delete(e),al(r)}else await fc(r.localStore,e,!1).then(()=>Pc(r,e,n)).catch(ar)}async function iT(t,e){let n=X(t),r=e.batch.batchId;try{let s=await O_(n.localStore,e);r0(n,r,null),n0(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ms(n,s)}catch(s){await ar(s)}}async function aT(t,e,n){let r=X(t);try{let s=await function(o,c){let h=X(o);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return h.mutationQueue.lookupMutationBatch(f,c).next(_=>(ue(_!==null),m=_.keys(),h.mutationQueue.removeMutationBatch(f,_))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,m,c)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>h.localDocuments.getDocuments(f,m))})}(r.localStore,e);r0(r,e,n),n0(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ms(r,s)}catch(s){await ar(s)}}function n0(t,e){(t.Qa.get(e)||[]).forEach(n=>{n.resolve()}),t.Qa.delete(e)}function r0(t,e,n){let r=X(t),s=r.qa[r.currentUser.toKey()];if(s){let i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.qa[r.currentUser.toKey()]=s}}function Pc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Oa.get(e))t.xa.delete(r),n&&t.Ma.Wa(r,n);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach(r=>{t.ka.containsKey(r)||s0(t,r)})}function s0(t,e){t.Na.delete(e.path.canonicalString());let n=t.La.get(e);n!==null&&(Zc(t.remoteStore,n),t.La=t.La.remove(e),t.Ba.delete(n),al(t))}function af(t,e,n){for(let r of n)r instanceof Ki?(t.ka.addReference(r.key,e),oT(t,r)):r instanceof zi?(K("SyncEngine","Document no longer in limbo: "+r.key),t.ka.removeReference(r.key,e),t.ka.containsKey(r.key)||s0(t,r.key)):Y()}function oT(t,e){let n=e.key,r=n.path.canonicalString();t.La.get(n)||t.Na.has(r)||(K("SyncEngine","New document in limbo: "+n),t.Na.add(r),al(t))}function al(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){let e=t.Na.values().next().value;t.Na.delete(e);let n=new Q(pe.fromString(e)),r=t.Ka.next();t.Ba.set(r,new vc(n)),t.La=t.La.insert(n,r),Wf(t.remoteStore,new es(dt(ia(n.path)),r,"TargetPurposeLimboResolution",Wn.oe))}}async function ms(t,e,n){let r=X(t),s=[],i=[],o=[];r.xa.isEmpty()||(r.xa.forEach((c,h)=>{o.push(r.Ua(h,e,n).then(f=>{var m;if((f||n)&&r.isPrimaryClient){let _=f?!f.fromCache:(m=n?.targetChanges.get(h.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(f){s.push(f);let _=cc.zi(h.targetId,f);i.push(_)}}))}),await Promise.all(o),r.Ma.R_(s),await async function(h,f){let m=X(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>V.forEach(f,I=>V.forEach(I.Wi,v=>m.persistence.referenceDelegate.addReference(_,I.targetId,v)).next(()=>V.forEach(I.Gi,v=>m.persistence.referenceDelegate.removeReference(_,I.targetId,v)))))}catch(_){if(!or(_))throw _;K("LocalStore","Failed to update sequence numbers: "+_)}for(let _ of f){let I=_.targetId;if(!_.fromCache){let v=m.us.get(I),x=v.snapshotVersion,U=v.withLastLimboFreeSnapshotVersion(x);m.us=m.us.insert(I,U)}}}(r.localStore,i))}async function uT(t,e){let n=X(t);if(!n.currentUser.isEqual(e)){K("SyncEngine","User change. New user:",e.toKey());let r=await jf(n.localStore,e);n.currentUser=e,function(i,o){i.Qa.forEach(c=>{c.forEach(h=>{h.reject(new G(F.CANCELLED,o))})}),i.Qa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ms(n,r.Ts)}}function cT(t,e){let n=X(t),r=n.Ba.get(e);if(r&&r.Fa)return te().add(r.key);{let s=te(),i=n.Oa.get(e);if(!i)return s;for(let o of i){let c=n.xa.get(o);s=s.unionWith(c.view.fa)}return s}}function i0(t){let e=X(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=t0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=cT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sT.bind(null,e),e.Ma.R_=$_.bind(null,e.eventManager),e.Ma.Wa=X_.bind(null,e.eventManager),e}function lT(t){let e=X(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=iT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aT.bind(null,e),e}var tr=class{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ua(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,n){return null}Ya(e,n){return null}Ha(e){return P_(this.persistence,new hc,e.initialUser,this.serializer)}ja(e){return new ki(uc.ei,this.serializer)}za(e){return new pc}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};tr.provider={build:()=>new tr};var Oc=class extends tr{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,n){ue(this.persistence.referenceDelegate instanceof Mi);let r=this.persistence.referenceDelegate.garbageCollector;return new Yu(r,e.asyncQueue,n)}ja(e){let n=this.cacheSizeBytes!==void 0?tt.withCacheSize(this.cacheSizeBytes):tt.DEFAULT;return new ki(r=>Mi.ei(r,n),this.serializer)}};var ss=class{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>sf(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=uT.bind(null,this.syncEngine),await Y_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Sc}()}createDatastore(e){let n=ua(e.databaseInfo.databaseId),r=function(i){return new _c(i)}(e.databaseInfo);return function(i,o,c,h){return new bc(i,o,c,h)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new Ic(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>sf(this.syncEngine,n,0),function(){return Fi.p()?new Fi:new gc}())}createSyncEngine(e,n){return function(s,i,o,c,h,f,m){let _=new Dc(s,i,o,c,h,f);return m&&(_.$a=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){let i=X(s);K("RemoteStore","RemoteStore shutting down."),i.k_.add(5),await ds(i),i.Q_.shutdown(),i.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}};ss.provider={build:()=>new ss};var is=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):Dt("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,n){setTimeout(()=>{this.muted||e(n)},0)}};var xc=class{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Se.UNAUTHENTICATED,this.clientId=bi.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{K("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(K("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ze;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=fs(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function au(t,e){t.asyncQueue.verifyOperationInProgress(),K("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await jf(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function of(t,e){t.asyncQueue.verifyOperationInProgress();let n=await a0(t);K("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>tf(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>tf(e.remoteStore,s)),t._onlineComponents=e}async function a0(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K("FirestoreClient","Using user provided OfflineComponentProvider");try{await au(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;jn("Error using user provided cache. Falling back to memory cache: "+n),await au(t,new tr)}}else K("FirestoreClient","Using default OfflineComponentProvider"),await au(t,new Oc(void 0));return t._offlineComponents}async function ol(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K("FirestoreClient","Using user provided OnlineComponentProvider"),await of(t,t._uninitializedComponentsProvider._online)):(K("FirestoreClient","Using default OnlineComponentProvider"),await of(t,new ss))),t._onlineComponents}function o0(t){return a0(t).then(e=>e.localStore)}function hT(t){return ol(t).then(e=>e.syncEngine)}function dT(t){return ol(t).then(e=>e.datastore)}async function Qi(t){let e=await ol(t),n=e.eventManager;return n.onListen=J_.bind(null,e.syncEngine),n.onUnlisten=tT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Z_.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=nT.bind(null,e.syncEngine),n}function fT(t,e){let n=new ze;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{let c=await function(f,m){let _=X(f);return _.persistence.runTransaction("read document","readonly",I=>_.localDocuments.getDocument(I,m))}(s,i);c.isFoundDocument()?o.resolve(c):c.isNoDocument()?o.resolve(null):o.reject(new G(F.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(c){let h=fs(c,`Failed to get document '${i} from cache`);o.reject(h)}}(await o0(t),e,n)),n.promise}function u0(t,e,n={}){let r=new ze;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,h,f){let m=new is({next:I=>{m.eu(),o.enqueueAndForget(()=>sl(i,_));let v=I.docs.has(c);!v&&I.fromCache?f.reject(new G(F.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&I.fromCache&&h&&h.source==="server"?f.reject(new G(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(I)},error:I=>f.reject(I)}),_=new rs(ia(c.path),m,{includeMetadataChanges:!0,ua:!0});return rl(i,_)}(await Qi(t),t.asyncQueue,e,n,r)),r.promise}function mT(t,e){let n=new ze;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{let c=await mc(s,i,!0),h=new ji(i,c.ds),f=h.ga(c.documents),m=h.applyChanges(f,!1);o.resolve(m.snapshot)}catch(c){let h=fs(c,`Failed to execute query '${i} against cache`);o.reject(h)}}(await o0(t),e,n)),n.promise}function c0(t,e,n={}){let r=new ze;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,h,f){let m=new is({next:I=>{m.eu(),o.enqueueAndForget(()=>sl(i,_)),I.fromCache&&h.source==="server"?f.reject(new G(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(I)},error:I=>f.reject(I)}),_=new rs(c,m,{includeMetadataChanges:!0,ua:!0});return rl(i,_)}(await Qi(t),t.asyncQueue,e,n,r)),r.promise}function pT(t,e,n){let r=new ze;return t.asyncQueue.enqueueAndForget(async()=>{try{let s=await dT(t);r.resolve(async function(o,c,h){var f;let m=X(o),{request:_,lt:I,parent:v}=y_(m.serializer,XE(c),h);m.connection.Co||delete _.parent;let x=(await m.ko("RunAggregationQuery",m.serializer.databaseId,v,_,1)).filter(k=>!!k.result);ue(x.length===1);let U=(f=x[0].result)===null||f===void 0?void 0:f.aggregateFields;return Object.keys(U).reduce((k,z)=>(k[I[z]]=U[z],k),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}function l0(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var uf=new Map;function h0(t,e,n){if(!n)throw new G(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function gT(t,e,n,r){if(e===!0&&r===!0)throw new G(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function cf(t){if(!Q.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function lf(t){if(Q.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ha(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Y()}function _e(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=ha(t);throw new G(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function ET(t,e){if(e<=0)throw new G(F.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Wi=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=l0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},nr=class{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Wi({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Wi(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ou;switch(r.type){case"firstParty":return new hu(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=uf.get(n);r&&(K("ComponentProvider","Removing Datastore"),uf.delete(n),r.terminate())}(this),Promise.resolve()}};function _T(t,e,n,r={}){var s;let i=(t=_e(t,nr))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=Se.MOCK_USER;else{c=ii(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);let f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new G(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Se(f)}t._authCredentials=new uu(new Ai(c,h))}}var Xe=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Ne=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Xt=class t extends Xe{constructor(e,n,r){super(e,n,ia(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ne(this.firestore,null,new Q(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function rn(t,e,...n){if(t=Ce(t),h0("collection","path",e),t instanceof nr){let r=pe.fromString(e,...n);return lf(r),new Xt(t,null,r)}{if(!(t instanceof Ne||t instanceof Xt))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(pe.fromString(e,...n));return lf(r),new Xt(t.firestore,null,r)}}function cr(t,e,...n){if(t=Ce(t),arguments.length===1&&(e=bi.newId()),h0("doc","path",e),t instanceof nr){let r=pe.fromString(e,...n);return cf(r),new Ne(t,null,new Q(r))}{if(!(t instanceof Ne||t instanceof Xt))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(pe.fromString(e,...n));return cf(r),new Ne(t.firestore,t instanceof Xt?t.converter:null,new Q(r))}}var Yi=class{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new Ui(this,"async_queue_retry"),this.fu=()=>{let r=iu();r&&K("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;let n=iu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;let n=iu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});let n=new ze;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!or(e))throw e;K("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){let n=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;let s=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(r);throw Dt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Ru=!1,r))));return this.gu=n,n}enqueueAfterDelay(e,n,r){this.pu(),this.mu.indexOf(e)>-1&&(n=0);let s=Rc.createAndSchedule(this,e,n,r,i=>this.Su(i));return this.du.push(s),s}pu(){this.Au&&Y()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(let n of this.du)if(n.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.du)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){let n=this.du.indexOf(e);this.du.splice(n,1)}};function hf(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let s=n;for(let i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}var qe=class extends nr{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Yi,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Yi(e),this._firestoreClient=void 0,await e}}};function d0(t,e){let n=typeof t=="object"?t:hi(),r=typeof t=="string"?t:e||"(default)",s=ci(n,"firestore").getImmediate({identifier:r});if(!s._initialized){let i=si("firestore");i&&_T(s,...i)}return s}function Mt(t){if(t._terminated)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||TT(t),t._firestoreClient}function TT(t){var e,n,r;let s=t._freezeSettings(),i=function(c,h,f,m){return new gu(c,h,f,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,l0(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new xc(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){let h=c?._online.build();return{_offline:c?._offline.build(h),_online:h}}(t._componentsProvider))}var Lc=class{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}},kc=class{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var as=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Me.fromBase64String(e))}catch(n){throw new G(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Me.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var rr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $e(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var tn=class{constructor(e){this._methodName=e}};var os=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}};var us=class{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}};var AT=/^__.*__$/,Mc=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new gt(e,this.data,this.fieldMask,n,this.fieldTransforms):new yn(e,this.data,n,this.fieldTransforms)}},$i=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new gt(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function f0(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}var Bc=class t{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Fu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.xu({path:r,Nu:!1});return s.Lu(e),s}Bu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.xu({path:r,Nu:!1});return s.Fu(),s}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Ji(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(f0(this.Mu)&&AT.test(e))throw this.qu('Document fields cannot begin and end with "__"')}},Fc=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ua(e)}$u(e,n,r,s=!1){return new Bc({Mu:e,methodName:n,Ku:r,path:$e.emptyPath(),Nu:!1,Qu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function da(t){let e=t._freezeSettings(),n=ua(t._databaseId);return new Fc(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bT(t,e,n,r,s,i={}){let o=t.$u(i.merge||i.mergeFields?2:0,e,n,s);ul("Data must be an object, but it was:",o,r);let c=p0(r,o),h,f;if(i.merge)h=new nt(o.fieldMask),f=o.fieldTransforms;else if(i.mergeFields){let m=[];for(let _ of i.mergeFields){let I=Vc(e,_,n);if(!o.contains(I))throw new G(F.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);E0(m,I)||m.push(I)}h=new nt(m),f=o.fieldTransforms.filter(_=>h.covers(_.field))}else h=null,f=o.fieldTransforms;return new Mc(new Ye(c),h,f)}var Xi=class t extends tn{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};var Uc=class t extends tn{constructor(e,n){super(e),this.Wu=n}_toFieldTransform(e){let n=new bn(e.serializer,Df(e.serializer,this.Wu));return new Du(e.path,n)}isEqual(e){return e instanceof t&&this.Wu===e.Wu}};function yT(t,e,n,r){let s=t.$u(1,e,n);ul("Data must be an object, but it was:",s,r);let i=[],o=Ye.empty();nn(r,(h,f)=>{let m=cl(e,h,n);f=Ce(f);let _=s.Bu(m);if(f instanceof Xi)i.push(m);else{let I=ps(f,_);I!=null&&(i.push(m),o.set(m,I))}});let c=new nt(i);return new $i(o,c,s.fieldTransforms)}function IT(t,e,n,r,s,i){let o=t.$u(1,e,n),c=[Vc(e,r,n)],h=[s];if(i.length%2!=0)throw new G(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<i.length;I+=2)c.push(Vc(e,i[I])),h.push(i[I+1]);let f=[],m=Ye.empty();for(let I=c.length-1;I>=0;--I)if(!E0(f,c[I])){let v=c[I],x=h[I];x=Ce(x);let U=o.Bu(v);if(x instanceof Xi)f.push(v);else{let k=ps(x,U);k!=null&&(f.push(v),m.set(v,k))}}let _=new nt(f);return new $i(m,_,o.fieldTransforms)}function m0(t,e,n,r=!1){return ps(n,t.$u(r?4:3,e))}function ps(t,e){if(g0(t=Ce(t)))return ul("Unsupported field value:",e,t),p0(t,e);if(t instanceof tn)return function(r,s){if(!f0(s.Mu))throw s.qu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.qu(`${r._methodName}() is not currently supported inside arrays`);let i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,s){let i=[],o=0;for(let c of r){let h=ps(c,s.ku(o));h==null&&(h={nullValue:"NULL_VALUE"}),i.push(h),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ce(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Df(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let i=Ae.fromDate(r);return{timestampValue:xi(s.serializer,i)}}if(r instanceof Ae){let i=new Ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xi(s.serializer,i)}}if(r instanceof os)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof as)return{bytesValue:Ff(s.serializer,r._byteString)};if(r instanceof Ne){let i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Jc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof us)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw c.qu("VectorValues must only contain numeric values.");return Xc(c.serializer,h)})}}}}}}(r,s);throw s.qu(`Unsupported field value: ${ha(r)}`)}(t,e)}function p0(t,e){let n={};return mf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):nn(t,(r,s)=>{let i=ps(s,e.Ou(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function g0(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ae||t instanceof os||t instanceof as||t instanceof Ne||t instanceof tn||t instanceof us)}function ul(t,e,n){if(!g0(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){let r=ha(n);throw r==="an object"?e.qu(t+" a custom object"):e.qu(t+" "+r)}}function Vc(t,e,n){if((e=Ce(e))instanceof rr)return e._internalPath;if(typeof e=="string")return cl(t,e);throw Ji("Field path arguments must be of type string or ",t,!1,void 0,n)}var RT=new RegExp("[~\\*/\\[\\]]");function cl(t,e,n){if(e.search(RT)>=0)throw Ji(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rr(...e.split("."))._internalPath}catch{throw Ji(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ji(t,e,n,r,s){let i=r&&!r.isEmpty(),o=s!==void 0,c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(i||o)&&(h+=" (found",i&&(h+=` in field ${r}`),o&&(h+=` in document ${s}`),h+=")"),new G(F.INVALID_ARGUMENT,c+t+h)}function E0(t,e){return t.some(n=>n.isEqual(e))}var cs=class{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ne(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Hc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(fa("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},Hc=class extends cs{data(){return super.data()}};function fa(t,e){return typeof e=="string"?cl(t,e):e instanceof rr?e._internalPath:e._delegate._internalPath}function _0(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ls=class{},In=class extends ls{};function T0(t,e,...n){let r=[];e instanceof ls&&r.push(e),r=r.concat(n),function(i){let o=i.filter(h=>h instanceof qc).length,c=i.filter(h=>h instanceof Zi).length;if(o>1||o>0&&c>0)throw new G(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let s of r)t=s._apply(t);return t}var Zi=class t extends In{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return R0(e._query,n),new Xe(e.firestore,e.converter,vu(e._query,n))}_parse(e){let n=da(e.firestore);return function(i,o,c,h,f,m,_){let I;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new G(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){ff(_,m);let v=[];for(let x of _)v.push(df(h,i,x));I={arrayValue:{values:v}}}else I=df(h,i,_)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||ff(_,m),I=m0(c,o,_,m==="in"||m==="not-in");return Ie.create(f,m,I)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function A0(t,e,n){let r=e,s=fa("where",t);return Zi._create(s,r,n)}var qc=class t extends ls{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ot.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s,c=i.getFlattenedFilters();for(let h of c)R0(o,h),o=vu(o,h)}(e._query,n),new Xe(e.firestore,e.converter,vu(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Gc=class t extends In{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(s,i,o){if(s.startAt!==null)throw new G(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new G(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _n(i,o)}(e._query,this._field,this._direction);return new Xe(e.firestore,e.converter,function(s,i){let o=s.explicitOrderBy.concat([i]);return new pt(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}};function b0(t,e="asc"){let n=e,r=fa("orderBy",t);return Gc._create(r,n)}var Kc=class t extends In{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Xe(e.firestore,e.converter,Ni(e._query,this._limit,this._limitType))}};function y0(t){return ET("limit",t),Kc._create("limit",t,"F")}var ea=class t extends In{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=I0(e,this.type,this._docOrFields,this._inclusive);return new Xe(e.firestore,e.converter,function(s,i){return new pt(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}};function ll(...t){return ea._create("startAt",t,!0)}function hl(...t){return ea._create("startAfter",t,!1)}var ta=class t extends In{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=I0(e,this.type,this._docOrFields,this._inclusive);return new Xe(e.firestore,e.converter,function(s,i){return new pt(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}};function dl(...t){return ta._create("endBefore",t,!1)}function fl(...t){return ta._create("endAt",t,!0)}function I0(t,e,n,r){if(n[0]=Ce(n[0]),n[0]instanceof cs)return function(i,o,c,h,f){if(!h)throw new G(F.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);let m=[];for(let _ of Gn(i))if(_.field.isKeyField())m.push(Si(o,h.key));else{let I=h.data.field(_.field);if(ra(I))throw new G(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+_.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){let v=_.field.canonicalString();throw new G(F.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}m.push(I)}return new Zt(m,f)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let s=da(t.firestore);return function(o,c,h,f,m,_){let I=o.explicitOrderBy;if(m.length>I.length)throw new G(F.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let v=[];for(let x=0;x<m.length;x++){let U=m[x];if(I[x].field.isKeyField()){if(typeof U!="string")throw new G(F.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof U}`);if(!$c(o)&&U.indexOf("/")!==-1)throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${U}' contains a slash.`);let k=o.path.child(pe.fromString(U));if(!Q.isDocumentKey(k))throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${k}' is not because it contains an odd number of segments.`);let z=new Q(k);v.push(Si(c,z))}else{let k=m0(h,f,U);v.push(k)}}return new Zt(v,_)}(t._query,t.firestore._databaseId,s,e,n,r)}}function df(t,e,n){if(typeof(n=Ce(n))=="string"){if(n==="")throw new G(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$c(e)&&n.indexOf("/")!==-1)throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(pe.fromString(n));if(!Q.isDocumentKey(r))throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Si(t,new Q(r))}if(n instanceof Ne)return Si(t,n._key);throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ha(n)}.`)}function ff(t,e){if(!Array.isArray(t)||t.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function R0(t,e){let n=function(s,i){for(let o of s)for(let c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var zc=class{convertValue(e,n="none"){switch(Jt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ot(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Y()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return nn(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;let i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>me(o.doubleValue));return new us(i)}convertGeoPoint(e){return new os(me(e.latitude),me(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=sa(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp($r(e));default:return null}}convertTimestamp(e){let n=Pt(e);return new Ae(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=pe.fromString(e);ue(zf(r));let s=new Ci(r.get(1),r.get(3)),i=new Q(r.popFirst(5));return s.isEqual(n)||Dt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}};function CT(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function ST(){return new Lc("count")}var $t=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},hs=class extends cs{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new zn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(fa("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},zn=class extends hs{data(e={}){return super.data(e)}},sr=class{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new $t(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new zn(this._firestore,this._userDataWriter,r.key,r,new $t(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{let h=new zn(s._firestore,s._userDataWriter,c.doc.key,c.doc,new $t(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{let h=new zn(s._firestore,s._userDataWriter,c.doc.key,c.doc,new $t(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter),f=-1,m=-1;return c.type!==0&&(f=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:wT(c.type),doc:h,oldIndex:f,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function wT(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function ml(t){t=_e(t,Ne);let e=_e(t.firestore,qe);return u0(Mt(e),t._key).then(n=>_l(e,t,n))}var kt=class extends zc{constructor(e){super(),this.firestore=e}convertBytes(e){return new as(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ne(this.firestore,null,n)}};function C0(t){t=_e(t,Ne);let e=_e(t.firestore,qe),n=Mt(e),r=new kt(e);return fT(n,t._key).then(s=>new hs(e,r,t._key,s,new $t(s!==null&&s.hasLocalMutations,!0),t.converter))}function S0(t){t=_e(t,Ne);let e=_e(t.firestore,qe);return u0(Mt(e),t._key,{source:"server"}).then(n=>_l(e,t,n))}function pl(t){t=_e(t,Xe);let e=_e(t.firestore,qe),n=Mt(e),r=new kt(e);return _0(t._query),c0(n,t._query).then(s=>new sr(e,r,t,s))}function w0(t){t=_e(t,Xe);let e=_e(t.firestore,qe),n=Mt(e),r=new kt(e);return mT(n,t._query).then(s=>new sr(e,r,t,s))}function N0(t){t=_e(t,Xe);let e=_e(t.firestore,qe),n=Mt(e),r=new kt(e);return c0(n,t._query,{source:"server"}).then(s=>new sr(e,r,t,s))}function v0(t,e,n){t=_e(t,Ne);let r=_e(t.firestore,qe),s=CT(t.converter,e,n);return El(r,[bT(da(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,vt.none())])}function D0(t,e,n,...r){t=_e(t,Ne);let s=_e(t.firestore,qe),i=da(s),o;return o=typeof(e=Ce(e))=="string"||e instanceof rr?IT(i,"updateDoc",t._key,e,n,r):yT(i,"updateDoc",t._key,e),El(s,[o.toMutation(t._key,vt.exists(!0))])}function P0(t){return El(_e(t.firestore,qe),[new Jr(t._key,vt.none())])}function gl(t,...e){var n,r,s;t=Ce(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||hf(e[o])||(i=e[o],o++);let c={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(hf(e[o])){let _=e[o];e[o]=(n=_.next)===null||n===void 0?void 0:n.bind(_),e[o+1]=(r=_.error)===null||r===void 0?void 0:r.bind(_),e[o+2]=(s=_.complete)===null||s===void 0?void 0:s.bind(_)}let h,f,m;if(t instanceof Ne)f=_e(t.firestore,qe),m=ia(t._key.path),h={next:_=>{e[o]&&e[o](_l(f,t,_))},error:e[o+1],complete:e[o+2]};else{let _=_e(t,Xe);f=_e(_.firestore,qe),m=_._query;let I=new kt(f);h={next:v=>{e[o]&&e[o](new sr(f,I,_,v))},error:e[o+1],complete:e[o+2]},_0(t._query)}return function(I,v,x,U){let k=new is(U),z=new rs(v,k,x);return I.asyncQueue.enqueueAndForget(async()=>rl(await Qi(I),z)),()=>{k.eu(),I.asyncQueue.enqueueAndForget(async()=>sl(await Qi(I),z))}}(Mt(f),m,c,h)}function El(t,e){return function(r,s){let i=new ze;return r.asyncQueue.enqueueAndForget(async()=>rT(await hT(r),s,i)),i.promise}(Mt(t),e)}function _l(t,e,n){let r=n.docs.get(e._key),s=new kt(t);return new hs(t,s,e._key,r,new $t(n.hasPendingWrites,n.fromCache),e.converter)}function O0(t){return NT(t,{count:ST()})}function NT(t,e){let n=_e(t.firestore,qe),r=Mt(n),s=jE(e,(i,o)=>new Mu(o,i.aggregateType,i._internalFieldPath));return pT(r,t._query,s).then(i=>function(c,h,f){let m=new kt(c);return new kc(h,m,f)}(n,t,i))}function x0(t){return new Uc("increment",t)}(function(e,n=!0){(function(s){ir=s})(li),fn(new it("firestore",(r,{instanceIdentifier:s,options:i})=>{let o=r.getProvider("app").getImmediate(),c=new qe(new cu(r.getProvider("auth-internal")),new fu(r.getProvider("app-check-internal")),function(f,m){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new G(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ci(f.options.projectId,m)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),St(xd,"4.7.5",e),St(xd,"4.7.5","esm2017")})();B();M();B();M();var H0="firebasestorage.googleapis.com",q0="storageBucket",DT=2*60*1e3,PT=10*60*1e3,OT=1e3;var ge=class t extends Ke{constructor(e,n,r=0){super(Tl(e),`Firebase Storage: ${n} (${Tl(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Tl(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},fe;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(fe||(fe={}));function Tl(t){return"storage/"+t}function Nl(){let t="An unknown error occurred, please check the error payload for server response.";return new ge(fe.UNKNOWN,t)}function xT(t){return new ge(fe.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function LT(t){return new ge(fe.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function kT(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ge(fe.UNAUTHENTICATED,t)}function MT(){return new ge(fe.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function BT(t){return new ge(fe.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function G0(){return new ge(fe.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function K0(){return new ge(fe.CANCELED,"User canceled the upload/download.")}function FT(t){return new ge(fe.INVALID_URL,"Invalid URL '"+t+"'.")}function UT(t){return new ge(fe.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function VT(){return new ge(fe.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+q0+"' property when initializing the app?")}function z0(){return new ge(fe.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function HT(){return new ge(fe.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function qT(){return new ge(fe.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function GT(t){return new ge(fe.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function bl(t){return new ge(fe.INVALID_ARGUMENT,t)}function j0(){return new ge(fe.APP_DELETED,"The Firebase app was deleted.")}function KT(t){return new ge(fe.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Es(t,e){return new ge(fe.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function gs(t){throw new ge(fe.INTERNAL_ERROR,"Internal error: "+t)}var ut=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw UT(e)}static makeFromUrl(e,n){let r=null,s="([A-Za-z0-9.\\-_]+)";function i(Z){Z.path.charAt(Z.path.length-1)==="/"&&(Z.path_=Z.path_.slice(0,-1))}let o="(/(.*))?$",c=new RegExp("^gs://"+s+o,"i"),h={bucket:1,path:3};function f(Z){Z.path_=decodeURIComponent(Z.path)}let m="v[A-Za-z0-9_]+",_=n.replace(/[.]/g,"\\."),I="(/([^?#]*).*)?$",v=new RegExp(`^https?://${_}/${m}/b/${s}/o${I}`,"i"),x={bucket:1,path:3},U=n===H0?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",z=new RegExp(`^https?://${U}/${s}/${k}`,"i"),W=[{regex:c,indices:h,postModify:i},{regex:v,indices:x,postModify:f},{regex:z,indices:{bucket:1,path:2},postModify:f}];for(let Z=0;Z<W.length;Z++){let Re=W[Z],ae=Re.regex.exec(e);if(ae){let C=ae[Re.indices.bucket],T=ae[Re.indices.path];T||(T=""),r=new t(C,T),Re.postModify(r);break}}if(r==null)throw FT(e);return r}},yl=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function zT(t,e,n){let r=1,s=null,i=null,o=!1,c=0;function h(){return c===2}let f=!1;function m(...k){f||(f=!0,e.apply(null,k))}function _(k){s=setTimeout(()=>{s=null,t(v,h())},k)}function I(){i&&clearTimeout(i)}function v(k,...z){if(f){I();return}if(k){I(),m.call(null,k,...z);return}if(h()||o){I(),m.call(null,k,...z);return}r<64&&(r*=2);let W;c===1?(c=2,W=0):W=(r+Math.random())*1e3,_(W)}let x=!1;function U(k){x||(x=!0,I(),!f&&(s!==null?(k||(c=2),clearTimeout(s),_(0)):k||(c=1)))}return _(0),i=setTimeout(()=>{o=!0,U(!0)},n),U}function jT(t){t(!1)}function QT(t){return t!==void 0}function WT(t){return typeof t=="function"}function YT(t){return typeof t=="object"&&!Array.isArray(t)}function Ea(t){return typeof t=="string"||t instanceof String}function L0(t){return vl()&&t instanceof Blob}function vl(){return typeof Blob<"u"}function k0(t,e,n,r){if(r<e)throw bl(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw bl(`Invalid value for '${t}'. Expected ${n} or less.`)}function As(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function Q0(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Sn;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Sn||(Sn={}));function W0(t,e){let n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}var Il=class{constructor(e,n,r,s,i,o,c,h,f,m,_,I=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=h,this.timeout_=f,this.progressCallback_=m,this.connectionFactory_=_,this.retry=I,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){let e=(r,s)=>{if(s){r(!1,new hr(!1,null,!0));return}let i=this.connectionFactory_();this.pendingConnection_=i;let o=c=>{let h=c.loaded,f=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,f)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;let c=i.getErrorCode()===Sn.NO_ERROR,h=i.getStatus();if(!c||W0(h,this.additionalRetryCodes_)&&this.retry){let m=i.getErrorCode()===Sn.ABORT;r(!1,new hr(!1,null,m));return}let f=this.successCodes_.indexOf(h)!==-1;r(!0,new hr(f,i))})},n=(r,s)=>{let i=this.resolve_,o=this.reject_,c=s.connection;if(s.wasSuccessCode)try{let h=this.callback_(c,c.getResponse());QT(h)?i(h):i()}catch(h){o(h)}else if(c!==null){let h=Nl();h.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,h)):o(h)}else if(s.canceled){let h=this.appDelete_?j0():K0();o(h)}else{let h=G0();o(h)}};this.canceled_?n(!1,new hr(!1,null,!0)):this.backoffId_=zT(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&jT(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},hr=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function $T(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function XT(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function JT(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ZT(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function eA(t,e,n,r,s,i,o=!0){let c=Q0(t.urlParams),h=t.url+c,f=Object.assign({},t.headers);return JT(f,e),$T(f,n),XT(f,i),ZT(f,r),new Il(h,t.method,f,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}function tA(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function nA(...t){let e=tA();if(e!==void 0){let n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(vl())return new Blob(t);throw new ge(fe.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function rA(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function sA(t){if(typeof atob>"u")throw GT("base-64");return atob(t)}var Et={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},_s=class{constructor(e,n){this.data=e,this.contentType=n||null}};function iA(t,e){switch(t){case Et.RAW:return new _s(Y0(e));case Et.BASE64:case Et.BASE64URL:return new _s($0(t,e));case Et.DATA_URL:return new _s(oA(e),uA(e))}throw Nl()}function Y0(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function aA(t){let e;try{e=decodeURIComponent(t)}catch{throw Es(Et.DATA_URL,"Malformed data URL.")}return Y0(e)}function $0(t,e){switch(t){case Et.BASE64:{let s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Es(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Et.BASE64URL:{let s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Es(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=sA(e)}catch(s){throw s.message.includes("polyfill")?s:Es(t,"Invalid character found")}let r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}var pa=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw Es(Et.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=n[1]||null;r!=null&&(this.base64=cA(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function oA(t){let e=new pa(t);return e.base64?$0(Et.BASE64,e.rest):aA(e.rest)}function uA(t){return new pa(t).contentType}function cA(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var ga=class t{constructor(e,n){let r=0,s="";L0(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(L0(this.data_)){let r=this.data_,s=rA(r,e,n);return s===null?null:new t(s)}else{let r=new Uint8Array(this.data_.buffer,e,n-e);return new t(r,!0)}}static getBlob(...e){if(vl()){let n=e.map(r=>r instanceof t?r.data_:r);return new t(nA.apply(null,n))}else{let n=e.map(o=>Ea(o)?iA(Et.RAW,o).data:o.data_),r=0;n.forEach(o=>{r+=o.byteLength});let s=new Uint8Array(r),i=0;return n.forEach(o=>{for(let c=0;c<o.length;c++)s[i++]=o[c]}),new t(s,!0)}}uploadData(){return this.data_}};function X0(t){let e;try{e=JSON.parse(t)}catch{return null}return YT(e)?e:null}function lA(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function hA(t,e){let n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function J0(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function dA(t,e){return e}var De=class{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||dA}},ma=null;function fA(t){return!Ea(t)||t.length<2?t:J0(t)}function Dl(){if(ma)return ma;let t=[];t.push(new De("bucket")),t.push(new De("generation")),t.push(new De("metageneration")),t.push(new De("name","fullPath",!0));function e(i,o){return fA(o)}let n=new De("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}let s=new De("size");return s.xform=r,t.push(s),t.push(new De("timeCreated")),t.push(new De("updated")),t.push(new De("md5Hash",null,!0)),t.push(new De("cacheControl",null,!0)),t.push(new De("contentDisposition",null,!0)),t.push(new De("contentEncoding",null,!0)),t.push(new De("contentLanguage",null,!0)),t.push(new De("contentType",null,!0)),t.push(new De("metadata","customMetadata",!0)),ma=t,ma}function mA(t,e){function n(){let r=t.bucket,s=t.fullPath,i=new ut(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function pA(t,e,n){let r={};r.type="file";let s=n.length;for(let i=0;i<s;i++){let o=n[i];r[o.local]=o.xform(r,e[o.server])}return mA(r,t),r}function Z0(t,e,n){let r=X0(e);return r===null?null:pA(t,r,n)}function gA(t,e,n,r){let s=X0(e);if(s===null||!Ea(s.downloadTokens))return null;let i=s.downloadTokens;if(i.length===0)return null;let o=encodeURIComponent;return i.split(",").map(f=>{let m=t.bucket,_=t.fullPath,I="/b/"+o(m)+"/o/"+o(_),v=As(I,n,r),x=Q0({alt:"media",token:f});return v+x})[0]}function em(t,e){let n={},r=e.length;for(let s=0;s<r;s++){let i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}var sn=class{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Bt(t){if(!t)throw Nl()}function Pl(t,e){function n(r,s){let i=Z0(t,s,e);return Bt(i!==null),i}return n}function EA(t,e){function n(r,s){let i=Z0(t,s,e);return Bt(i!==null),gA(i,s,t.host,t._protocol)}return n}function bs(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=MT():s=kT():n.getStatus()===402?s=LT(t.bucket):n.getStatus()===403?s=BT(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function tm(t){let e=bs(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=xT(t.path)),i.serverResponse=s.serverResponse,i}return n}function nm(t,e,n){let r=e.fullServerUrl(),s=As(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,c=new sn(s,i,Pl(t,n),o);return c.errorHandler=tm(e),c}function _A(t,e,n){let r=e.fullServerUrl(),s=As(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,c=new sn(s,i,EA(t,n),o);return c.errorHandler=tm(e),c}function TA(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function rm(t,e,n){let r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=TA(null,e)),r}function AA(t,e,n,r,s){let i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function c(){let W="";for(let Z=0;Z<2;Z++)W=W+Math.random().toString().slice(2);return W}let h=c();o["Content-Type"]="multipart/related; boundary="+h;let f=rm(e,r,s),m=em(f,n),_="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+m+`\r
--`+h+`\r
Content-Type: `+f.contentType+`\r
\r
`,I=`\r
--`+h+"--",v=ga.getBlob(_,r,I);if(v===null)throw z0();let x={name:f.fullPath},U=As(i,t.host,t._protocol),k="POST",z=t.maxUploadRetryTime,$=new sn(U,k,Pl(t,n),z);return $.urlParams=x,$.headers=o,$.body=v.uploadData(),$.errorHandler=bs(e),$}var dr=class{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}};function Ol(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Bt(!1)}return Bt(!!n&&(e||["active"]).indexOf(n)!==-1),n}function bA(t,e,n,r,s){let i=e.bucketOnlyServerUrl(),o=rm(e,r,s),c={name:o.fullPath},h=As(i,t.host,t._protocol),f="POST",m={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},_=em(o,n),I=t.maxUploadRetryTime;function v(U){Ol(U);let k;try{k=U.getResponseHeader("X-Goog-Upload-URL")}catch{Bt(!1)}return Bt(Ea(k)),k}let x=new sn(h,f,v,I);return x.urlParams=c,x.headers=m,x.body=_,x.errorHandler=bs(e),x}function yA(t,e,n,r){let s={"X-Goog-Upload-Command":"query"};function i(f){let m=Ol(f,["active","final"]),_=null;try{_=f.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Bt(!1)}_||Bt(!1);let I=Number(_);return Bt(!isNaN(I)),new dr(I,r.size(),m==="final")}let o="POST",c=t.maxUploadRetryTime,h=new sn(n,o,i,c);return h.headers=s,h.errorHandler=bs(e),h}var M0=256*1024;function IA(t,e,n,r,s,i,o,c){let h=new dr(0,0);if(o?(h.current=o.current,h.total=o.total):(h.current=0,h.total=r.size()),r.size()!==h.total)throw HT();let f=h.total-h.current,m=f;s>0&&(m=Math.min(m,s));let _=h.current,I=_+m,v="";m===0?v="finalize":f===m?v="upload, finalize":v="upload";let x={"X-Goog-Upload-Command":v,"X-Goog-Upload-Offset":`${h.current}`},U=r.slice(_,I);if(U===null)throw z0();function k(Z,Re){let ae=Ol(Z,["active","final"]),C=h.current+m,T=r.size(),y;return ae==="final"?y=Pl(e,i)(Z,Re):y=null,new dr(C,T,ae==="final",y)}let z="POST",$=e.maxUploadRetryTime,W=new sn(n,z,k,$);return W.headers=x,W.body=U.uploadData(),W.progressCallback=c||null,W.errorHandler=bs(t),W}var je={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Al(t){switch(t){case"running":case"pausing":case"canceling":return je.RUNNING;case"paused":return je.PAUSED;case"success":return je.SUCCESS;case"canceled":return je.CANCELED;case"error":return je.ERROR;default:return je.ERROR}}var Rl=class{constructor(e,n,r){if(WT(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{let i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}};function lr(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}var B0=null,Cl=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Sn.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Sn.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Sn.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw gs("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(let i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw gs("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw gs("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw gs("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw gs("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},Sl=class extends Cl{initXhr(){this.xhr_.responseType="text"}};function Cn(){return B0?B0():new Sl}var wl=class{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=Dl(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(fe.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let i=this.isExponentialBackoffExpired();if(W0(s.status,[]))if(i)s=G0();else{this.sleepTime=Math.max(this.sleepTime*2,OT),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(fe.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){let e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{let r=bA(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Cn,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((n,r)=>{let s=yA(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,Cn,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=M0*this._chunkMultiplier,n=new dr(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=IA(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(h){this._error=h,this._transition("error");return}let c=this._ref.storage._makeRequest(o,Cn,s,i,!1);this._request=c,c.getPromise().then(h=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(h.current),h.finalized?(this._metadata=h.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){M0*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{let r=nm(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Cn,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{let r=AA(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Cn,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=K0(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=Al(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){let i=new Rl(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Al(this._state)){case je.SUCCESS:lr(this._resolve.bind(null,this.snapshot))();break;case je.CANCELED:case je.ERROR:let n=this._reject;lr(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Al(this._state)){case je.RUNNING:case je.PAUSED:e.next&&lr(e.next.bind(e,this.snapshot))();break;case je.SUCCESS:e.complete&&lr(e.complete.bind(e))();break;case je.CANCELED:case je.ERROR:e.error&&lr(e.error.bind(e,this._error))();break;default:e.error&&lr(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var fr=class t{constructor(e,n){this._service=e,n instanceof ut?this._location=n:this._location=ut.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new ut(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return J0(this._location.path)}get storage(){return this._service}get parent(){let e=lA(this._location.path);if(e===null)return null;let n=new ut(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw KT(e)}};function RA(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new wl(t,new ga(e),n)}function CA(t){t._throwIfRoot("getMetadata");let e=nm(t.storage,t._location,Dl());return t.storage.makeRequestWithTokens(e,Cn)}function SA(t){t._throwIfRoot("getDownloadURL");let e=_A(t.storage,t._location,Dl());return t.storage.makeRequestWithTokens(e,Cn).then(n=>{if(n===null)throw qT();return n})}function wA(t,e){let n=hA(t._location.path,e),r=new ut(t._location.bucket,n);return new fr(t.storage,r)}function NA(t){return/^[A-Za-z]+:\/\//.test(t)}function vA(t,e){return new fr(t,e)}function sm(t,e){if(t instanceof Ts){let n=t;if(n._bucket==null)throw VT();let r=new fr(n,n._bucket);return e!=null?sm(r,e):r}else return e!==void 0?wA(t,e):t}function DA(t,e){if(e&&NA(e)){if(t instanceof Ts)return vA(t,e);throw bl("To use ref(service, url), the first argument must be a Storage instance.")}else return sm(t,e)}function F0(t,e){let n=e?.[q0];return n==null?null:ut.makeFromBucketSpec(n,t)}function PA(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:ii(s,t.app.options.projectId))}var Ts=class{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=H0,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DT,this._maxUploadRetryTime=PT,this._requests=new Set,s!=null?this._bucket=ut.makeFromBucketSpec(s,this._host):this._bucket=F0(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ut.makeFromBucketSpec(this._url,e):this._bucket=F0(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){k0("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){k0("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new fr(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new yl(j0());{let o=eA(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){let[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}},U0="@firebase/storage",V0="0.13.4";var im="storage";function xl(t,e,n){return t=Ce(t),RA(t,e,n)}function am(t){return t=Ce(t),CA(t)}function _a(t){return t=Ce(t),SA(t)}function ys(t,e){return t=Ce(t),DA(t,e)}function om(t=hi(),e){t=Ce(t);let r=ci(t,im).getImmediate({identifier:e}),s=si("storage");return s&&OA(r,...s),r}function OA(t,e,n,r={}){PA(t,e,n,r)}function xA(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Ts(n,r,s,e,li)}function LA(){fn(new it(im,xA,"PUBLIC").setMultipleInstances(!0)),St(U0,V0,""),St(U0,V0,"esm2017")}LA();var j=le(hg()),ee=le(Mn());B();M();function Je(t,e){(async()=>{let{default:{Result:n,SDKError:r}}=await import("./util-NVDJ5VUM.js"),s;try{s=await t()}catch(i){e(new n.Failure(new r.OtherException(i)));return}e(new n.Success(s))})()}B();M();B();M();B();M();B();M();var Ll=class{value;next;constructor(e){this.value=e}},Is=class{#e;#t;#n;constructor(){this.clear()}enqueue(e){let n=new Ll(e);this.#e?(this.#t.next=n,this.#t=n):(this.#e=n,this.#t=n),this.#n++}dequeue(){let e=this.#e;if(e)return this.#e=this.#e.next,this.#n--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#n=0}get size(){return this.#n}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}};function kl(t){if(!((Number.isInteger(t)||t===Number.POSITIVE_INFINITY)&&t>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");let e=new Is,n=0,r=()=>{n--,e.size>0&&e.dequeue()()},s=async(c,h,f)=>{n++;let m=(async()=>c(...f))();h(m);try{await m}catch{}r()},i=(c,h,f)=>{e.enqueue(s.bind(void 0,c,h,f)),(async()=>(await Promise.resolve(),n<t&&e.size>0&&e.dequeue()()))()},o=(c,...h)=>new Promise(f=>{i(c,f,h)});return Object.defineProperties(o,{activeCount:{get:()=>n},pendingCount:{get:()=>e.size},clearQueue:{value:()=>{e.clear()}}}),o}function MA(t,{getInitialState:e},n=browser.storage.local){let r=new Promise((x,U)=>n.get(t,k=>k[t]===void 0?e().then(z=>n.set({[t]:z},x)).catch(U):x())),s=()=>new Promise(x=>n.get(t,U=>x(U[t]??{}))),i=(x,U,k)=>new Promise(z=>n.set({[t]:{...x,[U]:k}},()=>z(x))),o=x=>new Promise(U=>n.set({[t]:x},U)),c=kl(1),h=async()=>r.then(()=>c(s)),f=x=>r.then(()=>c(s)).then(U=>U[x]),m=async x=>r.then(()=>c(()=>o(x))),_=async(x,U)=>r.then(()=>c(async()=>{let k=await s(),z=typeof U=="function"?U(k[x]):U,$=rd(id(Object),sd(Array.isArray));return typeof U!="function"&&$(z)&&$(k)?i(k,x,ad(k[x],z)):i(k,x,z)})),I=[],v=x=>(I.push(x),()=>{I=I.filter(U=>U!==x)});return browser.storage.onChanged.addListener(x=>{Object.keys(x).includes(t)&&h().then(U=>{I.forEach(k=>k(U))})}),{get:f,getAll:h,set:_,setAll:m,listen:v}}function Ta(t,{getInitialState:e}){return MA(t,{getInitialState:e})}var mr=Ta("logger",{getInitialState:async()=>({enableRequestLogging:!0,enableLogging:!0})}),cm={red:"#E06C75",green:"#98C379",yellow:"#E5C07B",blue:"#61AFEF",purple:"#C678DD",cyan:"#56B6C2",orange:"#e08d6c",lime:"#a9c379"},um=Object.values(cm),BA=t=>um[Array.from(t).map(e=>e.charCodeAt(0)).reduce((e,n)=>e+n,0)%um.length],sR=(t=10)=>Math.round(Math.random()*Number.MAX_SAFE_INTEGER).toString(16).slice(0,t),Aa=!0;mr.get("enableRequestLogging").then(t=>{t===!1&&(Aa=t)});function iR({hash:t,label:e,labelCSS:n,path:r,logInfo:s}){let i=performance.now();return()=>{}}var ba=!0;mr.get("enableLogging").then(t=>{ba=t});function ya(t,e="blue"){let n=(r,s)=>(...i)=>{ba&&console[r](t?`%c${t}:`:`%c${r[0].toUpperCase()}${r.slice(1)}:`,`color: ${cm[t?e:s]}; font-weight: bold;`,...i)};return{debug:n("debug","cyan"),info:n("info","green"),warn:n("warn","yellow"),error:n("error","red")}}globalThis.enableRequestLogging=async()=>{await mr.set("enableRequestLogging",!0),Aa=!0};globalThis.disableRequestLogging=async()=>{await mr.set("enableRequestLogging",!1),Aa=!1};globalThis.enableLogging=async()=>{await mr.set("enableLogging",!0),ba=!0};globalThis.disableLogging=async()=>{await mr.set("enableLogging",!1),ba=!1};B();M();B();M();function Ia(t){return{_ok:!0,value:t}}function Ra(t){return{_ok:!1,error:t}}function cR(t,e){return t._ok===!1?Ra(e(t.error)):t}function Ml(t,e){return t._ok===!0?t.value:e(t.error)}function lR(t){return t._ok}function hR(t){return!t._ok}async function lm(t){let{default:{Result:e}}=await import("./util-NVDJ5VUM.js");return t instanceof e.Success?Ia(t.value):t instanceof e.Failure?Ra(t.error):Ia(void 0)}function dR(t){return async(...e)=>{try{return Ia(await t(...e))}catch(n){return Ra(n)}}}function fR(t){return(...e)=>{try{return Ia(t(...e))}catch(n){return Ra(n)}}}function pr(t){return(...e)=>new Promise(n=>{let r=s=>lm(s).then(n);e.length===0?t(r):e.length===1?t(e[0],r):t(e[0],e[1],r)})}var TR=(t,e)=>Promise.all(t.map(e)).then(n=>n.flat());B();M();var Ca=le(Ct()),wn=class extends Ca.AbstractBoundaryMap{constructor(n){super();this.obj=n}entries(){return Object.entries(this.obj).map(([n,r])=>new Ca.BoundaryPair(n,r))}get(n){let r=this.obj[n];return r===void 0?null:r}hasKey(n){return!!this.obj[n]}keys(){return Object.keys(this.obj)}set(n,r){this.obj[n]=r}values(){return Object.values(this.obj)}};B();M();var hm=le(Ct()),Sa=class extends hm.BoundaryRecord{mapUnsupportedValue(e){throw new Error(`Conversion of ${e} is not supported.`)}};var Ft=ya("Firebase SDK Adapter"),Bl=class extends j.AbstractFirebaseTimestampAdapter{fromMillis(e){return Ae.fromMillis(e.asDouble)}now(){return Ae.now()}},Fl=class extends j.AbstractFirebaseFieldValueAdapter{increment(e){return x0(e)}},Ul=class extends j.AbstractFirebaseStorageAdapter{constructor(n){super();this.firebaseStorage=n;this.putBinaryContent=(n,r,s)=>{let i=new AbortController;return Je(async()=>{if(i.signal.aborted)return;let o=r.binaryContent.blob,c=ys(this.firebaseStorage,n),h=xl(c,o,{contentType:o.type});await new Promise((f,m)=>{let _=()=>{Ft.error("FirebaseStorage putFile upload canceled:"),h.cancel(),f()};i.signal.aborted&&_(),i.signal.addEventListener("abort",_);let I=h.on("state_changed",v=>{Ft.info("FirebaseStorage putBinaryContent upload state changed:",v)},v=>{Ft.error("FirebaseStorage putBinaryContent upload error:",v),I(),m(v)},()=>{Ft.info("FirebaseStorage putBinaryContent upload success"),_a(h.snapshot.ref).then(v=>{Ft.info("FirebaseStorage putBinaryContent file available at:",v),I(),f()})})})},s),()=>{i.abort()}}}delete(n,r){throw new Error("Method not implemented.")}getDownloadUrl(n,r){let s=ys(this.firebaseStorage,n);_a(s).then(i=>{console.info("getDownloadUrl",i),r(new ee.Result.Success(i))}).catch(i=>r(new ee.Result.Failure(new ee.SDKError.IO(i.message))))}getMetadata(n,r){let s=ys(this.firebaseStorage,n);am(s).then(i=>{let o=new j.FullMetadata(i.bucket,i.cacheControl,i.contentDisposition,i.contentEncoding,i.contentLanguage,i.contentType,new wn(i.customMetadata),i.fullPath,i.generation,i.md5Hash,i.metageneration,i.name,i.size,i.timeCreated,i.updated);r(new ee.Result.Success(o))}).catch(i=>{if(i instanceof Ke)switch(i.code){case"storage/object-not-found":case"storage/bucket-not-found":case"storage/project-not-found":r(new ee.Result.Failure(new ee.SDKError.ResourceNotFound("getMetadata",i.message)));return}r(new ee.Result.Failure(Ut(i)))})}putFile(n,r,s){let i=new AbortController;return Je(async()=>{if(i.signal.aborted)return;let o=(await pr(r.getSizeInBytes.bind(r))()).value,c=(await pr(r.getBytes.bind(r))(0,o)).value;if(i.signal.aborted)return;let h=r.mimeType.fullString,f=ys(this.firebaseStorage,n),m=xl(f,Buffer.from(c),{contentType:h});await new Promise((_,I)=>{let v=()=>{Ft.error("FirebaseStorage putFile upload canceled:"),m.cancel(),_()};i.signal.aborted&&v(),i.signal.addEventListener("abort",v);let x=m.on("state_changed",U=>{Ft.info("FirebaseStorage putFile upload state changed:",U)},U=>{Ft.error("FirebaseStorage putFile upload error:",U),x(),I(U)},()=>{Ft.info("FirebaseStorage Upload success"),_a(m.snapshot.ref).then(()=>{x(),_()})})})},s),()=>{i.abort()}}};function wa(t){return t.keys().reduce((e,n)=>({...e,[n]:FA(t.get(n))}),{})}function FA(t){return Array.isArray(t)?t.map(wa):t instanceof Ae||t instanceof tn?t:typeof t=="object"&&t!==null?wa(t):t}function UA(t){let e;switch(t.type){case"added":e=j.DocumentChangeType.Added;break;case"modified":e=j.DocumentChangeType.Modified;break;case"removed":e=j.DocumentChangeType.Removed;break;default:throw new Error("Unknown change type")}return e}var dm=t=>{switch(t){case j.DataSource.CACHE:return w0;case j.DataSource.SERVER:return N0;case j.DataSource.DEFAULT:return pl;default:return pl}},VA=t=>{switch(t){case j.DataSource.CACHE:return C0;case j.DataSource.SERVER:return S0;case j.DataSource.DEFAULT:return ml;default:return ml}},Ut=t=>{if(t instanceof Ke)switch(t.code){case"permission-denied":return new ee.SDKError.NotAuthorized(t.code,t.message);case"unavailable":return new ee.SDKError.ConnectionError(t.message);default:return new ee.SDKError.OtherException(t)}return new ee.SDKError.OtherException(t)},Na=class extends j.AbstractFirebaseService{constructor(n){super();this.auth=n}getStorage(){return new Ul(om(this.auth.app))}getAuth(){return new Hl(this.auth)}getFirestore(){return new Vl(d0(this.auth.app))}getTimestampFactory(){return new Bl}getFieldValueFactory(){return new Fl}},Vl=class extends j.FirebaseFirestoreService{constructor(n){super();this.firestore=n}deleteDocument(n,r,s){let i=rn(this.firestore,n),o=cr(i,r);P0(o).then(()=>s(new ee.Result.Success(void 0))).catch(c=>s(new ee.Result.Failure(Ut(c))))}observeDocument(n,r,s){let i=rn(this.firestore,n),o=cr(i,r);return gl(o,c=>{c.exists?s(new ee.Result.Success(new j.FirebaseFirestoreDocumentSnapshot.Exists(c.id,Rs(c.data()),new j.SnapshotRef(c)))):s(new ee.Result.Success(j.FirebaseFirestoreDocumentSnapshot.NotExists))},c=>s(new ee.Result.Failure(Ut(c))))}queryDocuments(n){let r=s=>{let{whereClauses:i}=s,o=h=>({property:h.property,operator:h.operator.op,value:h.value}),c=[];for(let h of i){let f=o(h);c.push(A0(f.property,f.operator,f.value))}for(let h of s.orderBy)c.push(b0(h.first,h.second.direction));s.limit!=null&&c.push(y0(s.limit));for(let h of s.bounds){let{first:f,second:m}=h;switch(m){case j.DocumentQueryBuilder.BoundType.StartAfter:c.push(hl(f));break;case j.DocumentQueryBuilder.BoundType.StartAt:c.push(ll(f));break;case j.DocumentQueryBuilder.BoundType.EndBefore:c.push(dl(f));break;case j.DocumentQueryBuilder.BoundType.EndAt:c.push(fl(f));break;default:throw new Error(`query bounding by ${m} not implemented`)}}for(let h of s.snapshotBounds){let{first:f,second:m}=h;switch(m){case j.DocumentQueryBuilder.BoundType.StartAfter:c.push(hl(f.get));break;case j.DocumentQueryBuilder.BoundType.StartAt:c.push(ll(f.get));break;case j.DocumentQueryBuilder.BoundType.EndBefore:c.push(dl(f.get));break;case j.DocumentQueryBuilder.BoundType.EndAt:c.push(fl(f.get));break;default:throw new Error(`query bounding by ${m} not implemented`)}}return T0(rn(this.firestore,n),...c)};return new j.DocumentQueryBuilder((s,i,o)=>{dm(i)(r(s)).then(h=>{let f=h.docs.map(m=>new j.FirebaseFirestoreDocumentSnapshot.Exists(m.id,Rs(m.data()),new j.SnapshotRef(m)));o(new ee.Result.Success(f))}).catch(h=>o(new ee.Result.Failure(Ut(h))))},(s,i)=>gl(r(s),o=>{class c extends j.AbstractFirebaseFirestoreQuerySnapshot{docChanges(m){return o.docChanges({includeMetadataChanges:!!m}).map(_=>{let I=UA(_);return new j.DocumentChange(I,new j.FirebaseFirestoreDocumentSnapshot.Exists(_.doc.id,Rs(_.doc.data()),new j.SnapshotRef(_.doc)),_.oldIndex,_.newIndex)})}}let h=new c;i(new ee.Result.Success(h))},o=>i(new ee.Result.Failure(new ee.SDKError.OtherMessage(o.message)))),(s,i)=>{O0(r(s)).then(c=>{i(new ee.Result.Success(c.data().count))}).catch(c=>i(new ee.Result.Failure(Ut(c))))})}updateDocument(n,r,s,i){let o=rn(this.firestore,n),c=cr(o,r);D0(c,wa(s)).then(()=>i(new ee.Result.Success(!0)),h=>i(new ee.Result.Failure(Ut(h))))}getCollection(n,r,s){let i=dm(r),o=rn(this.firestore,n);i(o).then(({docs:c})=>{let h=c.map(f=>new j.FirebaseFirestoreDocumentSnapshot.Exists(n+"/"+f.id,Rs(f.data()),new j.SnapshotRef(f)));s(new ee.Result.Success(h))})}getDocument(n,r,s,i){let o=VA(s),c=rn(this.firestore,n),h=cr(c,r);o(h).then(f=>{let m=f.data();i(m?new ee.Result.Success(new j.FirebaseFirestoreDocumentSnapshot.Exists(r,Rs(m),new j.SnapshotRef(f))):new ee.Result.Success(j.FirebaseFirestoreDocumentSnapshot.NotExists))}).catch(f=>{f.code==="unavailable"||f.code==="not-found"?i(new ee.Result.Failure(new ee.SDKError.ResourceNotFound(h,f.message))):i(new ee.Result.Failure(Ut(f)))})}setDocument(n,r,s,i,o){let c=rn(this.firestore,n),h=cr(c,r);v0(h,wa(s),{merge:i}).then(()=>o(new ee.Result.Success(!0)),f=>o(new ee.Result.Failure(Ut(f))))}},Hl=class extends j.AbstractFirebaseAuthService{constructor(n){super();this.auth=n}getCurrentUser(n){let r=this.auth.currentUser;if(r){let s=new j.FirebaseAuthUser(r.uid,r.isAnonymous,r.displayName,r.email),i=new ee.Result.Success(s);n(i);return}n(new ee.Result.Success(null))}observeCurrentUser(n){return this.auth.onAuthStateChanged(()=>{this.getCurrentUser(n)})}getCurrentUserIdentityToken(n){let r=this.auth.currentUser;r?r.getIdTokenResult().then(s=>n(new ee.Result.Success(new j.FirebaseAuthToken(s.token,parseInt(s.expirationTime))))).catch(s=>n(new ee.Result.Failure(Ut(s)))):n(new ee.Result.Success(null))}};function Rs(t){return new Sa(t)}B();M();B();M();B();M();B();M();B();M();B();M();var HA=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),he="",g;(function(t){t[t.EOF=-1]="EOF",t[t.NULL=0]="NULL",t[t.TABULATION=9]="TABULATION",t[t.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",t[t.LINE_FEED=10]="LINE_FEED",t[t.FORM_FEED=12]="FORM_FEED",t[t.SPACE=32]="SPACE",t[t.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",t[t.QUOTATION_MARK=34]="QUOTATION_MARK",t[t.NUMBER_SIGN=35]="NUMBER_SIGN",t[t.AMPERSAND=38]="AMPERSAND",t[t.APOSTROPHE=39]="APOSTROPHE",t[t.HYPHEN_MINUS=45]="HYPHEN_MINUS",t[t.SOLIDUS=47]="SOLIDUS",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",t[t.EQUALS_SIGN=61]="EQUALS_SIGN",t[t.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",t[t.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",t[t.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",t[t.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",t[t.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",t[t.GRAVE_ACCENT=96]="GRAVE_ACCENT",t[t.LATIN_SMALL_A=97]="LATIN_SMALL_A",t[t.LATIN_SMALL_F=102]="LATIN_SMALL_F",t[t.LATIN_SMALL_X=120]="LATIN_SMALL_X",t[t.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",t[t.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(g=g||(g={}));var Ge={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function va(t){return t>=55296&&t<=57343}function fm(t){return t>=56320&&t<=57343}function mm(t,e){return(t-55296)*1024+9216+e}function Da(t){return t!==32&&t!==10&&t!==13&&t!==9&&t!==12&&t>=1&&t<=31||t>=127&&t<=159}function Pa(t){return t>=64976&&t<=65007||HA.has(t)}B();M();var P;(function(t){t.controlCharacterInInputStream="control-character-in-input-stream",t.noncharacterInInputStream="noncharacter-in-input-stream",t.surrogateInInputStream="surrogate-in-input-stream",t.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",t.endTagWithAttributes="end-tag-with-attributes",t.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",t.unexpectedSolidusInTag="unexpected-solidus-in-tag",t.unexpectedNullCharacter="unexpected-null-character",t.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",t.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",t.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",t.missingEndTagName="missing-end-tag-name",t.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",t.unknownNamedCharacterReference="unknown-named-character-reference",t.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",t.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",t.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",t.eofBeforeTagName="eof-before-tag-name",t.eofInTag="eof-in-tag",t.missingAttributeValue="missing-attribute-value",t.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",t.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",t.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",t.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",t.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",t.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",t.missingDoctypePublicIdentifier="missing-doctype-public-identifier",t.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",t.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",t.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",t.cdataInHtmlContent="cdata-in-html-content",t.incorrectlyOpenedComment="incorrectly-opened-comment",t.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",t.eofInDoctype="eof-in-doctype",t.nestedComment="nested-comment",t.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",t.eofInComment="eof-in-comment",t.incorrectlyClosedComment="incorrectly-closed-comment",t.eofInCdata="eof-in-cdata",t.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",t.nullCharacterReference="null-character-reference",t.surrogateCharacterReference="surrogate-character-reference",t.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",t.controlCharacterReference="control-character-reference",t.noncharacterCharacterReference="noncharacter-character-reference",t.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",t.missingDoctypeName="missing-doctype-name",t.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",t.duplicateAttribute="duplicate-attribute",t.nonConformingDoctype="non-conforming-doctype",t.missingDoctype="missing-doctype",t.misplacedDoctype="misplaced-doctype",t.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",t.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",t.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",t.openElementsLeftAfterEof="open-elements-left-after-eof",t.abandonedHeadElementChild="abandoned-head-element-child",t.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",t.nestedNoscriptInHead="nested-noscript-in-head",t.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(P=P||(P={}));var GA=65536,Oa=class{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=GA,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e){let{line:n,col:r,offset:s}=this;return{code:e,startLine:n,endLine:n,startCol:r,endCol:r,startOffset:s,endOffset:s}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){let n=this.html.charCodeAt(this.pos+1);if(fm(n))return this.pos++,this._addGap(),mm(e,n)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,g.EOF;return this._err(P.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,n){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=n}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,n){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(n)return this.html.startsWith(e,this.pos);for(let r=0;r<e.length;r++)if((this.html.charCodeAt(this.pos+r)|32)!==e.charCodeAt(r))return!1;return!0}peek(e){let n=this.pos+e;if(n>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,g.EOF;let r=this.html.charCodeAt(n);return r===g.CARRIAGE_RETURN?g.LINE_FEED:r}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,g.EOF;let e=this.html.charCodeAt(this.pos);return e===g.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,g.LINE_FEED):e===g.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,va(e)&&(e=this._processSurrogate(e)),this.handler.onParseError===null||e>31&&e<127||e===g.LINE_FEED||e===g.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){Da(e)?this._err(P.controlCharacterInInputStream):Pa(e)&&this._err(P.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}};B();M();var ne;(function(t){t[t.CHARACTER=0]="CHARACTER",t[t.NULL_CHARACTER=1]="NULL_CHARACTER",t[t.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",t[t.START_TAG=3]="START_TAG",t[t.END_TAG=4]="END_TAG",t[t.COMMENT=5]="COMMENT",t[t.DOCTYPE=6]="DOCTYPE",t[t.EOF=7]="EOF",t[t.HIBERNATION=8]="HIBERNATION"})(ne=ne||(ne={}));function xa(t,e){for(let n=t.attrs.length-1;n>=0;n--)if(t.attrs[n].name===e)return t.attrs[n].value;return null}B();M();B();M();var _t=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0)));B();M();var pm=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));B();M();var ql,zA=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),gm=(ql=String.fromCodePoint)!==null&&ql!==void 0?ql:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function Em(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=zA.get(t))!==null&&e!==void 0?e:t}function Gl(t){return gm(Em(t))}var Ze;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.To_LOWER_BIT=32]="To_LOWER_BIT"})(Ze||(Ze={}));var Tt;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(Tt||(Tt={}));function _m(t){return function(n,r){let s="",i=0,o=0;for(;(o=n.indexOf("&",o))>=0;){if(s+=n.slice(i,o),i=o,o+=1,n.charCodeAt(o)===Ze.NUM){let _=o+1,I=10,v=n.charCodeAt(_);(v|Ze.To_LOWER_BIT)===Ze.LOWER_X&&(I=16,o+=1,_+=1);do v=n.charCodeAt(++o);while(v>=Ze.ZERO&&v<=Ze.NINE||I===16&&(v|Ze.To_LOWER_BIT)>=Ze.LOWER_A&&(v|Ze.To_LOWER_BIT)<=Ze.LOWER_F);if(_!==o){let x=n.substring(_,o),U=parseInt(x,I);if(n.charCodeAt(o)===Ze.SEMI)o+=1;else if(r)continue;s+=Gl(U),i=o}continue}let c=0,h=1,f=0,m=t[f];for(;o<n.length&&(f=Kl(t,m,f+1,n.charCodeAt(o)),!(f<0));o++,h++){m=t[f];let _=m&Tt.VALUE_LENGTH;if(_){(!r||n.charCodeAt(o)===Ze.SEMI)&&(c=f,h=0);let I=(_>>14)-1;if(I===0)break;f+=I}}if(c!==0){let _=(t[c]&Tt.VALUE_LENGTH)>>14;s+=_===1?String.fromCharCode(t[c]&~Tt.VALUE_LENGTH):_===2?String.fromCharCode(t[c+1]):String.fromCharCode(t[c+1],t[c+2]),i=o-h+1}}return s+n.slice(i)}}function Kl(t,e,n,r){let s=(e&Tt.BRANCH_LENGTH)>>7,i=e&Tt.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){let h=r-i;return h<0||h>=s?-1:t[n+h]-1}let o=n,c=o+s-1;for(;o<=c;){let h=o+c>>>1,f=t[h];if(f<r)o=h+1;else if(f>r)c=h-1;else return t[h+s]}return-1}var p2=_m(_t),g2=_m(pm);B();M();var L;(function(t){t.HTML="http://www.w3.org/1999/xhtml",t.MATHML="http://www.w3.org/1998/Math/MathML",t.SVG="http://www.w3.org/2000/svg",t.XLINK="http://www.w3.org/1999/xlink",t.XML="http://www.w3.org/XML/1998/namespace",t.XMLNS="http://www.w3.org/2000/xmlns/"})(L=L||(L={}));var At;(function(t){t.TYPE="type",t.ACTION="action",t.ENCODING="encoding",t.PROMPT="prompt",t.NAME="name",t.COLOR="color",t.FACE="face",t.SIZE="size"})(At=At||(At={}));var Be;(function(t){t.NO_QUIRKS="no-quirks",t.QUIRKS="quirks",t.LIMITED_QUIRKS="limited-quirks"})(Be=Be||(Be={}));var N;(function(t){t.A="a",t.ADDRESS="address",t.ANNOTATION_XML="annotation-xml",t.APPLET="applet",t.AREA="area",t.ARTICLE="article",t.ASIDE="aside",t.B="b",t.BASE="base",t.BASEFONT="basefont",t.BGSOUND="bgsound",t.BIG="big",t.BLOCKQUOTE="blockquote",t.BODY="body",t.BR="br",t.BUTTON="button",t.CAPTION="caption",t.CENTER="center",t.CODE="code",t.COL="col",t.COLGROUP="colgroup",t.DD="dd",t.DESC="desc",t.DETAILS="details",t.DIALOG="dialog",t.DIR="dir",t.DIV="div",t.DL="dl",t.DT="dt",t.EM="em",t.EMBED="embed",t.FIELDSET="fieldset",t.FIGCAPTION="figcaption",t.FIGURE="figure",t.FONT="font",t.FOOTER="footer",t.FOREIGN_OBJECT="foreignObject",t.FORM="form",t.FRAME="frame",t.FRAMESET="frameset",t.H1="h1",t.H2="h2",t.H3="h3",t.H4="h4",t.H5="h5",t.H6="h6",t.HEAD="head",t.HEADER="header",t.HGROUP="hgroup",t.HR="hr",t.HTML="html",t.I="i",t.IMG="img",t.IMAGE="image",t.INPUT="input",t.IFRAME="iframe",t.KEYGEN="keygen",t.LABEL="label",t.LI="li",t.LINK="link",t.LISTING="listing",t.MAIN="main",t.MALIGNMARK="malignmark",t.MARQUEE="marquee",t.MATH="math",t.MENU="menu",t.META="meta",t.MGLYPH="mglyph",t.MI="mi",t.MO="mo",t.MN="mn",t.MS="ms",t.MTEXT="mtext",t.NAV="nav",t.NOBR="nobr",t.NOFRAMES="noframes",t.NOEMBED="noembed",t.NOSCRIPT="noscript",t.OBJECT="object",t.OL="ol",t.OPTGROUP="optgroup",t.OPTION="option",t.P="p",t.PARAM="param",t.PLAINTEXT="plaintext",t.PRE="pre",t.RB="rb",t.RP="rp",t.RT="rt",t.RTC="rtc",t.RUBY="ruby",t.S="s",t.SCRIPT="script",t.SECTION="section",t.SELECT="select",t.SOURCE="source",t.SMALL="small",t.SPAN="span",t.STRIKE="strike",t.STRONG="strong",t.STYLE="style",t.SUB="sub",t.SUMMARY="summary",t.SUP="sup",t.TABLE="table",t.TBODY="tbody",t.TEMPLATE="template",t.TEXTAREA="textarea",t.TFOOT="tfoot",t.TD="td",t.TH="th",t.THEAD="thead",t.TITLE="title",t.TR="tr",t.TRACK="track",t.TT="tt",t.U="u",t.UL="ul",t.SVG="svg",t.VAR="var",t.WBR="wbr",t.XMP="xmp"})(N=N||(N={}));var u;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.A=1]="A",t[t.ADDRESS=2]="ADDRESS",t[t.ANNOTATION_XML=3]="ANNOTATION_XML",t[t.APPLET=4]="APPLET",t[t.AREA=5]="AREA",t[t.ARTICLE=6]="ARTICLE",t[t.ASIDE=7]="ASIDE",t[t.B=8]="B",t[t.BASE=9]="BASE",t[t.BASEFONT=10]="BASEFONT",t[t.BGSOUND=11]="BGSOUND",t[t.BIG=12]="BIG",t[t.BLOCKQUOTE=13]="BLOCKQUOTE",t[t.BODY=14]="BODY",t[t.BR=15]="BR",t[t.BUTTON=16]="BUTTON",t[t.CAPTION=17]="CAPTION",t[t.CENTER=18]="CENTER",t[t.CODE=19]="CODE",t[t.COL=20]="COL",t[t.COLGROUP=21]="COLGROUP",t[t.DD=22]="DD",t[t.DESC=23]="DESC",t[t.DETAILS=24]="DETAILS",t[t.DIALOG=25]="DIALOG",t[t.DIR=26]="DIR",t[t.DIV=27]="DIV",t[t.DL=28]="DL",t[t.DT=29]="DT",t[t.EM=30]="EM",t[t.EMBED=31]="EMBED",t[t.FIELDSET=32]="FIELDSET",t[t.FIGCAPTION=33]="FIGCAPTION",t[t.FIGURE=34]="FIGURE",t[t.FONT=35]="FONT",t[t.FOOTER=36]="FOOTER",t[t.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",t[t.FORM=38]="FORM",t[t.FRAME=39]="FRAME",t[t.FRAMESET=40]="FRAMESET",t[t.H1=41]="H1",t[t.H2=42]="H2",t[t.H3=43]="H3",t[t.H4=44]="H4",t[t.H5=45]="H5",t[t.H6=46]="H6",t[t.HEAD=47]="HEAD",t[t.HEADER=48]="HEADER",t[t.HGROUP=49]="HGROUP",t[t.HR=50]="HR",t[t.HTML=51]="HTML",t[t.I=52]="I",t[t.IMG=53]="IMG",t[t.IMAGE=54]="IMAGE",t[t.INPUT=55]="INPUT",t[t.IFRAME=56]="IFRAME",t[t.KEYGEN=57]="KEYGEN",t[t.LABEL=58]="LABEL",t[t.LI=59]="LI",t[t.LINK=60]="LINK",t[t.LISTING=61]="LISTING",t[t.MAIN=62]="MAIN",t[t.MALIGNMARK=63]="MALIGNMARK",t[t.MARQUEE=64]="MARQUEE",t[t.MATH=65]="MATH",t[t.MENU=66]="MENU",t[t.META=67]="META",t[t.MGLYPH=68]="MGLYPH",t[t.MI=69]="MI",t[t.MO=70]="MO",t[t.MN=71]="MN",t[t.MS=72]="MS",t[t.MTEXT=73]="MTEXT",t[t.NAV=74]="NAV",t[t.NOBR=75]="NOBR",t[t.NOFRAMES=76]="NOFRAMES",t[t.NOEMBED=77]="NOEMBED",t[t.NOSCRIPT=78]="NOSCRIPT",t[t.OBJECT=79]="OBJECT",t[t.OL=80]="OL",t[t.OPTGROUP=81]="OPTGROUP",t[t.OPTION=82]="OPTION",t[t.P=83]="P",t[t.PARAM=84]="PARAM",t[t.PLAINTEXT=85]="PLAINTEXT",t[t.PRE=86]="PRE",t[t.RB=87]="RB",t[t.RP=88]="RP",t[t.RT=89]="RT",t[t.RTC=90]="RTC",t[t.RUBY=91]="RUBY",t[t.S=92]="S",t[t.SCRIPT=93]="SCRIPT",t[t.SECTION=94]="SECTION",t[t.SELECT=95]="SELECT",t[t.SOURCE=96]="SOURCE",t[t.SMALL=97]="SMALL",t[t.SPAN=98]="SPAN",t[t.STRIKE=99]="STRIKE",t[t.STRONG=100]="STRONG",t[t.STYLE=101]="STYLE",t[t.SUB=102]="SUB",t[t.SUMMARY=103]="SUMMARY",t[t.SUP=104]="SUP",t[t.TABLE=105]="TABLE",t[t.TBODY=106]="TBODY",t[t.TEMPLATE=107]="TEMPLATE",t[t.TEXTAREA=108]="TEXTAREA",t[t.TFOOT=109]="TFOOT",t[t.TD=110]="TD",t[t.TH=111]="TH",t[t.THEAD=112]="THEAD",t[t.TITLE=113]="TITLE",t[t.TR=114]="TR",t[t.TRACK=115]="TRACK",t[t.TT=116]="TT",t[t.U=117]="U",t[t.UL=118]="UL",t[t.SVG=119]="SVG",t[t.VAR=120]="VAR",t[t.WBR=121]="WBR",t[t.XMP=122]="XMP"})(u=u||(u={}));var jA=new Map([[N.A,u.A],[N.ADDRESS,u.ADDRESS],[N.ANNOTATION_XML,u.ANNOTATION_XML],[N.APPLET,u.APPLET],[N.AREA,u.AREA],[N.ARTICLE,u.ARTICLE],[N.ASIDE,u.ASIDE],[N.B,u.B],[N.BASE,u.BASE],[N.BASEFONT,u.BASEFONT],[N.BGSOUND,u.BGSOUND],[N.BIG,u.BIG],[N.BLOCKQUOTE,u.BLOCKQUOTE],[N.BODY,u.BODY],[N.BR,u.BR],[N.BUTTON,u.BUTTON],[N.CAPTION,u.CAPTION],[N.CENTER,u.CENTER],[N.CODE,u.CODE],[N.COL,u.COL],[N.COLGROUP,u.COLGROUP],[N.DD,u.DD],[N.DESC,u.DESC],[N.DETAILS,u.DETAILS],[N.DIALOG,u.DIALOG],[N.DIR,u.DIR],[N.DIV,u.DIV],[N.DL,u.DL],[N.DT,u.DT],[N.EM,u.EM],[N.EMBED,u.EMBED],[N.FIELDSET,u.FIELDSET],[N.FIGCAPTION,u.FIGCAPTION],[N.FIGURE,u.FIGURE],[N.FONT,u.FONT],[N.FOOTER,u.FOOTER],[N.FOREIGN_OBJECT,u.FOREIGN_OBJECT],[N.FORM,u.FORM],[N.FRAME,u.FRAME],[N.FRAMESET,u.FRAMESET],[N.H1,u.H1],[N.H2,u.H2],[N.H3,u.H3],[N.H4,u.H4],[N.H5,u.H5],[N.H6,u.H6],[N.HEAD,u.HEAD],[N.HEADER,u.HEADER],[N.HGROUP,u.HGROUP],[N.HR,u.HR],[N.HTML,u.HTML],[N.I,u.I],[N.IMG,u.IMG],[N.IMAGE,u.IMAGE],[N.INPUT,u.INPUT],[N.IFRAME,u.IFRAME],[N.KEYGEN,u.KEYGEN],[N.LABEL,u.LABEL],[N.LI,u.LI],[N.LINK,u.LINK],[N.LISTING,u.LISTING],[N.MAIN,u.MAIN],[N.MALIGNMARK,u.MALIGNMARK],[N.MARQUEE,u.MARQUEE],[N.MATH,u.MATH],[N.MENU,u.MENU],[N.META,u.META],[N.MGLYPH,u.MGLYPH],[N.MI,u.MI],[N.MO,u.MO],[N.MN,u.MN],[N.MS,u.MS],[N.MTEXT,u.MTEXT],[N.NAV,u.NAV],[N.NOBR,u.NOBR],[N.NOFRAMES,u.NOFRAMES],[N.NOEMBED,u.NOEMBED],[N.NOSCRIPT,u.NOSCRIPT],[N.OBJECT,u.OBJECT],[N.OL,u.OL],[N.OPTGROUP,u.OPTGROUP],[N.OPTION,u.OPTION],[N.P,u.P],[N.PARAM,u.PARAM],[N.PLAINTEXT,u.PLAINTEXT],[N.PRE,u.PRE],[N.RB,u.RB],[N.RP,u.RP],[N.RT,u.RT],[N.RTC,u.RTC],[N.RUBY,u.RUBY],[N.S,u.S],[N.SCRIPT,u.SCRIPT],[N.SECTION,u.SECTION],[N.SELECT,u.SELECT],[N.SOURCE,u.SOURCE],[N.SMALL,u.SMALL],[N.SPAN,u.SPAN],[N.STRIKE,u.STRIKE],[N.STRONG,u.STRONG],[N.STYLE,u.STYLE],[N.SUB,u.SUB],[N.SUMMARY,u.SUMMARY],[N.SUP,u.SUP],[N.TABLE,u.TABLE],[N.TBODY,u.TBODY],[N.TEMPLATE,u.TEMPLATE],[N.TEXTAREA,u.TEXTAREA],[N.TFOOT,u.TFOOT],[N.TD,u.TD],[N.TH,u.TH],[N.THEAD,u.THEAD],[N.TITLE,u.TITLE],[N.TR,u.TR],[N.TRACK,u.TRACK],[N.TT,u.TT],[N.U,u.U],[N.UL,u.UL],[N.SVG,u.SVG],[N.VAR,u.VAR],[N.WBR,u.WBR],[N.XMP,u.XMP]]);function Nn(t){var e;return(e=jA.get(t))!==null&&e!==void 0?e:u.UNKNOWN}var H=u,Tm={[L.HTML]:new Set([H.ADDRESS,H.APPLET,H.AREA,H.ARTICLE,H.ASIDE,H.BASE,H.BASEFONT,H.BGSOUND,H.BLOCKQUOTE,H.BODY,H.BR,H.BUTTON,H.CAPTION,H.CENTER,H.COL,H.COLGROUP,H.DD,H.DETAILS,H.DIR,H.DIV,H.DL,H.DT,H.EMBED,H.FIELDSET,H.FIGCAPTION,H.FIGURE,H.FOOTER,H.FORM,H.FRAME,H.FRAMESET,H.H1,H.H2,H.H3,H.H4,H.H5,H.H6,H.HEAD,H.HEADER,H.HGROUP,H.HR,H.HTML,H.IFRAME,H.IMG,H.INPUT,H.LI,H.LINK,H.LISTING,H.MAIN,H.MARQUEE,H.MENU,H.META,H.NAV,H.NOEMBED,H.NOFRAMES,H.NOSCRIPT,H.OBJECT,H.OL,H.P,H.PARAM,H.PLAINTEXT,H.PRE,H.SCRIPT,H.SECTION,H.SELECT,H.SOURCE,H.STYLE,H.SUMMARY,H.TABLE,H.TBODY,H.TD,H.TEMPLATE,H.TEXTAREA,H.TFOOT,H.TH,H.THEAD,H.TITLE,H.TR,H.TRACK,H.UL,H.WBR,H.XMP]),[L.MATHML]:new Set([H.MI,H.MO,H.MN,H.MS,H.MTEXT,H.ANNOTATION_XML]),[L.SVG]:new Set([H.TITLE,H.FOREIGN_OBJECT,H.DESC]),[L.XLINK]:new Set,[L.XML]:new Set,[L.XMLNS]:new Set};function La(t){return t===H.H1||t===H.H2||t===H.H3||t===H.H4||t===H.H5||t===H.H6}var b2=new Set([N.STYLE,N.SCRIPT,N.XMP,N.IFRAME,N.NOEMBED,N.NOFRAMES,N.PLAINTEXT]);var WA=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),E;(function(t){t[t.DATA=0]="DATA",t[t.RCDATA=1]="RCDATA",t[t.RAWTEXT=2]="RAWTEXT",t[t.SCRIPT_DATA=3]="SCRIPT_DATA",t[t.PLAINTEXT=4]="PLAINTEXT",t[t.TAG_OPEN=5]="TAG_OPEN",t[t.END_TAG_OPEN=6]="END_TAG_OPEN",t[t.TAG_NAME=7]="TAG_NAME",t[t.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",t[t.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",t[t.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",t[t.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",t[t.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",t[t.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",t[t.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",t[t.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",t[t.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",t[t.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",t[t.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",t[t.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",t[t.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",t[t.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",t[t.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",t[t.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",t[t.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",t[t.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",t[t.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",t[t.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",t[t.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",t[t.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",t[t.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",t[t.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",t[t.BOGUS_COMMENT=40]="BOGUS_COMMENT",t[t.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",t[t.COMMENT_START=42]="COMMENT_START",t[t.COMMENT_START_DASH=43]="COMMENT_START_DASH",t[t.COMMENT=44]="COMMENT",t[t.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",t[t.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",t[t.COMMENT_END_DASH=49]="COMMENT_END_DASH",t[t.COMMENT_END=50]="COMMENT_END",t[t.COMMENT_END_BANG=51]="COMMENT_END_BANG",t[t.DOCTYPE=52]="DOCTYPE",t[t.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",t[t.DOCTYPE_NAME=54]="DOCTYPE_NAME",t[t.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",t[t.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",t[t.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",t[t.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",t[t.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",t[t.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",t[t.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",t[t.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",t[t.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",t[t.CDATA_SECTION=68]="CDATA_SECTION",t[t.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",t[t.CDATA_SECTION_END=70]="CDATA_SECTION_END",t[t.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",t[t.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",t[t.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",t[t.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",t[t.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",t[t.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",t[t.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",t[t.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(E||(E={}));var Fe={DATA:E.DATA,RCDATA:E.RCDATA,RAWTEXT:E.RAWTEXT,SCRIPT_DATA:E.SCRIPT_DATA,PLAINTEXT:E.PLAINTEXT,CDATA_SECTION:E.CDATA_SECTION};function Ss(t){return t>=g.DIGIT_0&&t<=g.DIGIT_9}function Cs(t){return t>=g.LATIN_CAPITAL_A&&t<=g.LATIN_CAPITAL_Z}function YA(t){return t>=g.LATIN_SMALL_A&&t<=g.LATIN_SMALL_Z}function an(t){return YA(t)||Cs(t)}function zl(t){return an(t)||Ss(t)}function bm(t){return t>=g.LATIN_CAPITAL_A&&t<=g.LATIN_CAPITAL_F}function ym(t){return t>=g.LATIN_SMALL_A&&t<=g.LATIN_SMALL_F}function $A(t){return Ss(t)||bm(t)||ym(t)}function ka(t){return t+32}function Im(t){return t===g.SPACE||t===g.LINE_FEED||t===g.TABULATION||t===g.FORM_FEED}function XA(t){return t===g.EQUALS_SIGN||zl(t)}function Am(t){return Im(t)||t===g.SOLIDUS||t===g.GREATER_THAN_SIGN}var ws=class{constructor(e,n){this.options=e,this.handler=n,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=E.DATA,this.returnState=E.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new Oa(n),this.currentLocation=this.getCurrentLocation(-1)}_err(e){var n,r;(r=(n=this.handler).onParseError)===null||r===void 0||r.call(n,this.preprocessor.getError(e))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;let e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||e?.())}write(e,n,r){this.active=!0,this.preprocessor.write(e,n),this._runParsingLoop(),this.paused||r?.()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(e){this.consumedAfterSnapshot-=e,this.preprocessor.retreat(e)}_reconsumeInState(e,n){this.state=e,this._callState(n)}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let n=0;n<e;n++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,n){return this.preprocessor.startsWith(e,n)?(this._advanceBy(e.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:ne.START_TAG,tagName:"",tagID:u.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:ne.END_TAG,tagName:"",tagID:u.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:ne.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:ne.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,n){this.currentCharacterToken={type:e,chars:n,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,n;let r=this.currentToken;if(xa(r,this.currentAttr.name)===null){if(r.attrs.push(this.currentAttr),r.location&&this.currentLocation){let s=(e=(n=r.location).attrs)!==null&&e!==void 0?e:n.attrs=Object.create(null);s[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(P.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){let e=this.currentToken;this.prepareToken(e),e.tagID=Nn(e.tagName),e.type===ne.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(P.endTagWithAttributes),e.selfClosing&&this._err(P.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case ne.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case ne.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case ne.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){let e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:ne.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,n){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==e)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=n;return}this._createCharacterToken(e,n)}_emitCodePoint(e){let n=Im(e)?ne.WHITESPACE_CHARACTER:e===g.NULL?ne.NULL_CHARACTER:ne.CHARACTER;this._appendCharToCurrentCharacterToken(n,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(ne.CHARACTER,e)}_matchNamedCharacterReference(e){let n=null,r=0,s=!1;for(let i=0,o=_t[0];i>=0&&(i=Kl(_t,o,i+1,e),!(i<0));e=this._consume()){r+=1,o=_t[i];let c=o&Tt.VALUE_LENGTH;if(c){let h=(c>>14)-1;if(e!==g.SEMICOLON&&this._isCharacterReferenceInAttribute()&&XA(this.preprocessor.peek(1))?(n=[g.AMPERSAND],i+=h):(n=h===0?[_t[i]&~Tt.VALUE_LENGTH]:h===1?[_t[++i]]:[_t[++i],_t[++i]],r=0,s=e!==g.SEMICOLON),h===0){this._consume();break}}}return this._unconsume(r),s&&!this.preprocessor.endOfChunkHit&&this._err(P.missingSemicolonAfterCharacterReference),this._unconsume(1),n}_isCharacterReferenceInAttribute(){return this.returnState===E.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===E.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===E.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case E.DATA:{this._stateData(e);break}case E.RCDATA:{this._stateRcdata(e);break}case E.RAWTEXT:{this._stateRawtext(e);break}case E.SCRIPT_DATA:{this._stateScriptData(e);break}case E.PLAINTEXT:{this._statePlaintext(e);break}case E.TAG_OPEN:{this._stateTagOpen(e);break}case E.END_TAG_OPEN:{this._stateEndTagOpen(e);break}case E.TAG_NAME:{this._stateTagName(e);break}case E.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(e);break}case E.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(e);break}case E.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(e);break}case E.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(e);break}case E.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(e);break}case E.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(e);break}case E.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(e);break}case E.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(e);break}case E.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(e);break}case E.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(e);break}case E.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(e);break}case E.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(e);break}case E.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(e);break}case E.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(e);break}case E.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(e);break}case E.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(e);break}case E.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(e);break}case E.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(e);break}case E.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(e);break}case E.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(e);break}case E.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(e);break}case E.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(e);break}case E.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(e);break}case E.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(e);break}case E.ATTRIBUTE_NAME:{this._stateAttributeName(e);break}case E.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(e);break}case E.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(e);break}case E.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(e);break}case E.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(e);break}case E.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(e);break}case E.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(e);break}case E.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(e);break}case E.BOGUS_COMMENT:{this._stateBogusComment(e);break}case E.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(e);break}case E.COMMENT_START:{this._stateCommentStart(e);break}case E.COMMENT_START_DASH:{this._stateCommentStartDash(e);break}case E.COMMENT:{this._stateComment(e);break}case E.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(e);break}case E.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(e);break}case E.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(e);break}case E.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(e);break}case E.COMMENT_END_DASH:{this._stateCommentEndDash(e);break}case E.COMMENT_END:{this._stateCommentEnd(e);break}case E.COMMENT_END_BANG:{this._stateCommentEndBang(e);break}case E.DOCTYPE:{this._stateDoctype(e);break}case E.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(e);break}case E.DOCTYPE_NAME:{this._stateDoctypeName(e);break}case E.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(e);break}case E.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(e);break}case E.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(e);break}case E.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(e);break}case E.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(e);break}case E.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(e);break}case E.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break}case E.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(e);break}case E.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(e);break}case E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(e);break}case E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(e);break}case E.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(e);break}case E.BOGUS_DOCTYPE:{this._stateBogusDoctype(e);break}case E.CDATA_SECTION:{this._stateCdataSection(e);break}case E.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(e);break}case E.CDATA_SECTION_END:{this._stateCdataSectionEnd(e);break}case E.CHARACTER_REFERENCE:{this._stateCharacterReference(e);break}case E.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(e);break}case E.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(e);break}case E.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(e);break}case E.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(e);break}case E.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(e);break}case E.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(e);break}case E.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(e);break}default:throw new Error("Unknown state")}}_stateData(e){switch(e){case g.LESS_THAN_SIGN:{this.state=E.TAG_OPEN;break}case g.AMPERSAND:{this.returnState=E.DATA,this.state=E.CHARACTER_REFERENCE;break}case g.NULL:{this._err(P.unexpectedNullCharacter),this._emitCodePoint(e);break}case g.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case g.AMPERSAND:{this.returnState=E.RCDATA,this.state=E.CHARACTER_REFERENCE;break}case g.LESS_THAN_SIGN:{this.state=E.RCDATA_LESS_THAN_SIGN;break}case g.NULL:{this._err(P.unexpectedNullCharacter),this._emitChars(he);break}case g.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case g.LESS_THAN_SIGN:{this.state=E.RAWTEXT_LESS_THAN_SIGN;break}case g.NULL:{this._err(P.unexpectedNullCharacter),this._emitChars(he);break}case g.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case g.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_LESS_THAN_SIGN;break}case g.NULL:{this._err(P.unexpectedNullCharacter),this._emitChars(he);break}case g.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case g.NULL:{this._err(P.unexpectedNullCharacter),this._emitChars(he);break}case g.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateTagOpen(e){if(an(e))this._createStartTagToken(),this.state=E.TAG_NAME,this._stateTagName(e);else switch(e){case g.EXCLAMATION_MARK:{this.state=E.MARKUP_DECLARATION_OPEN;break}case g.SOLIDUS:{this.state=E.END_TAG_OPEN;break}case g.QUESTION_MARK:{this._err(P.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=E.BOGUS_COMMENT,this._stateBogusComment(e);break}case g.EOF:{this._err(P.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(P.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=E.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(an(e))this._createEndTagToken(),this.state=E.TAG_NAME,this._stateTagName(e);else switch(e){case g.GREATER_THAN_SIGN:{this._err(P.missingEndTagName),this.state=E.DATA;break}case g.EOF:{this._err(P.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(P.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=E.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:{this.state=E.BEFORE_ATTRIBUTE_NAME;break}case g.SOLIDUS:{this.state=E.SELF_CLOSING_START_TAG;break}case g.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentTagToken();break}case g.NULL:{this._err(P.unexpectedNullCharacter),n.tagName+=he;break}case g.EOF:{this._err(P.eofInTag),this._emitEOFToken();break}default:n.tagName+=String.fromCodePoint(Cs(e)?ka(e):e)}}_stateRcdataLessThanSign(e){e===g.SOLIDUS?this.state=E.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=E.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){an(e)?(this.state=E.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=E.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();let n=this.currentToken;switch(n.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=E.BEFORE_ATTRIBUTE_NAME,!1;case g.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=E.SELF_CLOSING_START_TAG,!1;case g.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=E.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=E.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===g.SOLIDUS?this.state=E.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=E.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){an(e)?(this.state=E.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=E.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=E.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case g.SOLIDUS:{this.state=E.SCRIPT_DATA_END_TAG_OPEN;break}case g.EXCLAMATION_MARK:{this.state=E.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=E.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){an(e)?(this.state=E.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=E.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=E.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===g.HYPHEN_MINUS?(this.state=E.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=E.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===g.HYPHEN_MINUS?(this.state=E.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=E.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case g.HYPHEN_MINUS:{this.state=E.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case g.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case g.NULL:{this._err(P.unexpectedNullCharacter),this._emitChars(he);break}case g.EOF:{this._err(P.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case g.HYPHEN_MINUS:{this.state=E.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case g.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case g.NULL:{this._err(P.unexpectedNullCharacter),this.state=E.SCRIPT_DATA_ESCAPED,this._emitChars(he);break}case g.EOF:{this._err(P.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=E.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case g.HYPHEN_MINUS:{this._emitChars("-");break}case g.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case g.GREATER_THAN_SIGN:{this.state=E.SCRIPT_DATA,this._emitChars(">");break}case g.NULL:{this._err(P.unexpectedNullCharacter),this.state=E.SCRIPT_DATA_ESCAPED,this._emitChars(he);break}case g.EOF:{this._err(P.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=E.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===g.SOLIDUS?this.state=E.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:an(e)?(this._emitChars("<"),this.state=E.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=E.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){an(e)?(this.state=E.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=E.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=E.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(Ge.SCRIPT,!1)&&Am(this.preprocessor.peek(Ge.SCRIPT.length))){this._emitCodePoint(e);for(let n=0;n<Ge.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=E.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case g.HYPHEN_MINUS:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case g.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case g.NULL:{this._err(P.unexpectedNullCharacter),this._emitChars(he);break}case g.EOF:{this._err(P.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case g.HYPHEN_MINUS:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case g.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case g.NULL:{this._err(P.unexpectedNullCharacter),this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(he);break}case g.EOF:{this._err(P.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case g.HYPHEN_MINUS:{this._emitChars("-");break}case g.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case g.GREATER_THAN_SIGN:{this.state=E.SCRIPT_DATA,this._emitChars(">");break}case g.NULL:{this._err(P.unexpectedNullCharacter),this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(he);break}case g.EOF:{this._err(P.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===g.SOLIDUS?(this.state=E.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(Ge.SCRIPT,!1)&&Am(this.preprocessor.peek(Ge.SCRIPT.length))){this._emitCodePoint(e);for(let n=0;n<Ge.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=E.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.SOLIDUS:case g.GREATER_THAN_SIGN:case g.EOF:{this.state=E.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case g.EQUALS_SIGN:{this._err(P.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=E.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=E.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:case g.SOLIDUS:case g.GREATER_THAN_SIGN:case g.EOF:{this._leaveAttrName(),this.state=E.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case g.EQUALS_SIGN:{this._leaveAttrName(),this.state=E.BEFORE_ATTRIBUTE_VALUE;break}case g.QUOTATION_MARK:case g.APOSTROPHE:case g.LESS_THAN_SIGN:{this._err(P.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break}case g.NULL:{this._err(P.unexpectedNullCharacter),this.currentAttr.name+=he;break}default:this.currentAttr.name+=String.fromCodePoint(Cs(e)?ka(e):e)}}_stateAfterAttributeName(e){switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.SOLIDUS:{this.state=E.SELF_CLOSING_START_TAG;break}case g.EQUALS_SIGN:{this.state=E.BEFORE_ATTRIBUTE_VALUE;break}case g.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentTagToken();break}case g.EOF:{this._err(P.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=E.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.QUOTATION_MARK:{this.state=E.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case g.APOSTROPHE:{this.state=E.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case g.GREATER_THAN_SIGN:{this._err(P.missingAttributeValue),this.state=E.DATA,this.emitCurrentTagToken();break}default:this.state=E.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case g.QUOTATION_MARK:{this.state=E.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case g.AMPERSAND:{this.returnState=E.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=E.CHARACTER_REFERENCE;break}case g.NULL:{this._err(P.unexpectedNullCharacter),this.currentAttr.value+=he;break}case g.EOF:{this._err(P.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case g.APOSTROPHE:{this.state=E.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case g.AMPERSAND:{this.returnState=E.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=E.CHARACTER_REFERENCE;break}case g.NULL:{this._err(P.unexpectedNullCharacter),this.currentAttr.value+=he;break}case g.EOF:{this._err(P.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:{this._leaveAttrValue(),this.state=E.BEFORE_ATTRIBUTE_NAME;break}case g.AMPERSAND:{this.returnState=E.ATTRIBUTE_VALUE_UNQUOTED,this.state=E.CHARACTER_REFERENCE;break}case g.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=E.DATA,this.emitCurrentTagToken();break}case g.NULL:{this._err(P.unexpectedNullCharacter),this.currentAttr.value+=he;break}case g.QUOTATION_MARK:case g.APOSTROPHE:case g.LESS_THAN_SIGN:case g.EQUALS_SIGN:case g.GRAVE_ACCENT:{this._err(P.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break}case g.EOF:{this._err(P.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:{this._leaveAttrValue(),this.state=E.BEFORE_ATTRIBUTE_NAME;break}case g.SOLIDUS:{this._leaveAttrValue(),this.state=E.SELF_CLOSING_START_TAG;break}case g.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=E.DATA,this.emitCurrentTagToken();break}case g.EOF:{this._err(P.eofInTag),this._emitEOFToken();break}default:this._err(P.missingWhitespaceBetweenAttributes),this.state=E.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case g.GREATER_THAN_SIGN:{let n=this.currentToken;n.selfClosing=!0,this.state=E.DATA,this.emitCurrentTagToken();break}case g.EOF:{this._err(P.eofInTag),this._emitEOFToken();break}default:this._err(P.unexpectedSolidusInTag),this.state=E.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){let n=this.currentToken;switch(e){case g.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentComment(n);break}case g.EOF:{this.emitCurrentComment(n),this._emitEOFToken();break}case g.NULL:{this._err(P.unexpectedNullCharacter),n.data+=he;break}default:n.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(Ge.DASH_DASH,!0)?(this._createCommentToken(Ge.DASH_DASH.length+1),this.state=E.COMMENT_START):this._consumeSequenceIfMatch(Ge.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Ge.DOCTYPE.length+1),this.state=E.DOCTYPE):this._consumeSequenceIfMatch(Ge.CDATA_START,!0)?this.inForeignNode?this.state=E.CDATA_SECTION:(this._err(P.cdataInHtmlContent),this._createCommentToken(Ge.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=E.BOGUS_COMMENT):this._ensureHibernation()||(this._err(P.incorrectlyOpenedComment),this._createCommentToken(2),this.state=E.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case g.HYPHEN_MINUS:{this.state=E.COMMENT_START_DASH;break}case g.GREATER_THAN_SIGN:{this._err(P.abruptClosingOfEmptyComment),this.state=E.DATA;let n=this.currentToken;this.emitCurrentComment(n);break}default:this.state=E.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){let n=this.currentToken;switch(e){case g.HYPHEN_MINUS:{this.state=E.COMMENT_END;break}case g.GREATER_THAN_SIGN:{this._err(P.abruptClosingOfEmptyComment),this.state=E.DATA,this.emitCurrentComment(n);break}case g.EOF:{this._err(P.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=E.COMMENT,this._stateComment(e)}}_stateComment(e){let n=this.currentToken;switch(e){case g.HYPHEN_MINUS:{this.state=E.COMMENT_END_DASH;break}case g.LESS_THAN_SIGN:{n.data+="<",this.state=E.COMMENT_LESS_THAN_SIGN;break}case g.NULL:{this._err(P.unexpectedNullCharacter),n.data+=he;break}case g.EOF:{this._err(P.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){let n=this.currentToken;switch(e){case g.EXCLAMATION_MARK:{n.data+="!",this.state=E.COMMENT_LESS_THAN_SIGN_BANG;break}case g.LESS_THAN_SIGN:{n.data+="<";break}default:this.state=E.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===g.HYPHEN_MINUS?this.state=E.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=E.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===g.HYPHEN_MINUS?this.state=E.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=E.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==g.GREATER_THAN_SIGN&&e!==g.EOF&&this._err(P.nestedComment),this.state=E.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){let n=this.currentToken;switch(e){case g.HYPHEN_MINUS:{this.state=E.COMMENT_END;break}case g.EOF:{this._err(P.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=E.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){let n=this.currentToken;switch(e){case g.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentComment(n);break}case g.EXCLAMATION_MARK:{this.state=E.COMMENT_END_BANG;break}case g.HYPHEN_MINUS:{n.data+="-";break}case g.EOF:{this._err(P.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--",this.state=E.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){let n=this.currentToken;switch(e){case g.HYPHEN_MINUS:{n.data+="--!",this.state=E.COMMENT_END_DASH;break}case g.GREATER_THAN_SIGN:{this._err(P.incorrectlyClosedComment),this.state=E.DATA,this.emitCurrentComment(n);break}case g.EOF:{this._err(P.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--!",this.state=E.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:{this.state=E.BEFORE_DOCTYPE_NAME;break}case g.GREATER_THAN_SIGN:{this.state=E.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break}case g.EOF:{this._err(P.eofInDoctype),this._createDoctypeToken(null);let n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(P.missingWhitespaceBeforeDoctypeName),this.state=E.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(Cs(e))this._createDoctypeToken(String.fromCharCode(ka(e))),this.state=E.DOCTYPE_NAME;else switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.NULL:{this._err(P.unexpectedNullCharacter),this._createDoctypeToken(he),this.state=E.DOCTYPE_NAME;break}case g.GREATER_THAN_SIGN:{this._err(P.missingDoctypeName),this._createDoctypeToken(null);let n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=E.DATA;break}case g.EOF:{this._err(P.eofInDoctype),this._createDoctypeToken(null);let n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=E.DOCTYPE_NAME}}_stateDoctypeName(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:{this.state=E.AFTER_DOCTYPE_NAME;break}case g.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentDoctype(n);break}case g.NULL:{this._err(P.unexpectedNullCharacter),n.name+=he;break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.name+=String.fromCodePoint(Cs(e)?ka(e):e)}}_stateAfterDoctypeName(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentDoctype(n);break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Ge.PUBLIC,!1)?this.state=E.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Ge.SYSTEM,!1)?this.state=E.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(P.invalidCharacterSequenceAfterDoctypeName),n.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:{this.state=E.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case g.QUOTATION_MARK:{this._err(P.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=E.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case g.APOSTROPHE:{this._err(P.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=E.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case g.GREATER_THAN_SIGN:{this._err(P.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=E.DATA,this.emitCurrentDoctype(n);break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(P.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.QUOTATION_MARK:{n.publicId="",this.state=E.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case g.APOSTROPHE:{n.publicId="",this.state=E.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case g.GREATER_THAN_SIGN:{this._err(P.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=E.DATA,this.emitCurrentDoctype(n);break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(P.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){let n=this.currentToken;switch(e){case g.QUOTATION_MARK:{this.state=E.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case g.NULL:{this._err(P.unexpectedNullCharacter),n.publicId+=he;break}case g.GREATER_THAN_SIGN:{this._err(P.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=E.DATA;break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){let n=this.currentToken;switch(e){case g.APOSTROPHE:{this.state=E.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case g.NULL:{this._err(P.unexpectedNullCharacter),n.publicId+=he;break}case g.GREATER_THAN_SIGN:{this._err(P.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=E.DATA;break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:{this.state=E.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case g.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentDoctype(n);break}case g.QUOTATION_MARK:{this._err(P.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case g.APOSTROPHE:{this._err(P.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(P.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=E.DATA;break}case g.QUOTATION_MARK:{n.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case g.APOSTROPHE:{n.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(P.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:{this.state=E.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case g.QUOTATION_MARK:{this._err(P.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case g.APOSTROPHE:{this._err(P.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case g.GREATER_THAN_SIGN:{this._err(P.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=E.DATA,this.emitCurrentDoctype(n);break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(P.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.QUOTATION_MARK:{n.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case g.APOSTROPHE:{n.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case g.GREATER_THAN_SIGN:{this._err(P.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=E.DATA,this.emitCurrentDoctype(n);break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(P.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){let n=this.currentToken;switch(e){case g.QUOTATION_MARK:{this.state=E.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case g.NULL:{this._err(P.unexpectedNullCharacter),n.systemId+=he;break}case g.GREATER_THAN_SIGN:{this._err(P.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=E.DATA;break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){let n=this.currentToken;switch(e){case g.APOSTROPHE:{this.state=E.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case g.NULL:{this._err(P.unexpectedNullCharacter),n.systemId+=he;break}case g.GREATER_THAN_SIGN:{this._err(P.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=E.DATA;break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){let n=this.currentToken;switch(e){case g.SPACE:case g.LINE_FEED:case g.TABULATION:case g.FORM_FEED:break;case g.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=E.DATA;break}case g.EOF:{this._err(P.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(P.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){let n=this.currentToken;switch(e){case g.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=E.DATA;break}case g.NULL:{this._err(P.unexpectedNullCharacter);break}case g.EOF:{this.emitCurrentDoctype(n),this._emitEOFToken();break}default:}}_stateCdataSection(e){switch(e){case g.RIGHT_SQUARE_BRACKET:{this.state=E.CDATA_SECTION_BRACKET;break}case g.EOF:{this._err(P.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===g.RIGHT_SQUARE_BRACKET?this.state=E.CDATA_SECTION_END:(this._emitChars("]"),this.state=E.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case g.GREATER_THAN_SIGN:{this.state=E.DATA;break}case g.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=E.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(e){e===g.NUMBER_SIGN?this.state=E.NUMERIC_CHARACTER_REFERENCE:zl(e)?(this.state=E.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(e)):(this._flushCodePointConsumedAsCharacterReference(g.AMPERSAND),this._reconsumeInState(this.returnState,e))}_stateNamedCharacterReference(e){let n=this._matchNamedCharacterReference(e);if(!this._ensureHibernation())if(n){for(let r=0;r<n.length;r++)this._flushCodePointConsumedAsCharacterReference(n[r]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(g.AMPERSAND),this.state=E.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(e){zl(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===g.SEMICOLON&&this._err(P.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,e))}_stateNumericCharacterReference(e){this.charRefCode=0,e===g.LATIN_SMALL_X||e===g.LATIN_CAPITAL_X?this.state=E.HEXADEMICAL_CHARACTER_REFERENCE_START:Ss(e)?(this.state=E.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(e)):(this._err(P.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(g.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(g.NUMBER_SIGN),this._reconsumeInState(this.returnState,e))}_stateHexademicalCharacterReferenceStart(e){$A(e)?(this.state=E.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(e)):(this._err(P.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(g.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(g.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference(e){bm(e)?this.charRefCode=this.charRefCode*16+e-55:ym(e)?this.charRefCode=this.charRefCode*16+e-87:Ss(e)?this.charRefCode=this.charRefCode*16+e-48:e===g.SEMICOLON?this.state=E.NUMERIC_CHARACTER_REFERENCE_END:(this._err(P.missingSemicolonAfterCharacterReference),this.state=E.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(e))}_stateDecimalCharacterReference(e){Ss(e)?this.charRefCode=this.charRefCode*10+e-48:e===g.SEMICOLON?this.state=E.NUMERIC_CHARACTER_REFERENCE_END:(this._err(P.missingSemicolonAfterCharacterReference),this.state=E.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(e))}_stateNumericCharacterReferenceEnd(e){if(this.charRefCode===g.NULL)this._err(P.nullCharacterReference),this.charRefCode=g.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(P.characterReferenceOutsideUnicodeRange),this.charRefCode=g.REPLACEMENT_CHARACTER;else if(va(this.charRefCode))this._err(P.surrogateCharacterReference),this.charRefCode=g.REPLACEMENT_CHARACTER;else if(Pa(this.charRefCode))this._err(P.noncharacterCharacterReference);else if(Da(this.charRefCode)||this.charRefCode===g.CARRIAGE_RETURN){this._err(P.controlCharacterReference);let n=WA.get(this.charRefCode);n!==void 0&&(this.charRefCode=n)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,e)}};B();M();var Cm=new Set([u.DD,u.DT,u.LI,u.OPTGROUP,u.OPTION,u.P,u.RB,u.RP,u.RT,u.RTC]),Rm=new Set([...Cm,u.CAPTION,u.COLGROUP,u.TBODY,u.TD,u.TFOOT,u.TH,u.THEAD,u.TR]),Ma=new Map([[u.APPLET,L.HTML],[u.CAPTION,L.HTML],[u.HTML,L.HTML],[u.MARQUEE,L.HTML],[u.OBJECT,L.HTML],[u.TABLE,L.HTML],[u.TD,L.HTML],[u.TEMPLATE,L.HTML],[u.TH,L.HTML],[u.ANNOTATION_XML,L.MATHML],[u.MI,L.MATHML],[u.MN,L.MATHML],[u.MO,L.MATHML],[u.MS,L.MATHML],[u.MTEXT,L.MATHML],[u.DESC,L.SVG],[u.FOREIGN_OBJECT,L.SVG],[u.TITLE,L.SVG]]),JA=[u.H1,u.H2,u.H3,u.H4,u.H5,u.H6],ZA=[u.TR,u.TEMPLATE,u.HTML],e1=[u.TBODY,u.TFOOT,u.THEAD,u.TEMPLATE,u.HTML],t1=[u.TABLE,u.TEMPLATE,u.HTML],n1=[u.TD,u.TH],Ba=class{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,n,r){this.treeAdapter=n,this.handler=r,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=u.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===u.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===L.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,n){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=n,this.currentTagId=n,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,n,!0)}pop(){let e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,n){let r=this._indexOf(e);this.items[r]=n,r===this.stackTop&&(this.current=n)}insertAfter(e,n,r){let s=this._indexOf(e)+1;this.items.splice(s,0,n),this.tagIDs.splice(s,0,r),this.stackTop++,s===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,s===this.stackTop)}popUntilTagNamePopped(e){let n=this.stackTop+1;do n=this.tagIDs.lastIndexOf(e,n-1);while(n>0&&this.treeAdapter.getNamespaceURI(this.items[n])!==L.HTML);this.shortenToLength(n<0?0:n)}shortenToLength(e){for(;this.stackTop>=e;){let n=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(n,this.stackTop<e)}}popUntilElementPopped(e){let n=this._indexOf(e);this.shortenToLength(n<0?0:n)}popUntilPopped(e,n){let r=this._indexOfTagNames(e,n);this.shortenToLength(r<0?0:r)}popUntilNumberedHeaderPopped(){this.popUntilPopped(JA,L.HTML)}popUntilTableCellPopped(){this.popUntilPopped(n1,L.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,n){for(let r=this.stackTop;r>=0;r--)if(e.includes(this.tagIDs[r])&&this.treeAdapter.getNamespaceURI(this.items[r])===n)return r;return-1}clearBackTo(e,n){let r=this._indexOfTagNames(e,n);this.shortenToLength(r+1)}clearBackToTableContext(){this.clearBackTo(t1,L.HTML)}clearBackToTableBodyContext(){this.clearBackTo(e1,L.HTML)}clearBackToTableRowContext(){this.clearBackTo(ZA,L.HTML)}remove(e){let n=this._indexOf(e);n>=0&&(n===this.stackTop?this.pop():(this.items.splice(n,1),this.tagIDs.splice(n,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===u.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){let n=this._indexOf(e)-1;return n>=0?this.items[n]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===u.HTML}hasInScope(e){for(let n=this.stackTop;n>=0;n--){let r=this.tagIDs[n],s=this.treeAdapter.getNamespaceURI(this.items[n]);if(r===e&&s===L.HTML)return!0;if(Ma.get(r)===s)return!1}return!0}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){let n=this.tagIDs[e],r=this.treeAdapter.getNamespaceURI(this.items[e]);if(La(n)&&r===L.HTML)return!0;if(Ma.get(n)===r)return!1}return!0}hasInListItemScope(e){for(let n=this.stackTop;n>=0;n--){let r=this.tagIDs[n],s=this.treeAdapter.getNamespaceURI(this.items[n]);if(r===e&&s===L.HTML)return!0;if((r===u.UL||r===u.OL)&&s===L.HTML||Ma.get(r)===s)return!1}return!0}hasInButtonScope(e){for(let n=this.stackTop;n>=0;n--){let r=this.tagIDs[n],s=this.treeAdapter.getNamespaceURI(this.items[n]);if(r===e&&s===L.HTML)return!0;if(r===u.BUTTON&&s===L.HTML||Ma.get(r)===s)return!1}return!0}hasInTableScope(e){for(let n=this.stackTop;n>=0;n--){let r=this.tagIDs[n];if(this.treeAdapter.getNamespaceURI(this.items[n])===L.HTML){if(r===e)return!0;if(r===u.TABLE||r===u.TEMPLATE||r===u.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--){let n=this.tagIDs[e];if(this.treeAdapter.getNamespaceURI(this.items[e])===L.HTML){if(n===u.TBODY||n===u.THEAD||n===u.TFOOT)return!0;if(n===u.TABLE||n===u.HTML)return!1}}return!0}hasInSelectScope(e){for(let n=this.stackTop;n>=0;n--){let r=this.tagIDs[n];if(this.treeAdapter.getNamespaceURI(this.items[n])===L.HTML){if(r===e)return!0;if(r!==u.OPTION&&r!==u.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;Cm.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;Rm.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==e&&Rm.has(this.currentTagId);)this.pop()}};B();M();var rt;(function(t){t[t.Marker=0]="Marker",t[t.Element=1]="Element"})(rt=rt||(rt={}));var Sm={type:rt.Marker},Fa=class{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,n){let r=[],s=n.length,i=this.treeAdapter.getTagName(e),o=this.treeAdapter.getNamespaceURI(e);for(let c=0;c<this.entries.length;c++){let h=this.entries[c];if(h.type===rt.Marker)break;let{element:f}=h;if(this.treeAdapter.getTagName(f)===i&&this.treeAdapter.getNamespaceURI(f)===o){let m=this.treeAdapter.getAttrList(f);m.length===s&&r.push({idx:c,attrs:m})}}return r}_ensureNoahArkCondition(e){if(this.entries.length<3)return;let n=this.treeAdapter.getAttrList(e),r=this._getNoahArkConditionCandidates(e,n);if(r.length<3)return;let s=new Map(n.map(o=>[o.name,o.value])),i=0;for(let o=0;o<r.length;o++){let c=r[o];c.attrs.every(h=>s.get(h.name)===h.value)&&(i+=1,i>=3&&this.entries.splice(c.idx,1))}}insertMarker(){this.entries.unshift(Sm)}pushElement(e,n){this._ensureNoahArkCondition(e),this.entries.unshift({type:rt.Element,element:e,token:n})}insertElementAfterBookmark(e,n){let r=this.entries.indexOf(this.bookmark);this.entries.splice(r,0,{type:rt.Element,element:e,token:n})}removeEntry(e){let n=this.entries.indexOf(e);n>=0&&this.entries.splice(n,1)}clearToLastMarker(){let e=this.entries.indexOf(Sm);e>=0?this.entries.splice(0,e+1):this.entries.length=0}getElementEntryInScopeWithTagName(e){let n=this.entries.find(r=>r.type===rt.Marker||this.treeAdapter.getTagName(r.element)===e);return n&&n.type===rt.Element?n:null}getElementEntry(e){return this.entries.find(n=>n.type===rt.Element&&n.element===e)}};B();M();function wm(t){return{nodeName:"#text",value:t,parentNode:null}}var Vt={createDocument(){return{nodeName:"#document",mode:Be.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(t,e,n){return{nodeName:t,tagName:t,attrs:n,namespaceURI:e,childNodes:[],parentNode:null}},createCommentNode(t){return{nodeName:"#comment",data:t,parentNode:null}},appendChild(t,e){t.childNodes.push(e),e.parentNode=t},insertBefore(t,e,n){let r=t.childNodes.indexOf(n);t.childNodes.splice(r,0,e),e.parentNode=t},setTemplateContent(t,e){t.content=e},getTemplateContent(t){return t.content},setDocumentType(t,e,n,r){let s=t.childNodes.find(i=>i.nodeName==="#documentType");if(s)s.name=e,s.publicId=n,s.systemId=r;else{let i={nodeName:"#documentType",name:e,publicId:n,systemId:r,parentNode:null};Vt.appendChild(t,i)}},setDocumentMode(t,e){t.mode=e},getDocumentMode(t){return t.mode},detachNode(t){if(t.parentNode){let e=t.parentNode.childNodes.indexOf(t);t.parentNode.childNodes.splice(e,1),t.parentNode=null}},insertText(t,e){if(t.childNodes.length>0){let n=t.childNodes[t.childNodes.length-1];if(Vt.isTextNode(n)){n.value+=e;return}}Vt.appendChild(t,wm(e))},insertTextBefore(t,e,n){let r=t.childNodes[t.childNodes.indexOf(n)-1];r&&Vt.isTextNode(r)?r.value+=e:Vt.insertBefore(t,wm(e),n)},adoptAttributes(t,e){let n=new Set(t.attrs.map(r=>r.name));for(let r=0;r<e.length;r++)n.has(e[r].name)||t.attrs.push(e[r])},getFirstChild(t){return t.childNodes[0]},getChildNodes(t){return t.childNodes},getParentNode(t){return t.parentNode},getAttrList(t){return t.attrs},getTagName(t){return t.tagName},getNamespaceURI(t){return t.namespaceURI},getTextNodeContent(t){return t.value},getCommentNodeContent(t){return t.data},getDocumentTypeNodeName(t){return t.name},getDocumentTypeNodePublicId(t){return t.publicId},getDocumentTypeNodeSystemId(t){return t.systemId},isTextNode(t){return t.nodeName==="#text"},isCommentNode(t){return t.nodeName==="#comment"},isDocumentTypeNode(t){return t.nodeName==="#documentType"},isElementNode(t){return Object.prototype.hasOwnProperty.call(t,"tagName")},setNodeSourceCodeLocation(t,e){t.sourceCodeLocation=e},getNodeSourceCodeLocation(t){return t.sourceCodeLocation},updateNodeSourceCodeLocation(t,e){t.sourceCodeLocation={...t.sourceCodeLocation,...e}}};B();M();var vm="html",r1="about:legacy-compat",s1="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",Dm=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],i1=[...Dm,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],a1=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),Pm=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],o1=[...Pm,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function Nm(t,e){return e.some(n=>t.startsWith(n))}function Om(t){return t.name===vm&&t.publicId===null&&(t.systemId===null||t.systemId===r1)}function xm(t){if(t.name!==vm)return Be.QUIRKS;let{systemId:e}=t;if(e&&e.toLowerCase()===s1)return Be.QUIRKS;let{publicId:n}=t;if(n!==null){if(n=n.toLowerCase(),a1.has(n))return Be.QUIRKS;let r=e===null?i1:Dm;if(Nm(n,r))return Be.QUIRKS;if(r=e===null?Pm:o1,Nm(n,r))return Be.LIMITED_QUIRKS}return Be.NO_QUIRKS}B();M();var Lm={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},c1="definitionurl",l1="definitionURL",h1=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(t=>[t.toLowerCase(),t])),d1=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:L.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:L.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:L.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:L.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:L.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:L.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:L.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:L.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:L.XML}],["xml:space",{prefix:"xml",name:"space",namespace:L.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:L.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:L.XMLNS}]]),f1=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(t=>[t.toLowerCase(),t])),m1=new Set([u.B,u.BIG,u.BLOCKQUOTE,u.BODY,u.BR,u.CENTER,u.CODE,u.DD,u.DIV,u.DL,u.DT,u.EM,u.EMBED,u.H1,u.H2,u.H3,u.H4,u.H5,u.H6,u.HEAD,u.HR,u.I,u.IMG,u.LI,u.LISTING,u.MENU,u.META,u.NOBR,u.OL,u.P,u.PRE,u.RUBY,u.S,u.SMALL,u.SPAN,u.STRONG,u.STRIKE,u.SUB,u.SUP,u.TABLE,u.TT,u.U,u.UL,u.VAR]);function km(t){let e=t.tagID;return e===u.FONT&&t.attrs.some(({name:r})=>r===At.COLOR||r===At.SIZE||r===At.FACE)||m1.has(e)}function jl(t){for(let e=0;e<t.attrs.length;e++)if(t.attrs[e].name===c1){t.attrs[e].name=l1;break}}function Ql(t){for(let e=0;e<t.attrs.length;e++){let n=h1.get(t.attrs[e].name);n!=null&&(t.attrs[e].name=n)}}function Ua(t){for(let e=0;e<t.attrs.length;e++){let n=d1.get(t.attrs[e].name);n&&(t.attrs[e].prefix=n.prefix,t.attrs[e].name=n.name,t.attrs[e].namespace=n.namespace)}}function Mm(t){let e=f1.get(t.tagName);e!=null&&(t.tagName=e,t.tagID=Nn(t.tagName))}function p1(t,e){return e===L.MATHML&&(t===u.MI||t===u.MO||t===u.MN||t===u.MS||t===u.MTEXT)}function g1(t,e,n){if(e===L.MATHML&&t===u.ANNOTATION_XML){for(let r=0;r<n.length;r++)if(n[r].name===At.ENCODING){let s=n[r].value.toLowerCase();return s===Lm.TEXT_HTML||s===Lm.APPLICATION_XML}}return e===L.SVG&&(t===u.FOREIGN_OBJECT||t===u.DESC||t===u.TITLE)}function Bm(t,e,n,r){return(!r||r===L.HTML)&&g1(t,e,n)||(!r||r===L.MATHML)&&p1(t,e)}var E1="hidden",_1=8,T1=3,A;(function(t){t[t.INITIAL=0]="INITIAL",t[t.BEFORE_HTML=1]="BEFORE_HTML",t[t.BEFORE_HEAD=2]="BEFORE_HEAD",t[t.IN_HEAD=3]="IN_HEAD",t[t.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",t[t.AFTER_HEAD=5]="AFTER_HEAD",t[t.IN_BODY=6]="IN_BODY",t[t.TEXT=7]="TEXT",t[t.IN_TABLE=8]="IN_TABLE",t[t.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",t[t.IN_CAPTION=10]="IN_CAPTION",t[t.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",t[t.IN_TABLE_BODY=12]="IN_TABLE_BODY",t[t.IN_ROW=13]="IN_ROW",t[t.IN_CELL=14]="IN_CELL",t[t.IN_SELECT=15]="IN_SELECT",t[t.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",t[t.IN_TEMPLATE=17]="IN_TEMPLATE",t[t.AFTER_BODY=18]="AFTER_BODY",t[t.IN_FRAMESET=19]="IN_FRAMESET",t[t.AFTER_FRAMESET=20]="AFTER_FRAMESET",t[t.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",t[t.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(A||(A={}));var A1={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},qm=new Set([u.TABLE,u.TBODY,u.TFOOT,u.THEAD,u.TR]),Um={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Vt,onParseError:null},ks=class{constructor(e,n,r=null,s=null){this.fragmentContext=r,this.scriptHandler=s,this.currentToken=null,this.stopped=!1,this.insertionMode=A.INITIAL,this.originalInsertionMode=A.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...Um,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=n??this.treeAdapter.createDocument(),this.tokenizer=new ws(this.options,this),this.activeFormattingElements=new Fa(this.treeAdapter),this.fragmentContextID=r?Nn(this.treeAdapter.getTagName(r)):u.UNKNOWN,this._setContextModes(r??this.document,this.fragmentContextID),this.openElements=new Ba(this.document,this.treeAdapter,this)}static parse(e,n){let r=new this(n);return r.tokenizer.write(e,!0),r.document}static getFragmentParser(e,n){let r={...Um,...n};e??(e=r.treeAdapter.createElement(N.TEMPLATE,L.HTML,[]));let s=r.treeAdapter.createElement("documentmock",L.HTML,[]),i=new this(r,s,e);return i.fragmentContextID===u.TEMPLATE&&i.tmplInsertionModeStack.unshift(A.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){let e=this.treeAdapter.getFirstChild(this.document),n=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,n),n}_err(e,n,r){var s;if(!this.onParseError)return;let i=(s=e.location)!==null&&s!==void 0?s:A1,o={code:n,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:r?i.startLine:i.endLine,endCol:r?i.startCol:i.endCol,endOffset:r?i.startOffset:i.endOffset};this.onParseError(o)}onItemPush(e,n,r){var s,i;(i=(s=this.treeAdapter).onItemPush)===null||i===void 0||i.call(s,e),r&&this.openElements.stackTop>0&&this._setContextModes(e,n)}onItemPop(e,n){var r,s;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),(s=(r=this.treeAdapter).onItemPop)===null||s===void 0||s.call(r,e,this.openElements.current),n){let i,o;this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,o=this.fragmentContextID):{current:i,currentTagId:o}=this.openElements,this._setContextModes(i,o)}}_setContextModes(e,n){let r=e===this.document||this.treeAdapter.getNamespaceURI(e)===L.HTML;this.currentNotInHTML=!r,this.tokenizer.inForeignNode=!r&&!this._isIntegrationPoint(n,e)}_switchToTextParsing(e,n){this._insertElement(e,L.HTML),this.tokenizer.state=n,this.originalInsertionMode=this.insertionMode,this.insertionMode=A.TEXT}switchToPlaintextParsing(){this.insertionMode=A.TEXT,this.originalInsertionMode=A.IN_BODY,this.tokenizer.state=Fe.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===N.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==L.HTML))switch(this.fragmentContextID){case u.TITLE:case u.TEXTAREA:{this.tokenizer.state=Fe.RCDATA;break}case u.STYLE:case u.XMP:case u.IFRAME:case u.NOEMBED:case u.NOFRAMES:case u.NOSCRIPT:{this.tokenizer.state=Fe.RAWTEXT;break}case u.SCRIPT:{this.tokenizer.state=Fe.SCRIPT_DATA;break}case u.PLAINTEXT:{this.tokenizer.state=Fe.PLAINTEXT;break}default:}}_setDocumentType(e){let n=e.name||"",r=e.publicId||"",s=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,n,r,s),e.location){let o=this.treeAdapter.getChildNodes(this.document).find(c=>this.treeAdapter.isDocumentTypeNode(c));o&&this.treeAdapter.setNodeSourceCodeLocation(o,e.location)}}_attachElementToTree(e,n){if(this.options.sourceCodeLocationInfo){let r=n&&{...n,startTag:n};this.treeAdapter.setNodeSourceCodeLocation(e,r)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{let r=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(r,e)}}_appendElement(e,n){let r=this.treeAdapter.createElement(e.tagName,n,e.attrs);this._attachElementToTree(r,e.location)}_insertElement(e,n){let r=this.treeAdapter.createElement(e.tagName,n,e.attrs);this._attachElementToTree(r,e.location),this.openElements.push(r,e.tagID)}_insertFakeElement(e,n){let r=this.treeAdapter.createElement(e,L.HTML,[]);this._attachElementToTree(r,null),this.openElements.push(r,n)}_insertTemplate(e){let n=this.treeAdapter.createElement(e.tagName,L.HTML,e.attrs),r=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(n,r),this._attachElementToTree(n,e.location),this.openElements.push(n,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(r,null)}_insertFakeRootElement(){let e=this.treeAdapter.createElement(N.HTML,L.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,u.HTML)}_appendCommentNode(e,n){let r=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(n,r),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(r,e.location)}_insertCharacters(e){let n,r;if(this._shouldFosterParentOnInsertion()?({parent:n,beforeElement:r}=this._findFosterParentingLocation(),r?this.treeAdapter.insertTextBefore(n,e.chars,r):this.treeAdapter.insertText(n,e.chars)):(n=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(n,e.chars)),!e.location)return;let s=this.treeAdapter.getChildNodes(n),i=r?s.lastIndexOf(r):s.length,o=s[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(o)){let{endLine:h,endCol:f,endOffset:m}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(o,{endLine:h,endCol:f,endOffset:m})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(o,e.location)}_adoptNodes(e,n){for(let r=this.treeAdapter.getFirstChild(e);r;r=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(r),this.treeAdapter.appendChild(n,r)}_setEndLocation(e,n){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&n.location){let r=n.location,s=this.treeAdapter.getTagName(e),i=n.type===ne.END_TAG&&s===n.tagName?{endTag:{...r},endLine:r.endLine,endCol:r.endCol,endOffset:r.endOffset}:{endLine:r.startLine,endCol:r.startCol,endOffset:r.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,i)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let n,r;return this.openElements.stackTop===0&&this.fragmentContext?(n=this.fragmentContext,r=this.fragmentContextID):{current:n,currentTagId:r}=this.openElements,e.tagID===u.SVG&&this.treeAdapter.getTagName(n)===N.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(n)===L.MATHML?!1:this.tokenizer.inForeignNode||(e.tagID===u.MGLYPH||e.tagID===u.MALIGNMARK)&&!this._isIntegrationPoint(r,n,L.HTML)}_processToken(e){switch(e.type){case ne.CHARACTER:{this.onCharacter(e);break}case ne.NULL_CHARACTER:{this.onNullCharacter(e);break}case ne.COMMENT:{this.onComment(e);break}case ne.DOCTYPE:{this.onDoctype(e);break}case ne.START_TAG:{this._processStartTag(e);break}case ne.END_TAG:{this.onEndTag(e);break}case ne.EOF:{this.onEof(e);break}case ne.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(e);break}}}_isIntegrationPoint(e,n,r){let s=this.treeAdapter.getNamespaceURI(n),i=this.treeAdapter.getAttrList(n);return Bm(e,s,i,r)}_reconstructActiveFormattingElements(){let e=this.activeFormattingElements.entries.length;if(e){let n=this.activeFormattingElements.entries.findIndex(s=>s.type===rt.Marker||this.openElements.contains(s.element)),r=n<0?e-1:n-1;for(let s=r;s>=0;s--){let i=this.activeFormattingElements.entries[s];this._insertElement(i.token,this.treeAdapter.getNamespaceURI(i.element)),i.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=A.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(u.P),this.openElements.popUntilTagNamePopped(u.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case u.TR:{this.insertionMode=A.IN_ROW;return}case u.TBODY:case u.THEAD:case u.TFOOT:{this.insertionMode=A.IN_TABLE_BODY;return}case u.CAPTION:{this.insertionMode=A.IN_CAPTION;return}case u.COLGROUP:{this.insertionMode=A.IN_COLUMN_GROUP;return}case u.TABLE:{this.insertionMode=A.IN_TABLE;return}case u.BODY:{this.insertionMode=A.IN_BODY;return}case u.FRAMESET:{this.insertionMode=A.IN_FRAMESET;return}case u.SELECT:{this._resetInsertionModeForSelect(e);return}case u.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case u.HTML:{this.insertionMode=this.headElement?A.AFTER_HEAD:A.BEFORE_HEAD;return}case u.TD:case u.TH:{if(e>0){this.insertionMode=A.IN_CELL;return}break}case u.HEAD:{if(e>0){this.insertionMode=A.IN_HEAD;return}break}}this.insertionMode=A.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let n=e-1;n>0;n--){let r=this.openElements.tagIDs[n];if(r===u.TEMPLATE)break;if(r===u.TABLE){this.insertionMode=A.IN_SELECT_IN_TABLE;return}}this.insertionMode=A.IN_SELECT}_isElementCausesFosterParenting(e){return qm.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){let n=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case u.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(n)===L.HTML)return{parent:this.treeAdapter.getTemplateContent(n),beforeElement:null};break}case u.TABLE:{let r=this.treeAdapter.getParentNode(n);return r?{parent:r,beforeElement:n}:{parent:this.openElements.items[e-1],beforeElement:null}}default:}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){let n=this._findFosterParentingLocation();n.beforeElement?this.treeAdapter.insertBefore(n.parent,e,n.beforeElement):this.treeAdapter.appendChild(n.parent,e)}_isSpecialElement(e,n){let r=this.treeAdapter.getNamespaceURI(e);return Tm[r].has(n)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){$b(this,e);return}switch(this.insertionMode){case A.INITIAL:{Ns(this,e);break}case A.BEFORE_HTML:{Ds(this,e);break}case A.BEFORE_HEAD:{Ps(this,e);break}case A.IN_HEAD:{Os(this,e);break}case A.IN_HEAD_NO_SCRIPT:{xs(this,e);break}case A.AFTER_HEAD:{Ls(this,e);break}case A.IN_BODY:case A.IN_CAPTION:case A.IN_CELL:case A.IN_TEMPLATE:{Km(this,e);break}case A.TEXT:case A.IN_SELECT:case A.IN_SELECT_IN_TABLE:{this._insertCharacters(e);break}case A.IN_TABLE:case A.IN_TABLE_BODY:case A.IN_ROW:{Wl(this,e);break}case A.IN_TABLE_TEXT:{$m(this,e);break}case A.IN_COLUMN_GROUP:{Ha(this,e);break}case A.AFTER_BODY:{qa(this,e);break}case A.AFTER_AFTER_BODY:{Va(this,e);break}default:}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Yb(this,e);return}switch(this.insertionMode){case A.INITIAL:{Ns(this,e);break}case A.BEFORE_HTML:{Ds(this,e);break}case A.BEFORE_HEAD:{Ps(this,e);break}case A.IN_HEAD:{Os(this,e);break}case A.IN_HEAD_NO_SCRIPT:{xs(this,e);break}case A.AFTER_HEAD:{Ls(this,e);break}case A.TEXT:{this._insertCharacters(e);break}case A.IN_TABLE:case A.IN_TABLE_BODY:case A.IN_ROW:{Wl(this,e);break}case A.IN_COLUMN_GROUP:{Ha(this,e);break}case A.AFTER_BODY:{qa(this,e);break}case A.AFTER_AFTER_BODY:{Va(this,e);break}default:}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML){Yl(this,e);return}switch(this.insertionMode){case A.INITIAL:case A.BEFORE_HTML:case A.BEFORE_HEAD:case A.IN_HEAD:case A.IN_HEAD_NO_SCRIPT:case A.AFTER_HEAD:case A.IN_BODY:case A.IN_TABLE:case A.IN_CAPTION:case A.IN_COLUMN_GROUP:case A.IN_TABLE_BODY:case A.IN_ROW:case A.IN_CELL:case A.IN_SELECT:case A.IN_SELECT_IN_TABLE:case A.IN_TEMPLATE:case A.IN_FRAMESET:case A.AFTER_FRAMESET:{Yl(this,e);break}case A.IN_TABLE_TEXT:{vs(this,e);break}case A.AFTER_BODY:{w1(this,e);break}case A.AFTER_AFTER_BODY:case A.AFTER_AFTER_FRAMESET:{N1(this,e);break}default:}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case A.INITIAL:{v1(this,e);break}case A.BEFORE_HEAD:case A.IN_HEAD:case A.IN_HEAD_NO_SCRIPT:case A.AFTER_HEAD:{this._err(e,P.misplacedDoctype);break}case A.IN_TABLE_TEXT:{vs(this,e);break}default:}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,P.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?Xb(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case A.INITIAL:{Ns(this,e);break}case A.BEFORE_HTML:{D1(this,e);break}case A.BEFORE_HEAD:{O1(this,e);break}case A.IN_HEAD:{ct(this,e);break}case A.IN_HEAD_NO_SCRIPT:{k1(this,e);break}case A.AFTER_HEAD:{B1(this,e);break}case A.IN_BODY:{Ue(this,e);break}case A.IN_TABLE:{gr(this,e);break}case A.IN_TABLE_TEXT:{vs(this,e);break}case A.IN_CAPTION:{xb(this,e);break}case A.IN_COLUMN_GROUP:{Zl(this,e);break}case A.IN_TABLE_BODY:{za(this,e);break}case A.IN_ROW:{ja(this,e);break}case A.IN_CELL:{Mb(this,e);break}case A.IN_SELECT:{Zm(this,e);break}case A.IN_SELECT_IN_TABLE:{Fb(this,e);break}case A.IN_TEMPLATE:{Vb(this,e);break}case A.AFTER_BODY:{qb(this,e);break}case A.IN_FRAMESET:{Gb(this,e);break}case A.AFTER_FRAMESET:{zb(this,e);break}case A.AFTER_AFTER_BODY:{Qb(this,e);break}case A.AFTER_AFTER_FRAMESET:{Wb(this,e);break}default:}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?Jb(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case A.INITIAL:{Ns(this,e);break}case A.BEFORE_HTML:{P1(this,e);break}case A.BEFORE_HEAD:{x1(this,e);break}case A.IN_HEAD:{L1(this,e);break}case A.IN_HEAD_NO_SCRIPT:{M1(this,e);break}case A.AFTER_HEAD:{F1(this,e);break}case A.IN_BODY:{Ka(this,e);break}case A.TEXT:{Ib(this,e);break}case A.IN_TABLE:{Ms(this,e);break}case A.IN_TABLE_TEXT:{vs(this,e);break}case A.IN_CAPTION:{Lb(this,e);break}case A.IN_COLUMN_GROUP:{kb(this,e);break}case A.IN_TABLE_BODY:{$l(this,e);break}case A.IN_ROW:{Jm(this,e);break}case A.IN_CELL:{Bb(this,e);break}case A.IN_SELECT:{ep(this,e);break}case A.IN_SELECT_IN_TABLE:{Ub(this,e);break}case A.IN_TEMPLATE:{Hb(this,e);break}case A.AFTER_BODY:{np(this,e);break}case A.IN_FRAMESET:{Kb(this,e);break}case A.AFTER_FRAMESET:{jb(this,e);break}case A.AFTER_AFTER_BODY:{Va(this,e);break}default:}}onEof(e){switch(this.insertionMode){case A.INITIAL:{Ns(this,e);break}case A.BEFORE_HTML:{Ds(this,e);break}case A.BEFORE_HEAD:{Ps(this,e);break}case A.IN_HEAD:{Os(this,e);break}case A.IN_HEAD_NO_SCRIPT:{xs(this,e);break}case A.AFTER_HEAD:{Ls(this,e);break}case A.IN_BODY:case A.IN_TABLE:case A.IN_CAPTION:case A.IN_COLUMN_GROUP:case A.IN_TABLE_BODY:case A.IN_ROW:case A.IN_CELL:case A.IN_SELECT:case A.IN_SELECT_IN_TABLE:{Wm(this,e);break}case A.TEXT:{Rb(this,e);break}case A.IN_TABLE_TEXT:{vs(this,e);break}case A.IN_TEMPLATE:{tp(this,e);break}case A.AFTER_BODY:case A.IN_FRAMESET:case A.AFTER_FRAMESET:case A.AFTER_AFTER_BODY:case A.AFTER_AFTER_FRAMESET:{Jl(this,e);break}default:}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===g.LINE_FEED)){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(e);return}switch(this.insertionMode){case A.IN_HEAD:case A.IN_HEAD_NO_SCRIPT:case A.AFTER_HEAD:case A.TEXT:case A.IN_COLUMN_GROUP:case A.IN_SELECT:case A.IN_SELECT_IN_TABLE:case A.IN_FRAMESET:case A.AFTER_FRAMESET:{this._insertCharacters(e);break}case A.IN_BODY:case A.IN_CAPTION:case A.IN_CELL:case A.IN_TEMPLATE:case A.AFTER_BODY:case A.AFTER_AFTER_BODY:case A.AFTER_AFTER_FRAMESET:{Gm(this,e);break}case A.IN_TABLE:case A.IN_TABLE_BODY:case A.IN_ROW:{Wl(this,e);break}case A.IN_TABLE_TEXT:{Ym(this,e);break}default:}}};function b1(t,e){let n=t.activeFormattingElements.getElementEntryInScopeWithTagName(e.tagName);return n?t.openElements.contains(n.element)?t.openElements.hasInScope(e.tagID)||(n=null):(t.activeFormattingElements.removeEntry(n),n=null):Qm(t,e),n}function y1(t,e){let n=null,r=t.openElements.stackTop;for(;r>=0;r--){let s=t.openElements.items[r];if(s===e.element)break;t._isSpecialElement(s,t.openElements.tagIDs[r])&&(n=s)}return n||(t.openElements.shortenToLength(r<0?0:r),t.activeFormattingElements.removeEntry(e)),n}function I1(t,e,n){let r=e,s=t.openElements.getCommonAncestor(e);for(let i=0,o=s;o!==n;i++,o=s){s=t.openElements.getCommonAncestor(o);let c=t.activeFormattingElements.getElementEntry(o),h=c&&i>=T1;!c||h?(h&&t.activeFormattingElements.removeEntry(c),t.openElements.remove(o)):(o=R1(t,c),r===e&&(t.activeFormattingElements.bookmark=c),t.treeAdapter.detachNode(r),t.treeAdapter.appendChild(o,r),r=o)}return r}function R1(t,e){let n=t.treeAdapter.getNamespaceURI(e.element),r=t.treeAdapter.createElement(e.token.tagName,n,e.token.attrs);return t.openElements.replace(e.element,r),e.element=r,r}function C1(t,e,n){let r=t.treeAdapter.getTagName(e),s=Nn(r);if(t._isElementCausesFosterParenting(s))t._fosterParentElement(n);else{let i=t.treeAdapter.getNamespaceURI(e);s===u.TEMPLATE&&i===L.HTML&&(e=t.treeAdapter.getTemplateContent(e)),t.treeAdapter.appendChild(e,n)}}function S1(t,e,n){let r=t.treeAdapter.getNamespaceURI(n.element),{token:s}=n,i=t.treeAdapter.createElement(s.tagName,r,s.attrs);t._adoptNodes(e,i),t.treeAdapter.appendChild(e,i),t.activeFormattingElements.insertElementAfterBookmark(i,s),t.activeFormattingElements.removeEntry(n),t.openElements.remove(n.element),t.openElements.insertAfter(e,i,s.tagID)}function Xl(t,e){for(let n=0;n<_1;n++){let r=b1(t,e);if(!r)break;let s=y1(t,r);if(!s)break;t.activeFormattingElements.bookmark=r;let i=I1(t,s,r.element),o=t.openElements.getCommonAncestor(r.element);t.treeAdapter.detachNode(i),o&&C1(t,o,i),S1(t,s,r)}}function Yl(t,e){t._appendCommentNode(e,t.openElements.currentTmplContentOrNode)}function w1(t,e){t._appendCommentNode(e,t.openElements.items[0])}function N1(t,e){t._appendCommentNode(e,t.document)}function Jl(t,e){if(t.stopped=!0,e.location){let n=t.fragmentContext?0:2;for(let r=t.openElements.stackTop;r>=n;r--)t._setEndLocation(t.openElements.items[r],e);if(!t.fragmentContext&&t.openElements.stackTop>=0){let r=t.openElements.items[0],s=t.treeAdapter.getNodeSourceCodeLocation(r);if(s&&!s.endTag&&(t._setEndLocation(r,e),t.openElements.stackTop>=1)){let i=t.openElements.items[1],o=t.treeAdapter.getNodeSourceCodeLocation(i);o&&!o.endTag&&t._setEndLocation(i,e)}}}}function v1(t,e){t._setDocumentType(e);let n=e.forceQuirks?Be.QUIRKS:xm(e);Om(e)||t._err(e,P.nonConformingDoctype),t.treeAdapter.setDocumentMode(t.document,n),t.insertionMode=A.BEFORE_HTML}function Ns(t,e){t._err(e,P.missingDoctype,!0),t.treeAdapter.setDocumentMode(t.document,Be.QUIRKS),t.insertionMode=A.BEFORE_HTML,t._processToken(e)}function D1(t,e){e.tagID===u.HTML?(t._insertElement(e,L.HTML),t.insertionMode=A.BEFORE_HEAD):Ds(t,e)}function P1(t,e){let n=e.tagID;(n===u.HTML||n===u.HEAD||n===u.BODY||n===u.BR)&&Ds(t,e)}function Ds(t,e){t._insertFakeRootElement(),t.insertionMode=A.BEFORE_HEAD,t._processToken(e)}function O1(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.HEAD:{t._insertElement(e,L.HTML),t.headElement=t.openElements.current,t.insertionMode=A.IN_HEAD;break}default:Ps(t,e)}}function x1(t,e){let n=e.tagID;n===u.HEAD||n===u.BODY||n===u.HTML||n===u.BR?Ps(t,e):t._err(e,P.endTagWithoutMatchingOpenElement)}function Ps(t,e){t._insertFakeElement(N.HEAD,u.HEAD),t.headElement=t.openElements.current,t.insertionMode=A.IN_HEAD,t._processToken(e)}function ct(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.BASE:case u.BASEFONT:case u.BGSOUND:case u.LINK:case u.META:{t._appendElement(e,L.HTML),e.ackSelfClosing=!0;break}case u.TITLE:{t._switchToTextParsing(e,Fe.RCDATA);break}case u.NOSCRIPT:{t.options.scriptingEnabled?t._switchToTextParsing(e,Fe.RAWTEXT):(t._insertElement(e,L.HTML),t.insertionMode=A.IN_HEAD_NO_SCRIPT);break}case u.NOFRAMES:case u.STYLE:{t._switchToTextParsing(e,Fe.RAWTEXT);break}case u.SCRIPT:{t._switchToTextParsing(e,Fe.SCRIPT_DATA);break}case u.TEMPLATE:{t._insertTemplate(e),t.activeFormattingElements.insertMarker(),t.framesetOk=!1,t.insertionMode=A.IN_TEMPLATE,t.tmplInsertionModeStack.unshift(A.IN_TEMPLATE);break}case u.HEAD:{t._err(e,P.misplacedStartTagForHeadElement);break}default:Os(t,e)}}function L1(t,e){switch(e.tagID){case u.HEAD:{t.openElements.pop(),t.insertionMode=A.AFTER_HEAD;break}case u.BODY:case u.BR:case u.HTML:{Os(t,e);break}case u.TEMPLATE:{vn(t,e);break}default:t._err(e,P.endTagWithoutMatchingOpenElement)}}function vn(t,e){t.openElements.tmplCount>0?(t.openElements.generateImpliedEndTagsThoroughly(),t.openElements.currentTagId!==u.TEMPLATE&&t._err(e,P.closingOfElementWithOpenChildElements),t.openElements.popUntilTagNamePopped(u.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode()):t._err(e,P.endTagWithoutMatchingOpenElement)}function Os(t,e){t.openElements.pop(),t.insertionMode=A.AFTER_HEAD,t._processToken(e)}function k1(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.BASEFONT:case u.BGSOUND:case u.HEAD:case u.LINK:case u.META:case u.NOFRAMES:case u.STYLE:{ct(t,e);break}case u.NOSCRIPT:{t._err(e,P.nestedNoscriptInHead);break}default:xs(t,e)}}function M1(t,e){switch(e.tagID){case u.NOSCRIPT:{t.openElements.pop(),t.insertionMode=A.IN_HEAD;break}case u.BR:{xs(t,e);break}default:t._err(e,P.endTagWithoutMatchingOpenElement)}}function xs(t,e){let n=e.type===ne.EOF?P.openElementsLeftAfterEof:P.disallowedContentInNoscriptInHead;t._err(e,n),t.openElements.pop(),t.insertionMode=A.IN_HEAD,t._processToken(e)}function B1(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.BODY:{t._insertElement(e,L.HTML),t.framesetOk=!1,t.insertionMode=A.IN_BODY;break}case u.FRAMESET:{t._insertElement(e,L.HTML),t.insertionMode=A.IN_FRAMESET;break}case u.BASE:case u.BASEFONT:case u.BGSOUND:case u.LINK:case u.META:case u.NOFRAMES:case u.SCRIPT:case u.STYLE:case u.TEMPLATE:case u.TITLE:{t._err(e,P.abandonedHeadElementChild),t.openElements.push(t.headElement,u.HEAD),ct(t,e),t.openElements.remove(t.headElement);break}case u.HEAD:{t._err(e,P.misplacedStartTagForHeadElement);break}default:Ls(t,e)}}function F1(t,e){switch(e.tagID){case u.BODY:case u.HTML:case u.BR:{Ls(t,e);break}case u.TEMPLATE:{vn(t,e);break}default:t._err(e,P.endTagWithoutMatchingOpenElement)}}function Ls(t,e){t._insertFakeElement(N.BODY,u.BODY),t.insertionMode=A.IN_BODY,Ga(t,e)}function Ga(t,e){switch(e.type){case ne.CHARACTER:{Km(t,e);break}case ne.WHITESPACE_CHARACTER:{Gm(t,e);break}case ne.COMMENT:{Yl(t,e);break}case ne.START_TAG:{Ue(t,e);break}case ne.END_TAG:{Ka(t,e);break}case ne.EOF:{Wm(t,e);break}default:}}function Gm(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e)}function Km(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e),t.framesetOk=!1}function U1(t,e){t.openElements.tmplCount===0&&t.treeAdapter.adoptAttributes(t.openElements.items[0],e.attrs)}function V1(t,e){let n=t.openElements.tryPeekProperlyNestedBodyElement();n&&t.openElements.tmplCount===0&&(t.framesetOk=!1,t.treeAdapter.adoptAttributes(n,e.attrs))}function H1(t,e){let n=t.openElements.tryPeekProperlyNestedBodyElement();t.framesetOk&&n&&(t.treeAdapter.detachNode(n),t.openElements.popAllUpToHtmlElement(),t._insertElement(e,L.HTML),t.insertionMode=A.IN_FRAMESET)}function q1(t,e){t.openElements.hasInButtonScope(u.P)&&t._closePElement(),t._insertElement(e,L.HTML)}function G1(t,e){t.openElements.hasInButtonScope(u.P)&&t._closePElement(),La(t.openElements.currentTagId)&&t.openElements.pop(),t._insertElement(e,L.HTML)}function K1(t,e){t.openElements.hasInButtonScope(u.P)&&t._closePElement(),t._insertElement(e,L.HTML),t.skipNextNewLine=!0,t.framesetOk=!1}function z1(t,e){let n=t.openElements.tmplCount>0;(!t.formElement||n)&&(t.openElements.hasInButtonScope(u.P)&&t._closePElement(),t._insertElement(e,L.HTML),n||(t.formElement=t.openElements.current))}function j1(t,e){t.framesetOk=!1;let n=e.tagID;for(let r=t.openElements.stackTop;r>=0;r--){let s=t.openElements.tagIDs[r];if(n===u.LI&&s===u.LI||(n===u.DD||n===u.DT)&&(s===u.DD||s===u.DT)){t.openElements.generateImpliedEndTagsWithExclusion(s),t.openElements.popUntilTagNamePopped(s);break}if(s!==u.ADDRESS&&s!==u.DIV&&s!==u.P&&t._isSpecialElement(t.openElements.items[r],s))break}t.openElements.hasInButtonScope(u.P)&&t._closePElement(),t._insertElement(e,L.HTML)}function Q1(t,e){t.openElements.hasInButtonScope(u.P)&&t._closePElement(),t._insertElement(e,L.HTML),t.tokenizer.state=Fe.PLAINTEXT}function W1(t,e){t.openElements.hasInScope(u.BUTTON)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(u.BUTTON)),t._reconstructActiveFormattingElements(),t._insertElement(e,L.HTML),t.framesetOk=!1}function Y1(t,e){let n=t.activeFormattingElements.getElementEntryInScopeWithTagName(N.A);n&&(Xl(t,e),t.openElements.remove(n.element),t.activeFormattingElements.removeEntry(n)),t._reconstructActiveFormattingElements(),t._insertElement(e,L.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function $1(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,L.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function X1(t,e){t._reconstructActiveFormattingElements(),t.openElements.hasInScope(u.NOBR)&&(Xl(t,e),t._reconstructActiveFormattingElements()),t._insertElement(e,L.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function J1(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,L.HTML),t.activeFormattingElements.insertMarker(),t.framesetOk=!1}function Z1(t,e){t.treeAdapter.getDocumentMode(t.document)!==Be.QUIRKS&&t.openElements.hasInButtonScope(u.P)&&t._closePElement(),t._insertElement(e,L.HTML),t.framesetOk=!1,t.insertionMode=A.IN_TABLE}function zm(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,L.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function jm(t){let e=xa(t,At.TYPE);return e!=null&&e.toLowerCase()===E1}function eb(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,L.HTML),jm(e)||(t.framesetOk=!1),e.ackSelfClosing=!0}function tb(t,e){t._appendElement(e,L.HTML),e.ackSelfClosing=!0}function nb(t,e){t.openElements.hasInButtonScope(u.P)&&t._closePElement(),t._appendElement(e,L.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function rb(t,e){e.tagName=N.IMG,e.tagID=u.IMG,zm(t,e)}function sb(t,e){t._insertElement(e,L.HTML),t.skipNextNewLine=!0,t.tokenizer.state=Fe.RCDATA,t.originalInsertionMode=t.insertionMode,t.framesetOk=!1,t.insertionMode=A.TEXT}function ib(t,e){t.openElements.hasInButtonScope(u.P)&&t._closePElement(),t._reconstructActiveFormattingElements(),t.framesetOk=!1,t._switchToTextParsing(e,Fe.RAWTEXT)}function ab(t,e){t.framesetOk=!1,t._switchToTextParsing(e,Fe.RAWTEXT)}function Vm(t,e){t._switchToTextParsing(e,Fe.RAWTEXT)}function ob(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,L.HTML),t.framesetOk=!1,t.insertionMode=t.insertionMode===A.IN_TABLE||t.insertionMode===A.IN_CAPTION||t.insertionMode===A.IN_TABLE_BODY||t.insertionMode===A.IN_ROW||t.insertionMode===A.IN_CELL?A.IN_SELECT_IN_TABLE:A.IN_SELECT}function ub(t,e){t.openElements.currentTagId===u.OPTION&&t.openElements.pop(),t._reconstructActiveFormattingElements(),t._insertElement(e,L.HTML)}function cb(t,e){t.openElements.hasInScope(u.RUBY)&&t.openElements.generateImpliedEndTags(),t._insertElement(e,L.HTML)}function lb(t,e){t.openElements.hasInScope(u.RUBY)&&t.openElements.generateImpliedEndTagsWithExclusion(u.RTC),t._insertElement(e,L.HTML)}function hb(t,e){t._reconstructActiveFormattingElements(),jl(e),Ua(e),e.selfClosing?t._appendElement(e,L.MATHML):t._insertElement(e,L.MATHML),e.ackSelfClosing=!0}function db(t,e){t._reconstructActiveFormattingElements(),Ql(e),Ua(e),e.selfClosing?t._appendElement(e,L.SVG):t._insertElement(e,L.SVG),e.ackSelfClosing=!0}function Hm(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,L.HTML)}function Ue(t,e){switch(e.tagID){case u.I:case u.S:case u.B:case u.U:case u.EM:case u.TT:case u.BIG:case u.CODE:case u.FONT:case u.SMALL:case u.STRIKE:case u.STRONG:{$1(t,e);break}case u.A:{Y1(t,e);break}case u.H1:case u.H2:case u.H3:case u.H4:case u.H5:case u.H6:{G1(t,e);break}case u.P:case u.DL:case u.OL:case u.UL:case u.DIV:case u.DIR:case u.NAV:case u.MAIN:case u.MENU:case u.ASIDE:case u.CENTER:case u.FIGURE:case u.FOOTER:case u.HEADER:case u.HGROUP:case u.DIALOG:case u.DETAILS:case u.ADDRESS:case u.ARTICLE:case u.SECTION:case u.SUMMARY:case u.FIELDSET:case u.BLOCKQUOTE:case u.FIGCAPTION:{q1(t,e);break}case u.LI:case u.DD:case u.DT:{j1(t,e);break}case u.BR:case u.IMG:case u.WBR:case u.AREA:case u.EMBED:case u.KEYGEN:{zm(t,e);break}case u.HR:{nb(t,e);break}case u.RB:case u.RTC:{cb(t,e);break}case u.RT:case u.RP:{lb(t,e);break}case u.PRE:case u.LISTING:{K1(t,e);break}case u.XMP:{ib(t,e);break}case u.SVG:{db(t,e);break}case u.HTML:{U1(t,e);break}case u.BASE:case u.LINK:case u.META:case u.STYLE:case u.TITLE:case u.SCRIPT:case u.BGSOUND:case u.BASEFONT:case u.TEMPLATE:{ct(t,e);break}case u.BODY:{V1(t,e);break}case u.FORM:{z1(t,e);break}case u.NOBR:{X1(t,e);break}case u.MATH:{hb(t,e);break}case u.TABLE:{Z1(t,e);break}case u.INPUT:{eb(t,e);break}case u.PARAM:case u.TRACK:case u.SOURCE:{tb(t,e);break}case u.IMAGE:{rb(t,e);break}case u.BUTTON:{W1(t,e);break}case u.APPLET:case u.OBJECT:case u.MARQUEE:{J1(t,e);break}case u.IFRAME:{ab(t,e);break}case u.SELECT:{ob(t,e);break}case u.OPTION:case u.OPTGROUP:{ub(t,e);break}case u.NOEMBED:{Vm(t,e);break}case u.FRAMESET:{H1(t,e);break}case u.TEXTAREA:{sb(t,e);break}case u.NOSCRIPT:{t.options.scriptingEnabled?Vm(t,e):Hm(t,e);break}case u.PLAINTEXT:{Q1(t,e);break}case u.COL:case u.TH:case u.TD:case u.TR:case u.HEAD:case u.FRAME:case u.TBODY:case u.TFOOT:case u.THEAD:case u.CAPTION:case u.COLGROUP:break;default:Hm(t,e)}}function fb(t,e){if(t.openElements.hasInScope(u.BODY)&&(t.insertionMode=A.AFTER_BODY,t.options.sourceCodeLocationInfo)){let n=t.openElements.tryPeekProperlyNestedBodyElement();n&&t._setEndLocation(n,e)}}function mb(t,e){t.openElements.hasInScope(u.BODY)&&(t.insertionMode=A.AFTER_BODY,np(t,e))}function pb(t,e){let n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n))}function gb(t){let e=t.openElements.tmplCount>0,{formElement:n}=t;e||(t.formElement=null),(n||e)&&t.openElements.hasInScope(u.FORM)&&(t.openElements.generateImpliedEndTags(),e?t.openElements.popUntilTagNamePopped(u.FORM):n&&t.openElements.remove(n))}function Eb(t){t.openElements.hasInButtonScope(u.P)||t._insertFakeElement(N.P,u.P),t._closePElement()}function _b(t){t.openElements.hasInListItemScope(u.LI)&&(t.openElements.generateImpliedEndTagsWithExclusion(u.LI),t.openElements.popUntilTagNamePopped(u.LI))}function Tb(t,e){let n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTagsWithExclusion(n),t.openElements.popUntilTagNamePopped(n))}function Ab(t){t.openElements.hasNumberedHeaderInScope()&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilNumberedHeaderPopped())}function bb(t,e){let n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n),t.activeFormattingElements.clearToLastMarker())}function yb(t){t._reconstructActiveFormattingElements(),t._insertFakeElement(N.BR,u.BR),t.openElements.pop(),t.framesetOk=!1}function Qm(t,e){let n=e.tagName,r=e.tagID;for(let s=t.openElements.stackTop;s>0;s--){let i=t.openElements.items[s],o=t.openElements.tagIDs[s];if(r===o&&(r!==u.UNKNOWN||t.treeAdapter.getTagName(i)===n)){t.openElements.generateImpliedEndTagsWithExclusion(r),t.openElements.stackTop>=s&&t.openElements.shortenToLength(s);break}if(t._isSpecialElement(i,o))break}}function Ka(t,e){switch(e.tagID){case u.A:case u.B:case u.I:case u.S:case u.U:case u.EM:case u.TT:case u.BIG:case u.CODE:case u.FONT:case u.NOBR:case u.SMALL:case u.STRIKE:case u.STRONG:{Xl(t,e);break}case u.P:{Eb(t);break}case u.DL:case u.UL:case u.OL:case u.DIR:case u.DIV:case u.NAV:case u.PRE:case u.MAIN:case u.MENU:case u.ASIDE:case u.BUTTON:case u.CENTER:case u.FIGURE:case u.FOOTER:case u.HEADER:case u.HGROUP:case u.DIALOG:case u.ADDRESS:case u.ARTICLE:case u.DETAILS:case u.SECTION:case u.SUMMARY:case u.LISTING:case u.FIELDSET:case u.BLOCKQUOTE:case u.FIGCAPTION:{pb(t,e);break}case u.LI:{_b(t);break}case u.DD:case u.DT:{Tb(t,e);break}case u.H1:case u.H2:case u.H3:case u.H4:case u.H5:case u.H6:{Ab(t);break}case u.BR:{yb(t);break}case u.BODY:{fb(t,e);break}case u.HTML:{mb(t,e);break}case u.FORM:{gb(t);break}case u.APPLET:case u.OBJECT:case u.MARQUEE:{bb(t,e);break}case u.TEMPLATE:{vn(t,e);break}default:Qm(t,e)}}function Wm(t,e){t.tmplInsertionModeStack.length>0?tp(t,e):Jl(t,e)}function Ib(t,e){var n;e.tagID===u.SCRIPT&&((n=t.scriptHandler)===null||n===void 0||n.call(t,t.openElements.current)),t.openElements.pop(),t.insertionMode=t.originalInsertionMode}function Rb(t,e){t._err(e,P.eofInElementThatCanContainOnlyText),t.openElements.pop(),t.insertionMode=t.originalInsertionMode,t.onEof(e)}function Wl(t,e){if(qm.has(t.openElements.currentTagId))switch(t.pendingCharacterTokens.length=0,t.hasNonWhitespacePendingCharacterToken=!1,t.originalInsertionMode=t.insertionMode,t.insertionMode=A.IN_TABLE_TEXT,e.type){case ne.CHARACTER:{$m(t,e);break}case ne.WHITESPACE_CHARACTER:{Ym(t,e);break}}else Bs(t,e)}function Cb(t,e){t.openElements.clearBackToTableContext(),t.activeFormattingElements.insertMarker(),t._insertElement(e,L.HTML),t.insertionMode=A.IN_CAPTION}function Sb(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,L.HTML),t.insertionMode=A.IN_COLUMN_GROUP}function wb(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(N.COLGROUP,u.COLGROUP),t.insertionMode=A.IN_COLUMN_GROUP,Zl(t,e)}function Nb(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,L.HTML),t.insertionMode=A.IN_TABLE_BODY}function vb(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(N.TBODY,u.TBODY),t.insertionMode=A.IN_TABLE_BODY,za(t,e)}function Db(t,e){t.openElements.hasInTableScope(u.TABLE)&&(t.openElements.popUntilTagNamePopped(u.TABLE),t._resetInsertionMode(),t._processStartTag(e))}function Pb(t,e){jm(e)?t._appendElement(e,L.HTML):Bs(t,e),e.ackSelfClosing=!0}function Ob(t,e){!t.formElement&&t.openElements.tmplCount===0&&(t._insertElement(e,L.HTML),t.formElement=t.openElements.current,t.openElements.pop())}function gr(t,e){switch(e.tagID){case u.TD:case u.TH:case u.TR:{vb(t,e);break}case u.STYLE:case u.SCRIPT:case u.TEMPLATE:{ct(t,e);break}case u.COL:{wb(t,e);break}case u.FORM:{Ob(t,e);break}case u.TABLE:{Db(t,e);break}case u.TBODY:case u.TFOOT:case u.THEAD:{Nb(t,e);break}case u.INPUT:{Pb(t,e);break}case u.CAPTION:{Cb(t,e);break}case u.COLGROUP:{Sb(t,e);break}default:Bs(t,e)}}function Ms(t,e){switch(e.tagID){case u.TABLE:{t.openElements.hasInTableScope(u.TABLE)&&(t.openElements.popUntilTagNamePopped(u.TABLE),t._resetInsertionMode());break}case u.TEMPLATE:{vn(t,e);break}case u.BODY:case u.CAPTION:case u.COL:case u.COLGROUP:case u.HTML:case u.TBODY:case u.TD:case u.TFOOT:case u.TH:case u.THEAD:case u.TR:break;default:Bs(t,e)}}function Bs(t,e){let n=t.fosterParentingEnabled;t.fosterParentingEnabled=!0,Ga(t,e),t.fosterParentingEnabled=n}function Ym(t,e){t.pendingCharacterTokens.push(e)}function $m(t,e){t.pendingCharacterTokens.push(e),t.hasNonWhitespacePendingCharacterToken=!0}function vs(t,e){let n=0;if(t.hasNonWhitespacePendingCharacterToken)for(;n<t.pendingCharacterTokens.length;n++)Bs(t,t.pendingCharacterTokens[n]);else for(;n<t.pendingCharacterTokens.length;n++)t._insertCharacters(t.pendingCharacterTokens[n]);t.insertionMode=t.originalInsertionMode,t._processToken(e)}var Xm=new Set([u.CAPTION,u.COL,u.COLGROUP,u.TBODY,u.TD,u.TFOOT,u.TH,u.THEAD,u.TR]);function xb(t,e){let n=e.tagID;Xm.has(n)?t.openElements.hasInTableScope(u.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(u.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=A.IN_TABLE,gr(t,e)):Ue(t,e)}function Lb(t,e){let n=e.tagID;switch(n){case u.CAPTION:case u.TABLE:{t.openElements.hasInTableScope(u.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(u.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=A.IN_TABLE,n===u.TABLE&&Ms(t,e));break}case u.BODY:case u.COL:case u.COLGROUP:case u.HTML:case u.TBODY:case u.TD:case u.TFOOT:case u.TH:case u.THEAD:case u.TR:break;default:Ka(t,e)}}function Zl(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.COL:{t._appendElement(e,L.HTML),e.ackSelfClosing=!0;break}case u.TEMPLATE:{ct(t,e);break}default:Ha(t,e)}}function kb(t,e){switch(e.tagID){case u.COLGROUP:{t.openElements.currentTagId===u.COLGROUP&&(t.openElements.pop(),t.insertionMode=A.IN_TABLE);break}case u.TEMPLATE:{vn(t,e);break}case u.COL:break;default:Ha(t,e)}}function Ha(t,e){t.openElements.currentTagId===u.COLGROUP&&(t.openElements.pop(),t.insertionMode=A.IN_TABLE,t._processToken(e))}function za(t,e){switch(e.tagID){case u.TR:{t.openElements.clearBackToTableBodyContext(),t._insertElement(e,L.HTML),t.insertionMode=A.IN_ROW;break}case u.TH:case u.TD:{t.openElements.clearBackToTableBodyContext(),t._insertFakeElement(N.TR,u.TR),t.insertionMode=A.IN_ROW,ja(t,e);break}case u.CAPTION:case u.COL:case u.COLGROUP:case u.TBODY:case u.TFOOT:case u.THEAD:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=A.IN_TABLE,gr(t,e));break}default:gr(t,e)}}function $l(t,e){let n=e.tagID;switch(e.tagID){case u.TBODY:case u.TFOOT:case u.THEAD:{t.openElements.hasInTableScope(n)&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=A.IN_TABLE);break}case u.TABLE:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=A.IN_TABLE,Ms(t,e));break}case u.BODY:case u.CAPTION:case u.COL:case u.COLGROUP:case u.HTML:case u.TD:case u.TH:case u.TR:break;default:Ms(t,e)}}function ja(t,e){switch(e.tagID){case u.TH:case u.TD:{t.openElements.clearBackToTableRowContext(),t._insertElement(e,L.HTML),t.insertionMode=A.IN_CELL,t.activeFormattingElements.insertMarker();break}case u.CAPTION:case u.COL:case u.COLGROUP:case u.TBODY:case u.TFOOT:case u.THEAD:case u.TR:{t.openElements.hasInTableScope(u.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=A.IN_TABLE_BODY,za(t,e));break}default:gr(t,e)}}function Jm(t,e){switch(e.tagID){case u.TR:{t.openElements.hasInTableScope(u.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=A.IN_TABLE_BODY);break}case u.TABLE:{t.openElements.hasInTableScope(u.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=A.IN_TABLE_BODY,$l(t,e));break}case u.TBODY:case u.TFOOT:case u.THEAD:{(t.openElements.hasInTableScope(e.tagID)||t.openElements.hasInTableScope(u.TR))&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=A.IN_TABLE_BODY,$l(t,e));break}case u.BODY:case u.CAPTION:case u.COL:case u.COLGROUP:case u.HTML:case u.TD:case u.TH:break;default:Ms(t,e)}}function Mb(t,e){let n=e.tagID;Xm.has(n)?(t.openElements.hasInTableScope(u.TD)||t.openElements.hasInTableScope(u.TH))&&(t._closeTableCell(),ja(t,e)):Ue(t,e)}function Bb(t,e){let n=e.tagID;switch(n){case u.TD:case u.TH:{t.openElements.hasInTableScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=A.IN_ROW);break}case u.TABLE:case u.TBODY:case u.TFOOT:case u.THEAD:case u.TR:{t.openElements.hasInTableScope(n)&&(t._closeTableCell(),Jm(t,e));break}case u.BODY:case u.CAPTION:case u.COL:case u.COLGROUP:case u.HTML:break;default:Ka(t,e)}}function Zm(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.OPTION:{t.openElements.currentTagId===u.OPTION&&t.openElements.pop(),t._insertElement(e,L.HTML);break}case u.OPTGROUP:{t.openElements.currentTagId===u.OPTION&&t.openElements.pop(),t.openElements.currentTagId===u.OPTGROUP&&t.openElements.pop(),t._insertElement(e,L.HTML);break}case u.INPUT:case u.KEYGEN:case u.TEXTAREA:case u.SELECT:{t.openElements.hasInSelectScope(u.SELECT)&&(t.openElements.popUntilTagNamePopped(u.SELECT),t._resetInsertionMode(),e.tagID!==u.SELECT&&t._processStartTag(e));break}case u.SCRIPT:case u.TEMPLATE:{ct(t,e);break}default:}}function ep(t,e){switch(e.tagID){case u.OPTGROUP:{t.openElements.stackTop>0&&t.openElements.currentTagId===u.OPTION&&t.openElements.tagIDs[t.openElements.stackTop-1]===u.OPTGROUP&&t.openElements.pop(),t.openElements.currentTagId===u.OPTGROUP&&t.openElements.pop();break}case u.OPTION:{t.openElements.currentTagId===u.OPTION&&t.openElements.pop();break}case u.SELECT:{t.openElements.hasInSelectScope(u.SELECT)&&(t.openElements.popUntilTagNamePopped(u.SELECT),t._resetInsertionMode());break}case u.TEMPLATE:{vn(t,e);break}default:}}function Fb(t,e){let n=e.tagID;n===u.CAPTION||n===u.TABLE||n===u.TBODY||n===u.TFOOT||n===u.THEAD||n===u.TR||n===u.TD||n===u.TH?(t.openElements.popUntilTagNamePopped(u.SELECT),t._resetInsertionMode(),t._processStartTag(e)):Zm(t,e)}function Ub(t,e){let n=e.tagID;n===u.CAPTION||n===u.TABLE||n===u.TBODY||n===u.TFOOT||n===u.THEAD||n===u.TR||n===u.TD||n===u.TH?t.openElements.hasInTableScope(n)&&(t.openElements.popUntilTagNamePopped(u.SELECT),t._resetInsertionMode(),t.onEndTag(e)):ep(t,e)}function Vb(t,e){switch(e.tagID){case u.BASE:case u.BASEFONT:case u.BGSOUND:case u.LINK:case u.META:case u.NOFRAMES:case u.SCRIPT:case u.STYLE:case u.TEMPLATE:case u.TITLE:{ct(t,e);break}case u.CAPTION:case u.COLGROUP:case u.TBODY:case u.TFOOT:case u.THEAD:{t.tmplInsertionModeStack[0]=A.IN_TABLE,t.insertionMode=A.IN_TABLE,gr(t,e);break}case u.COL:{t.tmplInsertionModeStack[0]=A.IN_COLUMN_GROUP,t.insertionMode=A.IN_COLUMN_GROUP,Zl(t,e);break}case u.TR:{t.tmplInsertionModeStack[0]=A.IN_TABLE_BODY,t.insertionMode=A.IN_TABLE_BODY,za(t,e);break}case u.TD:case u.TH:{t.tmplInsertionModeStack[0]=A.IN_ROW,t.insertionMode=A.IN_ROW,ja(t,e);break}default:t.tmplInsertionModeStack[0]=A.IN_BODY,t.insertionMode=A.IN_BODY,Ue(t,e)}}function Hb(t,e){e.tagID===u.TEMPLATE&&vn(t,e)}function tp(t,e){t.openElements.tmplCount>0?(t.openElements.popUntilTagNamePopped(u.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode(),t.onEof(e)):Jl(t,e)}function qb(t,e){e.tagID===u.HTML?Ue(t,e):qa(t,e)}function np(t,e){var n;if(e.tagID===u.HTML){if(t.fragmentContext||(t.insertionMode=A.AFTER_AFTER_BODY),t.options.sourceCodeLocationInfo&&t.openElements.tagIDs[0]===u.HTML){t._setEndLocation(t.openElements.items[0],e);let r=t.openElements.items[1];r&&!(!((n=t.treeAdapter.getNodeSourceCodeLocation(r))===null||n===void 0)&&n.endTag)&&t._setEndLocation(r,e)}}else qa(t,e)}function qa(t,e){t.insertionMode=A.IN_BODY,Ga(t,e)}function Gb(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.FRAMESET:{t._insertElement(e,L.HTML);break}case u.FRAME:{t._appendElement(e,L.HTML),e.ackSelfClosing=!0;break}case u.NOFRAMES:{ct(t,e);break}default:}}function Kb(t,e){e.tagID===u.FRAMESET&&!t.openElements.isRootHtmlElementCurrent()&&(t.openElements.pop(),!t.fragmentContext&&t.openElements.currentTagId!==u.FRAMESET&&(t.insertionMode=A.AFTER_FRAMESET))}function zb(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.NOFRAMES:{ct(t,e);break}default:}}function jb(t,e){e.tagID===u.HTML&&(t.insertionMode=A.AFTER_AFTER_FRAMESET)}function Qb(t,e){e.tagID===u.HTML?Ue(t,e):Va(t,e)}function Va(t,e){t.insertionMode=A.IN_BODY,Ga(t,e)}function Wb(t,e){switch(e.tagID){case u.HTML:{Ue(t,e);break}case u.NOFRAMES:{ct(t,e);break}default:}}function Yb(t,e){e.chars=he,t._insertCharacters(e)}function $b(t,e){t._insertCharacters(e),t.framesetOk=!1}function rp(t){for(;t.treeAdapter.getNamespaceURI(t.openElements.current)!==L.HTML&&!t._isIntegrationPoint(t.openElements.currentTagId,t.openElements.current);)t.openElements.pop()}function Xb(t,e){if(km(e))rp(t),t._startTagOutsideForeignContent(e);else{let n=t._getAdjustedCurrentElement(),r=t.treeAdapter.getNamespaceURI(n);r===L.MATHML?jl(e):r===L.SVG&&(Mm(e),Ql(e)),Ua(e),e.selfClosing?t._appendElement(e,r):t._insertElement(e,r),e.ackSelfClosing=!0}}function Jb(t,e){if(e.tagID===u.P||e.tagID===u.BR){rp(t),t._endTagOutsideForeignContent(e);return}for(let n=t.openElements.stackTop;n>0;n--){let r=t.openElements.items[n];if(t.treeAdapter.getNamespaceURI(r)===L.HTML){t._endTagOutsideForeignContent(e);break}let s=t.treeAdapter.getTagName(r);if(s.toLowerCase()===e.tagName){e.tagName=s,t.openElements.shortenToLength(n);break}}}B();M();B();M();var Zb=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),aC=String.prototype.codePointAt!=null?(t,e)=>t.codePointAt(e):(t,e)=>(t.charCodeAt(e)&64512)===55296?(t.charCodeAt(e)-55296)*1024+t.charCodeAt(e+1)-56320+65536:t.charCodeAt(e);function eh(t,e){return function(r){let s,i=0,o="";for(;s=t.exec(r);)i!==s.index&&(o+=r.substring(i,s.index)),o+=e.get(s[0].charCodeAt(0)),i=s.index+1;return o+r.substring(i)}}var oC=eh(/[&<>'"]/g,Zb),ey=eh(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),ty=eh(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]));var pC=new Set([N.AREA,N.BASE,N.BASEFONT,N.BGSOUND,N.BR,N.COL,N.EMBED,N.FRAME,N.HR,N.IMG,N.INPUT,N.KEYGEN,N.LINK,N.META,N.PARAM,N.SOURCE,N.TRACK,N.WBR]);function sp(t,e){return ks.parse(t,e)}var ap=le(Ct());B();M();async function ip(t){let e=Ml(await pr(t.getSizeInBytes.bind(t))(),()=>0),n=Ml(await pr(t.getBytes.bind(t))(0,e),()=>new Int8Array(0)),r=new Blob([n],{type:t.contentType}),s=t.mimeType.parameters.charset||"utf-8";return new Promise(i=>{let o=new FileReader;o.onload=()=>{let c=o.result;if(typeof c!="string")throw new Error("FileReader result is not a string");i(c)},o.readAsText(r,s)})}var op=t=>({attributes:t.attrs&&t.attrs.map(e=>({name:e.name,value:e.value})),children:t.childNodes&&t.childNodes.map(op),tagName:t.tagName,rawRefObject:null}),Qa=class extends ap.HTMLParser{parseAsDOM(e,n){return Je(async()=>{let r=await ip(e),i=sp(r).childNodes[0];return op(i)},n)}};B();M();var Dn=le(Ct()),qt=le(ud());B();M();B();M();function Ht({events:t}){let e=Object.fromEntries(t.map(c=>[c,[]]));function n(c,h){if(!t.includes(c))throw new Error(`Invalid event "${String(c)}" provided`);return Array.isArray(e[c])||(e[c]=[]),e[c]?.push(h),()=>r(c,h)}function r(c,h){if(!Array.isArray(e[c]))return;let f=e[c].indexOf(h);f>-1&&e[c].splice(f,1)}async function s(c,h){if(!Array.isArray(e[c]))return;let f=e[c];for(let m of f)await Promise.resolve(m(h)).catch(console.error)}function i(c,h){return n(c,function f(m){r(c,f),h(m)})}function o(){for(let c of t)e[c]=[]}return{on:n,off:r,emit:s,once:i,addEventListener:n,removeEventListener:r,removeAllListeners:o}}var up=Ht({events:["failed","success"]}),cp=async(t,e)=>{try{let n=await fetch(t,e),r=n.status>=200&&n.status<300?"success":"failed";return up.emit(r,{status:n.status,url:t}),n}catch(n){throw up.emit("failed",{url:t}),Error(n)}};B();M();async function*lp(t){let e=t.getReader();try{for(;;){let{done:n,value:r}=await e.read();if(n)return;yield r}}finally{e.releaseLock()}}B();M();var ny=new Set(["localhost","speechifydev.appspot.com","speechifymobile.appspot.com","us-central1-speechifydev.cloudfunctions.net","us-central1-speechifymobile.cloudfunctions.net","payment-server-dot-speechifydev.uc.r.appspot.com","payment-server-dot-speechifymobile.uc.r.appspot.com","dev.audio.api.speechify.dev","audio.api.speechify.dev","dev.payment.api.speechify.dev","payment.api.speechify.dev","re-enable-app-check.dev.audio.api.speechify.dev","payment.api.speechify.com","audio.api.speechify.com","catalog.api.speechify.com","dev.voices.api.speechify.com","voices.api.speechify.com","voiceover-backend-s3dppbxoja-uc.a.run.app","voiceover-backend-prod-s3dppbxoja-uc.a.run.app","diagnostics.api.speechify.com"]),ry=["https://audio.api.speechify.dev","https://dev.audio.api.speechify.dev"];function hp(t){return ny.has(new URL(t).hostname)}function dp(t){let e="https://us-central1-speechifydev.cloudfunctions.net/cors-proxy-pdf",n=new URL(e);return n.searchParams.set("url",t),n.toString()}var fp=t=>ry.includes(new URL(t).origin);var sy=(n=>(n.Desktop="DesktopExtension",n.Mobile="SafariExtension",n))(sy||{}),gp=Ht({events:["failed","success"]}),iy=t=>{let{status:e,url:n}=t,r=e>=200&&e<300?"success":"failed";gp.emit(r,{status:t.status,url:n})},mp=t=>{let e={};return t.forEach((n,r)=>{e[r]=n}),e},pp={blob:{transformResponseToTyped:async t=>{let{status:e}=t,n=new wn(mp(t.headers)),r=t.body?new Dn.BinaryContentReadableRandomly(await t.blob()):null;return new qt.HttpResponseWithBodyAsBinaryContentReadableRandomly(e,n,r)}},stream:{transformResponseToTyped:async t=>{let{status:e}=t,n=new wn(mp(t.headers)),r=t.body?new Dn.BinaryContentReadableSequentially(lp(t.body)):null;return new qt.HttpResponseWithBodyAsBinaryContentReadableSequentially(e,n,r)}}},Wa=class extends qt.HttpClientAdapter{constructor(){super(...arguments);this.requestBinaryContentReadableRandomly=(n,r,s,i,o,c)=>Je(()=>this.requestAsync(n,r,pp.blob,s,i,o),c);this.requestBinaryContentReadableSequentially=(n,r,s,i,o,c)=>Je(()=>this.requestAsync(n,r,pp.stream,s,i,o),c)}async requestAsync(n,r,s,i,o,c){let h=null;if(c instanceof qt.HttpRequestBodyData.BodyBytes)h=c?.body??null;else if(c instanceof qt.HttpRequestBodyData.MultipartFormData&&c.entries){h=new FormData;for(let U of c.entries.entries()){let k=U.first,z=U.second;if(z.binaryContent instanceof Dn.BinaryContentReadableRandomly)h.append(k,z.binaryContent.blob);else if(z instanceof Dn.FileFromString){let $=z.mimeType.parameters.charset||"utf-8",Z=new TextDecoder($).decode(z.bytes);h.append(k,Z)}else throw new Error(`WebHttpClientAdapter.requestAsync - Type of item not supported! key: ${k}, item: ${z}`)}}let f={};if(o)for(let U of o.keys())f[U]=o.get(U);let m={};if(i)for(let U of i.keys())m[U]=i.get(U);fp(r)&&(i.hasKey("X-Speechify-Client")||(m["X-Speechify-Client"]=od()?"SafariExtension":"DesktopExtension"),i.hasKey("X-Speechify-Client-Version")||(m["X-Speechify-Client-Version"]=browser.runtime.getManifest().version));let _=hp(r)?r:dp(r),I=new URLSearchParams(f),v=I?.toString()?`${_}?${I.toString()}`:_,x=await cp(v,{method:n.toString(),headers:m,body:h});if(iy({url:_,status:x.status}),x.status)return s.transformResponseToTyped(x)}},{on:hS,off:dS}=gp;B();M();var Tp=le(dg()),Er=le(Mn());var Ep=Ta("multiplatform-sdk",{getInitialState:async()=>({})}),_p=ya("WebLocalKeyValueStore","green"),Ya=class extends Tp.AbstractLocalKeyValueStorageAdapter{getData(e,n){throw new Error("not implemented")}putData(e,n){throw new Error("not implemented")}deleteData(e,n){throw new Error("not implemented")}deleteSingle(e,n){throw new Error("not implemented")}putSingle(e,n,r){_p.info("Setting key",e),Ep.set(e,Buffer.from(n).toString("base64")).then(()=>r(new Er.Result.Success(void 0)))}getSingle(e,n){Ep.get(e).then(r=>{if(_p.info("Fetching key",e,r),!r)return n(new Er.Result.Failure(new Er.SDKError.ResourceNotFound(e,"No value for this key set.")));n(new Er.Result.Success(new Int8Array(Buffer.from(r,"base64"))))})}};B();M();var Ap=le(Ct()),et=le(fg()),bt=le(Mn());var ay=({name:t})=>t.includes("Google"),oy=50,uy=4e3,$a=class extends et.AbstractLocalSpeechSynthesisAdapter{createLocalSpeechSynthesisPlayer(e){e(new bt.Result.Success(new th))}getAllVoices(e){new Promise(n=>{let r=speechSynthesis.getVoices();r.length>0&&n(r),speechSynthesis.onvoiceschanged=()=>{speechSynthesis.onvoiceschanged=null,n(speechSynthesis.getVoices())}}).then(n=>n.filter(r=>!r.voiceURI.startsWith("Google")).map(cy)).then(n=>e(new bt.Result.Success(n)))}},th=class extends et.AbstractLocalSpeechSynthesisPlayer{constructor(){super(),this.activeUtterance=null,this.activeSpeechUtterance=null,this.eventEmitter=Ht({events:["ended","start","pause","progress","errored"]}),this.consumed=0,this.pausedAt=0,this.activeCallback=null,this.setupEvents()}setupEvents(){this.eventEmitter.on("start",()=>{this.activeCallback(new bt.Result.Success(et.LocalSpeechSynthesisEvent.Started))}),this.eventEmitter.on("pause",()=>this.activeCallback(new bt.Result.Success(et.LocalSpeechSynthesisEvent.Paused))),this.eventEmitter.on("ended",()=>this.activeCallback(new bt.Result.Success(et.LocalSpeechSynthesisEvent.Ended))),this.eventEmitter.on("errored",e=>{this.activeCallback(new bt.Result.Failure(new bt.SDKError.OtherException(e.error)))}),this.eventEmitter.on("progress",({charIndex:e})=>this.activeCallback(new bt.Result.Success(new et.LocalSpeechSynthesisEvent.Progressed(this.pausedAt+e))))}handleBoundaryTimeout(){window.speechSynthesis.pause(),window.speechSynthesis.resume()}setupUtteranceEvents(e){e.onstart=()=>{clearTimeout(this.boundaryTimeout),this.eventEmitter.emit("start",{})},e.onerror=n=>{clearTimeout(this.boundaryTimeout),n.error!=="interrupted"&&this.eventEmitter.emit("errored",{error:new Error(n.error)})},e.onboundary=n=>{this.consumed=n.charIndex+n.charLength,n.charIndex+32>=e.text.length-1&&(e.onend=()=>{clearTimeout(this.boundaryTimeout),this.eventEmitter.emit("ended",{})}),clearTimeout(this.boundaryTimeout),this.boundaryTimeout=setTimeout(()=>{this.handleBoundaryTimeout()},uy),this.eventEmitter.emit("progress",{charIndex:n.charIndex})}}speak(e,n){this.activeUtterance=e,this.consumed=0,this.pausedAt=0,this.activeCallback=n,this.playUtterance(e.text,e.voice.source.get,e.options.speed,e.options.volume)}playUtterance(e,n,r,s){this.activeSpeechUtterance=new SpeechSynthesisUtterance(e),this.activeSpeechUtterance.voice=n,this.activeSpeechUtterance.rate=r,this.activeSpeechUtterance.volume=s,this.setupUtteranceEvents(this.activeSpeechUtterance),setTimeout(()=>{window.speechSynthesis.speak(this.activeSpeechUtterance)},oy),ay(this.activeSpeechUtterance.voice)&&(window.speechSynthesis.pause(),window.speechSynthesis.resume())}cancelUtterance(){window.speechSynthesis.cancel()}pause(){this.cancelUtterance(),this.eventEmitter.emit("pause",{}),this.pausedAt=this.consumed}resume(){if(!this.activeUtterance)return console.warn("No utterance active");let e=this.activeUtterance.text.slice(this.consumed),n=this.activeUtterance.voice.source.get,r=this.activeUtterance.options.speed,s=this.activeUtterance.options.volume;this.playUtterance(e,n,r,s)}cancel(){this.cancelUtterance()}};function cy(t){return new et.LocalSynthesisVoice(t.name,t.name,t.lang,Ap.VoiceGender.MALE,new et.VoiceRef(t))}B();M();var bp=le(cd()),yp=le(Mn());B();M();var on=le(cd()),Pn=le(Mn());var _r=Ht({events:["ended","play","pause","errored"]}),Xa=Ht({events:["currentTime","state","currentRate"]});function ly(){browser.runtime.onMessage.addListener(t=>{if(t.target!=="content")return;let{type:e,data:n}=t.data;switch(e){case"currentRate":Xa.emit("currentRate",{rate:n.rate});break;case"currentTime":Xa.emit("currentTime",{currentTime:n.currentTime});break;case"state":_r.emit(n.type,{});break}})}ly();var Ja=class extends on.LocalMediaPlayer{constructor(e,{speed:n}){super(),this.eventListener=()=>this.destroy(),window.addEventListener("beforeunload",this.eventListener),this.postMessage("load-source",{mediaUrl:e}),this.postMessage("update-settings",{rate:n})}async postMessage(e,n){return await browser.runtime.sendMessage({target:"offscreen",data:{type:"playback/player",data:{type:e,data:n}}})}getOptions(e){this.postMessage("get-current-rate",{}),Xa.once("currentRate",({rate:n})=>{e(new on.LocalMediaPlayerOptions(n,100))})}seek(e){this.postMessage("seek",{timeInMilliseconds:e})}setSpeed(e){this.postMessage("update-settings",{rate:e})}setVolume(){}setEventListener(e){_r.removeAllListeners(),_r.on("ended",()=>{e(new Pn.Result.Success(on.LocalMediaPlayerEvent.Ended))}),_r.on("pause",()=>{e(new Pn.Result.Success(on.LocalMediaPlayerEvent.Stopped))}),_r.on("play",()=>{e(new Pn.Result.Success(on.LocalMediaPlayerEvent.Started))}),_r.on("errored",()=>{e(new Pn.Result.Failure(new Pn.SDKError.OtherMessage("Error playing audio")))})}play(){this.postMessage("play",{})}destroy(){this.postMessage("destroy",{}),window.removeEventListener("beforeunload",this.eventListener)}pause(){this.postMessage("pause",{})}getCurrentTimeInMilliseconds(e){this.postMessage("get-current-time",{}),Xa.once("currentTime",({currentTime:n})=>{e(n*1e3)})}updateOptions({speed:e}){this.postMessage("update-settings",{rate:e})}};var Za=class extends bp.AbstractLocalMediaPlayerAdapter{async createMediaPlayer(e,n,r){return r(new yp.Result.Success(new Ja(e,n)))}};B();M();var Ip=le(mg()),eo=class extends Ip.AbstractOCRAdapter{async runOCR(){console.warn("Not implemented")}};B();M();var to=le(Ct()),no=class extends to.OfflineModeStatusProvider{getCurrentValueAndSubscribeToUpdatesAndGetCancel(e){let n=()=>{let r=navigator.onLine?to.OfflineModeStatusProvider.OfflineModeStatus.ONLINE:to.OfflineModeStatusProvider.OfflineModeStatus.OFFLINE;e(r)};return n(),navigator.connection?.addEventListener("change",n),()=>{navigator.connection?.removeEventListener("change",n)}}};B();M();var Qe=le(Ct());async function hy(t){let e=[];for await(let n of t)e.push(n);return e}async function Rp(t,e){return new Blob(await hy(t),{type:e})}var ro=class extends Qe.BlobStorageAdapter{constructor(){super(...arguments);this.blobMap=new Map;this.putBlob=(n,r,s)=>{Je(async()=>(this.blobMap.set(n.originalKey,r),r.binaryContent),s)};this.putBlobByMove=(n,r,s)=>this.putBlob(n,r,s);this.putSequenceGetReadableRandomly=(n,r,s)=>{Je(async()=>{let i=new Qe.BinaryContentWithMimeTypeFromNative(r.mimeType,new Qe.BinaryContentReadableRandomly(await Rp(r.binaryContent.readableStreamOfBytes,r.mimeType?.fullString)));return this.blobMap.set(n.originalKey,i),i.binaryContent},s)};this.putBytes=(n,r,s)=>{Je(async()=>{let i=new Qe.BinaryContentWithMimeTypeFromNative(r.mimeType,new Qe.BinaryContentReadableRandomly(await Rp((0,Qe.asyncIterableFromBinaryContentReadableSequentially)(r.binaryContent),r.mimeType?.fullString)));this.blobMap.set(n.originalKey,i)},s)};this.getBlob=(n,r)=>{Je(async()=>{let s=this.blobMap.get(n.originalKey);return s?new Qe.Result.Success(s):new Qe.Result.Success(null)},r)}}deleteBlob(n,r){r(new Qe.Result.Success(this.blobMap.delete(n.originalKey)))}};B();M();var dy=le(Ct());B();M();var Sp=le(cg()),Tr=le(Mn()),Cp=class t extends Sp.AbstractFile{constructor(n,r,s,i){super();this.localUrl=r;this.sizeInBytes=s;this.file=i;this._contentType=n}get contentType(){return this._contentType}getBytes(n,r,s){this.file.slice(n,r).arrayBuffer().then(i=>s(new Tr.Result.Success(new Int8Array(i)))).catch(i=>s(new Tr.Result.Failure(new Tr.SDKError.IO(i.message))))}getSizeInBytes(n){n(new Tr.Result.Success(this.sizeInBytes))}static fromFile(n){return new t(n.type,n.name,n.size,n)}};var wp=class extends Ar.AbstractAdapterFactory{constructor(n){super();this.auth=n}getBlobStorage(){return new ro}getLocalKeyValueStorage(){return new Ya}getHttpClient(){return new Wa}getFirebaseService(){return new Na(this.auth)}getLocalSpeechSynthesis(){return new $a}getLocalMediaPlayer(){return new Za}getPDFAdapterFactory(){}getImageConverter(){}getOcrAdapter(){return new eo(1)}getHTMLParser(){return typeof DOMParser<"u"?new Ar.W3CHTMLParser:new Qa}getBrowserIdentityUserAgentProvider(){return new Np.BrowserIdentityUserAgentProvider}getArchiveFilesAdapter(){return new ni}getXMLParser(){return new Ar.W3CXMLParser}getSqlDriverFactory(){return null}getOfflineModeStatusProvider(){return new no}getEventsTrackerAdapter(){return new ti}getEncryptionAdapter(){}getWebViewAdapter(){}};export{kl as a,Ta as b,sR as c,iR as d,ya as e,Ia as f,Ra as g,cR as h,Ml as i,lR as j,hR as k,dR as l,fR as m,Tg as n,ko as o,Ay as p,by as q,yy as r,Iy as s,Ke as t,Hr as u,qr as v,Ry as w,Cy as x,Sy as y,wy as z,Ce as A,it as B,re as C,Bn as D,fn as E,ci as F,tI as G,li as H,IE as I,St as J,wn as K,pr as L,TR as M,up as N,cp as O,sy as P,Wa as Q,hS as R,dS as S,Cp as T,wp as U};
/*! Bundled license information:

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/component/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/logger/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/webchannel-wrapper/dist/bloom-blob/esm/bloom_blob_es2018.js:
  (** @license
  Copyright The Closure Library Authors.
  SPDX-License-Identifier: Apache-2.0
  *)
  (** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  *)

@firebase/webchannel-wrapper/dist/webchannel-blob/esm/webchannel_blob_es2018.js:
  (** @license
  Copyright The Closure Library Authors.
  SPDX-License-Identifier: Apache-2.0
  *)
  (** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
//# sourceMappingURL=chunk-O77QQVYU.js.map
