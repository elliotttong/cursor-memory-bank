function NRAlert(){let e=this;function r(){e.capsule&&(e.capsule.style.display="none")}function t(r="generic",n=null){let a=["alert-prem-tts-limit","alert-plus-tts-limit","alert-upgrade","alert-upgrade-error","alert-upgrade-success","alert-generic","alert-google-drive-preview","alert-google-docs-no-annotated","alert-no-free-voices","alert-invalid-page","alert-upgrade-unsupported","alert-voice-reactivating"];for(let r=0;r<a.length;r++)e.shadow.getElementById(a[r]).style.display="none";"alert-upgrade"==r&&n?(e.data=n,function(r=null){if(!r)return;chrome.runtime.sendMessage({fn:"previewUpgradeReq",data:r},(n=>{if(chrome.runtime.lastError,""!=n.error){let a=null;null!=r.errors[n.error]&&(a=r.errors[n.error]),a&&(e.shadow.getElementById("alert-upgrade-error-msg").innerHTML=a),t("alert-upgrade-error")}else{const r=(n.resp/100).toFixed(2);e.shadow.getElementById("alert-upgrade-price").innerHTML="$"+r+" USD"}}))}(n)):"alert-plus-tts-limit"==r&&(e.license=n.license?n.license:0,e.data=n),e.shadow.getElementById(r).style.display="block"}e.capsule=null,e.shadow=null,e.showAlert=function(n,a,l){"undefined"!=typeof readingBar&&(readingBar.hideMessage(),readingBar.hideRelocateButton());let s=n.alertType?n.alertType:"generic",o=document.getElementById("nr-ext-alert-capsule"),c=n.data;if(o)t(s,c),e.capsule.style.display="block";else try{return new Promise((n=>{fetch(chrome.runtime.getURL("injected/nr-ext-alert/nr-ext-alert.html")).then((e=>e.text())).then((r=>{return t=r,new Promise((r=>{e.capsule=document.createElement("DIV"),e.capsule.id="nr-ext-alert-capsule",e.capsule.style.width=0,e.capsule.style.height=0,e.capsule.style.top=0,e.capsule.style.right=0,e.shadow=e.capsule.attachShadow({mode:"open"});const n=document.createElement("DIV");n.innerHTML=t;const a=[];for(;n.children.length>0;)a.push(n.children[0]),e.shadow.appendChild(n.children[0]);document.body.appendChild(e.capsule),r()})).catch((e=>{}));var t})).then((()=>{!function(){try{!async function(){try{await(r=null,t="injected/nr-ext-alert/nr-ext-alert.css",new Promise(((n,a)=>{let l;if(!r){let e=t.match(/\.([^.]+)$/);e&&(r=e[1])}r||(r="js");const s="nr-ext-"+t;t=chrome.runtime.getURL(t),"css"===r?(l=document.createElement("link"),l.id=s,l.type="text/css",l.rel="stylesheet",l.href=t,e.shadow.appendChild(l),n()):"js"===r?(l=document.createElement("script"),l.id=s,fetch(t).then((e=>e.text())).then((r=>{l.textContent=r,e.shadow.appendChild(l),n()})).catch((e=>{n()}))):n()})).catch((e=>{})))}catch(e){}var r,t}(),e.shadow.getElementById("alert-prem-tts-limit-upgrade").onclick=()=>{chrome.runtime.sendMessage({fn:"showUpgradePage"},(()=>{chrome.runtime.lastError})),r()},e.shadow.getElementById("alert-prem-tts-limit-restore-license").onclick=()=>{chrome.runtime.sendMessage({fn:"updateLicense"},(()=>{chrome.runtime.lastError})),r()},e.shadow.getElementById("alert-plus-tts-limit-upgrade").onclick=()=>{e.license<12?chrome.runtime.sendMessage({fn:"showUpgradePage"},(()=>{chrome.runtime.lastError})):chrome.runtime.sendMessage({fn:"upgrade"},(()=>{chrome.runtime.lastError})),r()},e.shadow.getElementById("alert-plus-tts-limit-restore-license").onclick=()=>{chrome.runtime.sendMessage({fn:"updateLicense"},(()=>{chrome.runtime.lastError})),r()},e.shadow.getElementById("alert-plus-tts-limit-switch-premium").onclick=()=>{readingBar.setReadingBarSetting("voiceType","prem",{toPlay:!0,sameLang:!0,updateReadingBarUI:!0}),r(),readingBar.hideIrrelevantPopups()},e.shadow.getElementById("alert-google-drive-preview-continue").onclick=()=>{chrome.runtime.sendMessage({fn:"setShouldCheckForPreviewMode",val:!1},(()=>{chrome.runtime.lastError})),chrome.runtime.sendMessage({message:"play",caller:"google drive preview warning"},(()=>{chrome.runtime.lastError})),r()},e.shadow.getElementById("alert-google-drive-preview-close").onclick=()=>{r()},e.shadow.getElementById("alert-google-docs-no-annotated-reload").onclick=()=>{chrome.runtime.sendMessage({fn:"reloadPage"},(()=>{chrome.runtime.lastError}))},e.shadow.getElementById("alert-no-free-voices-close").onclick=()=>{r()},e.shadow.getElementById("alert-generic-contact").onclick=()=>{window.open('https://www.naturalreaders.com/about.html#contactus"',"_blank"),r()},e.shadow.getElementById("alert-generic-reload").onclick=()=>{chrome.runtime.sendMessage({fn:"reloadPage"},(()=>{chrome.runtime.lastError}))},e.shadow.getElementById("alert-invalid-page-close").onclick=()=>{r()},e.shadow.getElementById("alert-upgrade-unsupported-close").onclick=()=>{r()},e.shadow.getElementById("alert-upgrade-confirm").onclick=()=>{chrome.runtime.sendMessage({fn:"sendUpgradeReq",data:e.data},(r=>{if(chrome.runtime.lastError,""!=r.error){let n="Something went wrong...";null!=e.data.errors[r.error]&&(n=e.data.errors[r.error]),e.shadow.getElementById("alert-upgrade-error-msg").innerHTML=n,t("alert-upgrade-error")}else t("alert-upgrade-success")}))},e.shadow.getElementById("alert-upgrade-error-close").onclick=()=>{r()},e.shadow.getElementById("alert-upgrade-success-close").onclick=()=>{r()},e.shadow.getElementById("nr-ext-alert-close").onclick=()=>{r()}}catch(e){}}(),t(s,c)})).catch((e=>{})),n()}))}catch(e){}},e.hideAlert=r,e.license=0,e.data=null,chrome.runtime.onMessage.addListener((function(r,t,n){e[r.fn]&&e[r.fn](r,t,n)}))}var nrAlert=nrAlert||new NRAlert;